Page · TSX
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface Showing {
  id: string;
  propertyId: string;
  propertyTitle: string;
  propertyImage: string;
  propertyAddress: string;
  propertyPrice: number;
  date: string;
  time: string;
  status: 'SCHEDULED' | 'COMPLETED' | 'CANCELLED' | 'RESCHEDULED';
  type: 'IN_PERSON' | 'VIRTUAL' | 'OPEN_HOUSE';
  agent?: {
    id: string;
    name: string;
    photo: string;
    phone: string;
  };
  notes?: string;
  feedback?: {
    rating: number;
    comment: string;
    interested: boolean;
  };
}

const mockShowings: Showing[] = [
  {
    id: '1',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    propertyImage: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=400',
    propertyAddress: '123 Koramangala 4th Block, Bangalore',
    propertyPrice: 25000000,
    date: '2024-12-20',
    time: '10:00 AM',
    status: 'SCHEDULED',
    type: 'IN_PERSON',
    agent: {
      id: 'agent1',
      name: 'Priya Sharma',
      photo: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100',
      phone: '+91 98765 43210'
    },
    notes: 'Please bring ID proof. Parking available in basement.'
  },
  {
    id: '2',
    propertyId: 'prop2',
    propertyTitle: 'Modern 3BHK Apartment',
    propertyImage: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400',
    propertyAddress: '456 HSR Layout, Bangalore',
    propertyPrice: 12500000,
    date: '2024-12-21',
    time: '2:00 PM',
    status: 'SCHEDULED',
    type: 'VIRTUAL',
    agent: {
      id: 'agent2',
      name: 'Rahul Verma',
      photo: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100',
      phone: '+91 98765 12345'
    },
    notes: 'Virtual tour link will be sent 30 mins before.'
  },
  {
    id: '3',
    propertyId: 'prop3',
    propertyTitle: 'Spacious 5BHK Penthouse',
    propertyImage: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=400',
    propertyAddress: '789 Indiranagar, Bangalore',
    propertyPrice: 45000000,
    date: '2024-12-22',
    time: '11:00 AM',
    status: 'SCHEDULED',
    type: 'OPEN_HOUSE',
    notes: 'Open house event. Multiple visitors expected.'
  },
  {
    id: '4',
    propertyId: 'prop4',
    propertyTitle: 'Cozy 2BHK Flat',
    propertyImage: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=400',
    propertyAddress: '321 Whitefield, Bangalore',
    propertyPrice: 8500000,
    date: '2024-12-15',
    time: '3:00 PM',
    status: 'COMPLETED',
    type: 'IN_PERSON',
    agent: {
      id: 'agent1',
      name: 'Priya Sharma',
      photo: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100',
      phone: '+91 98765 43210'
    },
    feedback: {
      rating: 4,
      comment: 'Great location but kitchen space is smaller than expected.',
      interested: true
    }
  },
  {
    id: '5',
    propertyId: 'prop5',
    propertyTitle: 'Premium 4BHK Duplex',
    propertyImage: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400',
    propertyAddress: '555 JP Nagar, Bangalore',
    propertyPrice: 32000000,
    date: '2024-12-18',
    time: '10:30 AM',
    status: 'CANCELLED',
    type: 'IN_PERSON',
    agent: {
      id: 'agent3',
      name: 'Amit Kumar',
      photo: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100',
      phone: '+91 98765 67890'
    },
    notes: 'Cancelled by seller - property under renovation.'
  }
];

export default function ShowingsPage() {
  const [showings, setShowings] = useState<Showing[]>([]);
  const [loading, setLoading] = useState(true);
  const [filter, setFilter] = useState<'all' | 'upcoming' | 'completed' | 'cancelled'>('all');
  const [viewMode, setViewMode] = useState<'calendar' | 'list'>('list');
  const [selectedShowing, setSelectedShowing] = useState<Showing | null>(null);
  const [showRescheduleModal, setShowRescheduleModal] = useState(false);
  const [showFeedbackModal, setShowFeedbackModal] = useState(false);
  const [rescheduleData, setRescheduleData] = useState({ date: '', time: '' });
  const [feedbackData, setFeedbackData] = useState({ rating: 0, comment: '', interested: false });

  useEffect(() => {
    // Simulate API call
    setTimeout(() => {
      setShowings(mockShowings);
      setLoading(false);
    }, 500);
  }, []);

  const formatPrice = (price: number) => {
    if (price >= 10000000) {
      return `₹${(price / 10000000).toFixed(1)} Cr`;
    }
    return `₹${(price / 100000).toFixed(0)} L`;
  };

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-IN', { weekday: 'short', day: 'numeric', month: 'short' });
  };

  const getStatusColor = (status: Showing['status']) => {
    switch (status) {
      case 'SCHEDULED': return 'bg-blue-100 text-blue-700';
      case 'COMPLETED': return 'bg-green-100 text-green-700';
      case 'CANCELLED': return 'bg-red-100 text-red-700';
      case 'RESCHEDULED': return 'bg-yellow-100 text-yellow-700';
      default: return 'bg-gray-100 text-gray-700';
    }
  };

  const getTypeIcon = (type: Showing['type']) => {
    switch (type) {
      case 'IN_PERSON':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        );
      case 'VIRTUAL':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
          </svg>
        );
      case 'OPEN_HOUSE':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
        );
    }
  };

  const filteredShowings = showings.filter(showing => {
    if (filter === 'all') return true;
    if (filter === 'upcoming') return showing.status === 'SCHEDULED' || showing.status === 'RESCHEDULED';
    if (filter === 'completed') return showing.status === 'COMPLETED';
    if (filter === 'cancelled') return showing.status === 'CANCELLED';
    return true;
  });

  const upcomingCount = showings.filter(s => s.status === 'SCHEDULED' || s.status === 'RESCHEDULED').length;
  const completedCount = showings.filter(s => s.status === 'COMPLETED').length;
  const cancelledCount = showings.filter(s => s.status === 'CANCELLED').length;

  const handleCancelShowing = (showingId: string) => {
    setShowings(prev => prev.map(s => 
      s.id === showingId ? { ...s, status: 'CANCELLED' as const } : s
    ));
  };

  const handleReschedule = () => {
    if (selectedShowing && rescheduleData.date && rescheduleData.time) {
      setShowings(prev => prev.map(s =>
        s.id === selectedShowing.id 
          ? { ...s, date: rescheduleData.date, time: rescheduleData.time, status: 'RESCHEDULED' as const }
          : s
      ));
      setShowRescheduleModal(false);
      setSelectedShowing(null);
      setRescheduleData({ date: '', time: '' });
    }
  };

  const handleSubmitFeedback = () => {
    if (selectedShowing && feedbackData.rating > 0) {
      setShowings(prev => prev.map(s =>
        s.id === selectedShowing.id
          ? { ...s, feedback: { ...feedbackData } }
          : s
      ));
      setShowFeedbackModal(false);
      setSelectedShowing(null);
      setFeedbackData({ rating: 0, comment: '', interested: false });
    }
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Scheduled Showings</h1>
          <p className="text-gray-600 mt-1">Manage your property viewing appointments</p>
        </div>
        <div className="flex items-center gap-3">
          {/* View Toggle */}
          <div className="flex items-center bg-gray-100 rounded-lg p-1">
            <button
              onClick={() => setViewMode('list')}
              className={`p-2 rounded-md transition-colors ${viewMode === 'list' ? 'bg-white shadow text-orange-600' : 'text-gray-500'}`}
            >
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 10h16M4 14h16M4 18h16" />
              </svg>
            </button>
            <button
              onClick={() => setViewMode('calendar')}
              className={`p-2 rounded-md transition-colors ${viewMode === 'calendar' ? 'bg-white shadow text-orange-600' : 'text-gray-500'}`}
            >
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </button>
          </div>
          <Link
            href="/search"
            className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors"
          >
            Schedule New
          </Link>
        </div>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
        <motion.button
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          onClick={() => setFilter('all')}
          className={`p-4 rounded-xl border-2 transition-all ${filter === 'all' ? 'border-orange-500 bg-orange-50' : 'border-gray-200 bg-white hover:border-gray-300'}`}
        >
          <div className="text-3xl font-bold text-gray-900">{showings.length}</div>
          <div className="text-gray-600">Total Showings</div>
        </motion.button>
        <motion.button
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.05 }}
          onClick={() => setFilter('upcoming')}
          className={`p-4 rounded-xl border-2 transition-all ${filter === 'upcoming' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 bg-white hover:border-gray-300'}`}
        >
          <div className="text-3xl font-bold text-blue-600">{upcomingCount}</div>
          <div className="text-gray-600">Upcoming</div>
        </motion.button>
        <motion.button
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          onClick={() => setFilter('completed')}
          className={`p-4 rounded-xl border-2 transition-all ${filter === 'completed' ? 'border-green-500 bg-green-50' : 'border-gray-200 bg-white hover:border-gray-300'}`}
        >
          <div className="text-3xl font-bold text-green-600">{completedCount}</div>
          <div className="text-gray-600">Completed</div>
        </motion.button>
        <motion.button
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.15 }}
          onClick={() => setFilter('cancelled')}
          className={`p-4 rounded-xl border-2 transition-all ${filter === 'cancelled' ? 'border-red-500 bg-red-50' : 'border-gray-200 bg-white hover:border-gray-300'}`}
        >
          <div className="text-3xl font-bold text-red-600">{cancelledCount}</div>
          <div className="text-gray-600">Cancelled</div>
        </motion.button>
      </div>

      {/* Showings List */}
      {viewMode === 'list' ? (
        <div className="space-y-4">
          <AnimatePresence>
            {filteredShowings.length === 0 ? (
              <motion.div
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                className="text-center py-12 bg-white rounded-xl border border-gray-200"
              >
                <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <h3 className="text-lg font-medium text-gray-900 mb-2">No showings found</h3>
                <p className="text-gray-600 mb-4">You don't have any {filter !== 'all' ? filter : ''} showings.</p>
                <Link
                  href="/search"
                  className="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600"
                >
                  Browse Properties
                </Link>
              </motion.div>
            ) : (
              filteredShowings.map((showing, index) => (
                <motion.div
                  key={showing.id}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  exit={{ opacity: 0, x: -100 }}
                  transition={{ delay: index * 0.05 }}
                  className="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow"
                >
                  <div className="flex flex-col md:flex-row">
                    {/* Property Image */}
                    <div className="relative w-full md:w-64 h-48 md:h-auto flex-shrink-0">
                      <img
                        src={showing.propertyImage}
                        alt={showing.propertyTitle}
                        className="w-full h-full object-cover"
                      />
                      <div className={`absolute top-3 left-3 px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(showing.status)}`}>
                        {showing.status}
                      </div>
                    </div>

                    {/* Content */}
                    <div className="flex-1 p-5">
                      <div className="flex flex-col md:flex-row md:items-start md:justify-between gap-4">
                        <div className="flex-1">
                          <Link href={`/property/${showing.propertyId}`} className="hover:text-orange-600">
                            <h3 className="text-lg font-semibold text-gray-900">{showing.propertyTitle}</h3>
                          </Link>
                          <p className="text-gray-600 text-sm mt-1">{showing.propertyAddress}</p>
                          <p className="text-xl font-bold text-orange-600 mt-2">{formatPrice(showing.propertyPrice)}</p>

                          {/* Date & Time */}
                          <div className="flex items-center gap-4 mt-3">
                            <div className="flex items-center gap-2 text-gray-600">
                              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                              </svg>
                              <span className="font-medium">{formatDate(showing.date)}</span>
                            </div>
                            <div className="flex items-center gap-2 text-gray-600">
                              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                              </svg>
                              <span className="font-medium">{showing.time}</span>
                            </div>
                            <div className="flex items-center gap-2 text-gray-600">
                              {getTypeIcon(showing.type)}
                              <span className="text-sm">{showing.type.replace('_', ' ')}</span>
                            </div>
                          </div>

                          {/* Agent Info */}
                          {showing.agent && (
                            <div className="flex items-center gap-3 mt-4 p-3 bg-gray-50 rounded-lg">
                              <img
                                src={showing.agent.photo}
                                alt={showing.agent.name}
                                className="w-10 h-10 rounded-full object-cover"
                              />
                              <div>
                                <Link href={`/agent/${showing.agent.id}`} className="font-medium text-gray-900 hover:text-orange-600">
                                  {showing.agent.name}
                                </Link>
                                <p className="text-sm text-gray-600">{showing.agent.phone}</p>
                              </div>
                            </div>
                          )}

                          {/* Notes */}
                          {showing.notes && (
                            <div className="mt-3 p-3 bg-yellow-50 rounded-lg text-sm text-yellow-800">
                              <span className="font-medium">Note:</span> {showing.notes}
                            </div>
                          )}

                          {/* Feedback */}
                          {showing.feedback && (
                            <div className="mt-3 p-3 bg-green-50 rounded-lg">
                              <div className="flex items-center gap-2 mb-2">
                                <span className="text-sm font-medium text-green-800">Your Feedback:</span>
                                <div className="flex items-center">
                                  {[1, 2, 3, 4, 5].map((star) => (
                                    <svg
                                      key={star}
                                      className={`w-4 h-4 ${star <= showing.feedback!.rating ? 'text-yellow-500' : 'text-gray-300'}`}
                                      fill="currentColor"
                                      viewBox="0 0 20 20"
                                    >
                                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                    </svg>
                                  ))}
                                </div>
                                {showing.feedback.interested && (
                                  <span className="ml-2 px-2 py-0.5 bg-green-200 text-green-800 text-xs rounded-full">Interested</span>
                                )}
                              </div>
                              <p className="text-sm text-green-800">{showing.feedback.comment}</p>
                            </div>
                          )}
                        </div>

                        {/* Actions */}
                        <div className="flex flex-row md:flex-col gap-2">
                          {(showing.status === 'SCHEDULED' || showing.status === 'RESCHEDULED') && (
                            <>
                              {showing.type === 'VIRTUAL' && (
                                <button className="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-sm">
                                  Join Call
                                </button>
                              )}
                              <button
                                onClick={() => {
                                  setSelectedShowing(showing);
                                  setShowRescheduleModal(true);
                                }}
                                className="px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors text-sm"
                              >
                                Reschedule
                              </button>
                              <button
                                onClick={() => handleCancelShowing(showing.id)}
                                className="px-4 py-2 text-red-600 border border-red-300 rounded-lg font-medium hover:bg-red-50 transition-colors text-sm"
                              >
                                Cancel
                              </button>
                            </>
                          )}
                          {showing.status === 'COMPLETED' && !showing.feedback && (
                            <button
                              onClick={() => {
                                setSelectedShowing(showing);
                                setShowFeedbackModal(true);
                              }}
                              className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors text-sm"
                            >
                              Add Feedback
                            </button>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                </motion.div>
              ))
            )}
          </AnimatePresence>
        </div>
      ) : (
        /* Calendar View */
        <div className="bg-white rounded-xl border border-gray-200 p-6">
          <div className="text-center text-gray-600">
            <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <h3 className="text-lg font-medium text-gray-900 mb-2">Calendar View Coming Soon</h3>
            <p className="text-gray-600">We're working on a beautiful calendar interface for your showings.</p>
          </div>
        </div>
      )}

      {/* Reschedule Modal */}
      <AnimatePresence>
        {showRescheduleModal && selectedShowing && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowRescheduleModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              onClick={(e) => e.stopPropagation()}
              className="bg-white rounded-2xl max-w-md w-full p-6"
            >
              <h2 className="text-xl font-bold text-gray-900 mb-4">Reschedule Showing</h2>
              <p className="text-gray-600 mb-4">{selectedShowing.propertyTitle}</p>
              
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">New Date</label>
                  <input
                    type="date"
                    value={rescheduleData.date}
                    onChange={(e) => setRescheduleData(prev => ({ ...prev, date: e.target.value }))}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">New Time</label>
                  <input
                    type="time"
                    value={rescheduleData.time}
                    onChange={(e) => setRescheduleData(prev => ({ ...prev, time: e.target.value }))}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  />
                </div>
              </div>

              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowRescheduleModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={handleReschedule}
                  disabled={!rescheduleData.date || !rescheduleData.time}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  Confirm
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Feedback Modal */}
      <AnimatePresence>
        {showFeedbackModal && selectedShowing && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowFeedbackModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              onClick={(e) => e.stopPropagation()}
              className="bg-white rounded-2xl max-w-md w-full p-6"
            >
              <h2 className="text-xl font-bold text-gray-900 mb-4">Share Your Feedback</h2>
              <p className="text-gray-600 mb-4">{selectedShowing.propertyTitle}</p>
              
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Rating</label>
                  <div className="flex gap-2">
                    {[1, 2, 3, 4, 5].map((star) => (
                      <button
                        key={star}
                        onClick={() => setFeedbackData(prev => ({ ...prev, rating: star }))}
                        className="focus:outline-none"
                      >
                        <svg
                          className={`w-8 h-8 transition-colors ${star <= feedbackData.rating ? 'text-yellow-500' : 'text-gray-300 hover:text-yellow-400'}`}
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                        </svg>
                      </button>
                    ))}
                  </div>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Comments</label>
                  <textarea
                    value={feedbackData.comment}
                    onChange={(e) => setFeedbackData(prev => ({ ...prev, comment: e.target.value }))}
                    rows={3}
                    placeholder="Share your thoughts about the property..."
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  />
                </div>

                <label className="flex items-center gap-3 cursor-pointer">
                  <input
                    type="checkbox"
                    checked={feedbackData.interested}
                    onChange={(e) => setFeedbackData(prev => ({ ...prev, interested: e.target.checked }))}
                    className="w-5 h-5 rounded border-gray-300 text-orange-500 focus:ring-orange-500"
                  />
                  <span className="text-gray-700">I'm interested in this property</span>
                </label>
              </div>

              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowFeedbackModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={handleSubmitFeedback}
                  disabled={feedbackData.rating === 0}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  Submit
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
Page · TSX
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface Offer {
  id: string;
  propertyId: string;
  propertyTitle: string;
  propertyImage: string;
  propertyAddress: string;
  listPrice: number;
  offerAmount: number;
  status: 'PENDING' | 'ACCEPTED' | 'REJECTED' | 'COUNTERED' | 'WITHDRAWN' | 'EXPIRED';
  type: 'MADE' | 'RECEIVED';
  submittedAt: string;
  expiresAt: string;
  counterOffer?: number;
  contingencies: string[];
  earnestMoney: number;
  financingType: 'CASH' | 'CONVENTIONAL' | 'FHA' | 'VA';
  closingDate: string;
  buyer?: {
    name: string;
    phone: string;
    email: string;
  };
  seller?: {
    name: string;
    phone: string;
  };
  agent?: {
    id: string;
    name: string;
    photo: string;
  };
  notes?: string;
  messages: Array<{
    id: string;
    sender: string;
    message: string;
    timestamp: string;
  }>;
}

const mockOffers: Offer[] = [
  {
    id: '1',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    propertyImage: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=400',
    propertyAddress: '123 Koramangala 4th Block, Bangalore',
    listPrice: 25000000,
    offerAmount: 24000000,
    status: 'PENDING',
    type: 'MADE',
    submittedAt: '2024-12-18T10:30:00',
    expiresAt: '2024-12-21T23:59:00',
    contingencies: ['Home Inspection', 'Vastu Verification', 'Financing'],
    earnestMoney: 500000,
    financingType: 'CONVENTIONAL',
    closingDate: '2025-01-30',
    seller: {
      name: 'Vikram Mehta',
      phone: '+91 98765 11111'
    },
    agent: {
      id: 'agent1',
      name: 'Priya Sharma',
      photo: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100'
    },
    messages: [
      { id: '1', sender: 'You', message: 'We love the property and the Vastu compliance!', timestamp: '2024-12-18T10:30:00' }
    ]
  },
  {
    id: '2',
    propertyId: 'prop2',
    propertyTitle: 'Modern 3BHK Apartment',
    propertyImage: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400',
    propertyAddress: '456 HSR Layout, Bangalore',
    listPrice: 12500000,
    offerAmount: 12000000,
    status: 'COUNTERED',
    type: 'MADE',
    submittedAt: '2024-12-15T14:00:00',
    expiresAt: '2024-12-22T23:59:00',
    counterOffer: 12250000,
    contingencies: ['Home Inspection', 'Financing'],
    earnestMoney: 250000,
    financingType: 'CONVENTIONAL',
    closingDate: '2025-02-15',
    seller: {
      name: 'Anita Reddy',
      phone: '+91 98765 22222'
    },
    agent: {
      id: 'agent2',
      name: 'Rahul Verma',
      photo: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100'
    },
    messages: [
      { id: '1', sender: 'You', message: 'Offering ₹1.2 Cr for quick closing.', timestamp: '2024-12-15T14:00:00' },
      { id: '2', sender: 'Seller', message: 'Counter offer at ₹1.225 Cr with same terms.', timestamp: '2024-12-17T09:00:00' }
    ]
  },
  {
    id: '3',
    propertyId: 'prop3',
    propertyTitle: 'Cozy 2BHK in Whitefield',
    propertyImage: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=400',
    propertyAddress: '789 Whitefield Main Road, Bangalore',
    listPrice: 8500000,
    offerAmount: 8200000,
    status: 'ACCEPTED',
    type: 'MADE',
    submittedAt: '2024-12-10T11:00:00',
    expiresAt: '2024-12-13T23:59:00',
    contingencies: ['Home Inspection'],
    earnestMoney: 200000,
    financingType: 'CASH',
    closingDate: '2025-01-15',
    seller: {
      name: 'Suresh Kumar',
      phone: '+91 98765 33333'
    },
    messages: [
      { id: '1', sender: 'You', message: 'Cash offer for quick closing.', timestamp: '2024-12-10T11:00:00' },
      { id: '2', sender: 'Seller', message: 'Accepted! Looking forward to closing.', timestamp: '2024-12-12T16:00:00' }
    ]
  },
  {
    id: '4',
    propertyId: 'prop4',
    propertyTitle: 'Premium Penthouse',
    propertyImage: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=400',
    propertyAddress: '321 Indiranagar 100ft Road, Bangalore',
    listPrice: 45000000,
    offerAmount: 42000000,
    status: 'REJECTED',
    type: 'MADE',
    submittedAt: '2024-12-05T09:00:00',
    expiresAt: '2024-12-08T23:59:00',
    contingencies: ['Home Inspection', 'Vastu Verification', 'Financing'],
    earnestMoney: 1000000,
    financingType: 'CONVENTIONAL',
    closingDate: '2025-02-28',
    seller: {
      name: 'Rajesh Gupta',
      phone: '+91 98765 44444'
    },
    messages: [
      { id: '1', sender: 'Seller', message: 'Thank you for your offer but we have accepted another offer closer to asking price.', timestamp: '2024-12-07T10:00:00' }
    ]
  }
];

export default function OffersPage() {
  const [offers, setOffers] = useState<Offer[]>([]);
  const [loading, setLoading] = useState(true);
  const [filter, setFilter] = useState<'all' | 'pending' | 'accepted' | 'rejected' | 'countered'>('all');
  const [typeFilter, setTypeFilter] = useState<'all' | 'made' | 'received'>('all');
  const [selectedOffer, setSelectedOffer] = useState<Offer | null>(null);
  const [showCounterModal, setShowCounterModal] = useState(false);
  const [counterAmount, setCounterAmount] = useState('');

  useEffect(() => {
    setTimeout(() => {
      setOffers(mockOffers);
      setLoading(false);
    }, 500);
  }, []);

  const formatPrice = (price: number) => {
    if (price >= 10000000) {
      return `₹${(price / 10000000).toFixed(2)} Cr`;
    }
    return `₹${(price / 100000).toFixed(0)} L`;
  };

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' });
  };

  const formatDateTime = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleString('en-IN', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' });
  };

  const getStatusColor = (status: Offer['status']) => {
    switch (status) {
      case 'PENDING': return 'bg-yellow-100 text-yellow-700 border-yellow-300';
      case 'ACCEPTED': return 'bg-green-100 text-green-700 border-green-300';
      case 'REJECTED': return 'bg-red-100 text-red-700 border-red-300';
      case 'COUNTERED': return 'bg-blue-100 text-blue-700 border-blue-300';
      case 'WITHDRAWN': return 'bg-gray-100 text-gray-700 border-gray-300';
      case 'EXPIRED': return 'bg-gray-100 text-gray-500 border-gray-300';
      default: return 'bg-gray-100 text-gray-700 border-gray-300';
    }
  };

  const getStatusIcon = (status: Offer['status']) => {
    switch (status) {
      case 'PENDING':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );
      case 'ACCEPTED':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
          </svg>
        );
      case 'REJECTED':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        );
      case 'COUNTERED':
        return (
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
          </svg>
        );
      default:
        return null;
    }
  };

  const getDaysRemaining = (expiresAt: string) => {
    const now = new Date();
    const expires = new Date(expiresAt);
    const diff = expires.getTime() - now.getTime();
    const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
    return days;
  };

  const filteredOffers = offers.filter(offer => {
    const statusMatch = filter === 'all' || offer.status.toLowerCase() === filter;
    const typeMatch = typeFilter === 'all' || offer.type.toLowerCase() === typeFilter;
    return statusMatch && typeMatch;
  });

  const stats = {
    total: offers.length,
    pending: offers.filter(o => o.status === 'PENDING').length,
    accepted: offers.filter(o => o.status === 'ACCEPTED').length,
    countered: offers.filter(o => o.status === 'COUNTERED').length
  };

  const handleWithdraw = (offerId: string) => {
    setOffers(prev => prev.map(o =>
      o.id === offerId ? { ...o, status: 'WITHDRAWN' as const } : o
    ));
  };

  const handleAcceptCounter = (offerId: string) => {
    setOffers(prev => prev.map(o =>
      o.id === offerId ? { ...o, status: 'ACCEPTED' as const, offerAmount: o.counterOffer! } : o
    ));
  };

  const handleSubmitCounter = () => {
    if (selectedOffer && counterAmount) {
      setOffers(prev => prev.map(o =>
        o.id === selectedOffer.id ? { ...o, counterOffer: parseInt(counterAmount), status: 'COUNTERED' as const } : o
      ));
      setShowCounterModal(false);
      setSelectedOffer(null);
      setCounterAmount('');
    }
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">My Offers</h1>
          <p className="text-gray-600 mt-1">Track and manage your property offers</p>
        </div>
        <Link
          href="/search"
          className="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors"
        >
          <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
          </svg>
          Browse Properties
        </Link>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-gray-900">{stats.total}</div>
          <div className="text-gray-600">Total Offers</div>
        </motion.div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.05 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-yellow-600">{stats.pending}</div>
          <div className="text-gray-600">Pending</div>
        </motion.div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-green-600">{stats.accepted}</div>
          <div className="text-gray-600">Accepted</div>
        </motion.div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.15 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-blue-600">{stats.countered}</div>
          <div className="text-gray-600">Countered</div>
        </motion.div>
      </div>

      {/* Filters */}
      <div className="flex flex-col md:flex-row gap-4">
        <div className="flex flex-wrap gap-2">
          {['all', 'pending', 'accepted', 'rejected', 'countered'].map((status) => (
            <button
              key={status}
              onClick={() => setFilter(status as typeof filter)}
              className={`px-4 py-2 rounded-lg font-medium capitalize transition-colors ${
                filter === status
                  ? 'bg-orange-500 text-white'
                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
              }`}
            >
              {status}
            </button>
          ))}
        </div>
        <div className="flex gap-2 md:ml-auto">
          {['all', 'made', 'received'].map((type) => (
            <button
              key={type}
              onClick={() => setTypeFilter(type as typeof typeFilter)}
              className={`px-4 py-2 rounded-lg font-medium capitalize transition-colors ${
                typeFilter === type
                  ? 'bg-gray-800 text-white'
                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
              }`}
            >
              {type === 'all' ? 'All Types' : `Offers ${type}`}
            </button>
          ))}
        </div>
      </div>

      {/* Offers List */}
      <div className="space-y-4">
        <AnimatePresence>
          {filteredOffers.length === 0 ? (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              className="text-center py-12 bg-white rounded-xl border border-gray-200"
            >
              <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
              <h3 className="text-lg font-medium text-gray-900 mb-2">No offers found</h3>
              <p className="text-gray-600 mb-4">You don't have any {filter !== 'all' ? filter : ''} offers yet.</p>
              <Link
                href="/search"
                className="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium"
              >
                Start Browsing
              </Link>
            </motion.div>
          ) : (
            filteredOffers.map((offer, index) => (
              <motion.div
                key={offer.id}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                exit={{ opacity: 0, x: -100 }}
                transition={{ delay: index * 0.05 }}
                className="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow"
              >
                <div className="flex flex-col lg:flex-row">
                  {/* Property Image */}
                  <div className="relative w-full lg:w-72 h-48 lg:h-auto flex-shrink-0">
                    <img
                      src={offer.propertyImage}
                      alt={offer.propertyTitle}
                      className="w-full h-full object-cover"
                    />
                    <div className={`absolute top-3 left-3 px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1.5 border ${getStatusColor(offer.status)}`}>
                      {getStatusIcon(offer.status)}
                      {offer.status}
                    </div>
                    <div className={`absolute top-3 right-3 px-2 py-1 rounded-full text-xs font-medium ${offer.type === 'MADE' ? 'bg-purple-100 text-purple-700' : 'bg-teal-100 text-teal-700'}`}>
                      {offer.type === 'MADE' ? 'Offer Made' : 'Offer Received'}
                    </div>
                  </div>

                  {/* Content */}
                  <div className="flex-1 p-5">
                    <div className="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4">
                      <div className="flex-1">
                        <Link href={`/property/${offer.propertyId}`} className="hover:text-orange-600">
                          <h3 className="text-lg font-semibold text-gray-900">{offer.propertyTitle}</h3>
                        </Link>
                        <p className="text-gray-600 text-sm mt-1">{offer.propertyAddress}</p>

                        {/* Price Comparison */}
                        <div className="mt-4 p-4 bg-gray-50 rounded-lg">
                          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div>
                              <div className="text-xs text-gray-500 uppercase">List Price</div>
                              <div className="text-lg font-bold text-gray-700">{formatPrice(offer.listPrice)}</div>
                            </div>
                            <div>
                              <div className="text-xs text-gray-500 uppercase">Your Offer</div>
                              <div className={`text-lg font-bold ${offer.offerAmount < offer.listPrice ? 'text-green-600' : 'text-orange-600'}`}>
                                {formatPrice(offer.offerAmount)}
                              </div>
                            </div>
                            {offer.counterOffer && (
                              <div>
                                <div className="text-xs text-gray-500 uppercase">Counter Offer</div>
                                <div className="text-lg font-bold text-blue-600">{formatPrice(offer.counterOffer)}</div>
                              </div>
                            )}
                            <div>
                              <div className="text-xs text-gray-500 uppercase">Difference</div>
                              <div className={`text-lg font-bold ${offer.offerAmount < offer.listPrice ? 'text-green-600' : 'text-red-600'}`}>
                                {offer.offerAmount < offer.listPrice ? '-' : '+'}{formatPrice(Math.abs(offer.listPrice - offer.offerAmount))}
                              </div>
                            </div>
                          </div>
                        </div>

                        {/* Details Grid */}
                        <div className="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                          <div>
                            <span className="text-gray-500">Submitted:</span>
                            <span className="ml-2 font-medium text-gray-900">{formatDate(offer.submittedAt)}</span>
                          </div>
                          <div>
                            <span className="text-gray-500">Financing:</span>
                            <span className="ml-2 font-medium text-gray-900">{offer.financingType}</span>
                          </div>
                          <div>
                            <span className="text-gray-500">Earnest Money:</span>
                            <span className="ml-2 font-medium text-gray-900">{formatPrice(offer.earnestMoney)}</span>
                          </div>
                          <div>
                            <span className="text-gray-500">Closing:</span>
                            <span className="ml-2 font-medium text-gray-900">{formatDate(offer.closingDate)}</span>
                          </div>
                        </div>

                        {/* Contingencies */}
                        <div className="mt-3 flex flex-wrap gap-2">
                          {offer.contingencies.map((contingency, i) => (
                            <span key={i} className="px-2 py-1 bg-orange-50 text-orange-700 text-xs rounded-full">
                              {contingency}
                            </span>
                          ))}
                        </div>

                        {/* Expiration Warning */}
                        {(offer.status === 'PENDING' || offer.status === 'COUNTERED') && (
                          <div className={`mt-3 flex items-center gap-2 text-sm ${getDaysRemaining(offer.expiresAt) <= 1 ? 'text-red-600' : 'text-gray-600'}`}>
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span>
                              {getDaysRemaining(offer.expiresAt) > 0
                                ? `Expires in ${getDaysRemaining(offer.expiresAt)} day${getDaysRemaining(offer.expiresAt) !== 1 ? 's' : ''}`
                                : 'Expired'}
                            </span>
                          </div>
                        )}

                        {/* Messages Preview */}
                        {offer.messages.length > 0 && (
                          <div className="mt-4 p-3 bg-gray-50 rounded-lg">
                            <div className="text-xs text-gray-500 uppercase mb-2">Latest Message</div>
                            <div className="flex items-start gap-2">
                              <span className="font-medium text-gray-700">{offer.messages[offer.messages.length - 1].sender}:</span>
                              <span className="text-gray-600">{offer.messages[offer.messages.length - 1].message}</span>
                            </div>
                            <div className="text-xs text-gray-400 mt-1">
                              {formatDateTime(offer.messages[offer.messages.length - 1].timestamp)}
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Actions */}
                      <div className="flex flex-row lg:flex-col gap-2 flex-shrink-0">
                        {offer.status === 'PENDING' && offer.type === 'MADE' && (
                          <>
                            <button
                              onClick={() => handleWithdraw(offer.id)}
                              className="px-4 py-2 text-red-600 border border-red-300 rounded-lg font-medium hover:bg-red-50 transition-colors text-sm"
                            >
                              Withdraw
                            </button>
                            <Link
                              href={`/dashboard/messages?offer=${offer.id}`}
                              className="px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors text-sm text-center"
                            >
                              Message
                            </Link>
                          </>
                        )}
                        {offer.status === 'COUNTERED' && offer.type === 'MADE' && (
                          <>
                            <button
                              onClick={() => handleAcceptCounter(offer.id)}
                              className="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors text-sm"
                            >
                              Accept Counter
                            </button>
                            <button
                              onClick={() => {
                                setSelectedOffer(offer);
                                setShowCounterModal(true);
                              }}
                              className="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors text-sm"
                            >
                              Counter Back
                            </button>
                            <button
                              onClick={() => handleWithdraw(offer.id)}
                              className="px-4 py-2 text-red-600 border border-red-300 rounded-lg font-medium hover:bg-red-50 transition-colors text-sm"
                            >
                              Decline
                            </button>
                          </>
                        )}
                        {offer.status === 'ACCEPTED' && (
                          <Link
                            href={`/dashboard/documents?offer=${offer.id}`}
                            className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors text-sm text-center"
                          >
                            View Documents
                          </Link>
                        )}
                        <Link
                          href={`/property/${offer.propertyId}`}
                          className="px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors text-sm text-center"
                        >
                          View Property
                        </Link>
                      </div>
                    </div>
                  </div>
                </div>
              </motion.div>
            ))
          )}
        </AnimatePresence>
      </div>

      {/* Counter Offer Modal */}
      <AnimatePresence>
        {showCounterModal && selectedOffer && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowCounterModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              onClick={(e) => e.stopPropagation()}
              className="bg-white rounded-2xl max-w-md w-full p-6"
            >
              <h2 className="text-xl font-bold text-gray-900 mb-2">Submit Counter Offer</h2>
              <p className="text-gray-600 mb-4">{selectedOffer.propertyTitle}</p>

              <div className="p-4 bg-gray-50 rounded-lg mb-4">
                <div className="flex justify-between text-sm mb-2">
                  <span className="text-gray-500">Their Counter:</span>
                  <span className="font-bold text-blue-600">{formatPrice(selectedOffer.counterOffer!)}</span>
                </div>
                <div className="flex justify-between text-sm">
                  <span className="text-gray-500">Your Previous Offer:</span>
                  <span className="font-medium text-gray-700">{formatPrice(selectedOffer.offerAmount)}</span>
                </div>
              </div>

              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Your Counter Offer (₹)</label>
                  <input
                    type="number"
                    value={counterAmount}
                    onChange={(e) => setCounterAmount(e.target.value)}
                    placeholder="Enter amount"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-lg"
                  />
                  {counterAmount && (
                    <div className="mt-2 text-sm text-gray-600">
                      = {formatPrice(parseInt(counterAmount))}
                    </div>
                  )}
                </div>
              </div>

              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowCounterModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={handleSubmitCounter}
                  disabled={!counterAmount}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors disabled:opacity-50"
                >
                  Submit Counter
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
Page · TSX
'use client';

import { useState, useEffect, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface Message {
  id: string;
  content: string;
  timestamp: string;
  senderId: string;
  read: boolean;
  attachments?: Array<{
    type: 'image' | 'document' | 'property';
    url: string;
    name: string;
  }>;
}

interface Conversation {
  id: string;
  participant: {
    id: string;
    name: string;
    photo: string;
    role: 'AGENT' | 'BUYER' | 'SELLER';
    online: boolean;
  };
  property?: {
    id: string;
    title: string;
    image: string;
  };
  lastMessage: Message;
  unreadCount: number;
  messages: Message[];
}

const mockConversations: Conversation[] = [
  {
    id: '1',
    participant: {
      id: 'agent1',
      name: 'Priya Sharma',
      photo: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100',
      role: 'AGENT',
      online: true
    },
    property: {
      id: 'prop1',
      title: 'Luxurious 4BHK Villa with Vastu',
      image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=100'
    },
    lastMessage: {
      id: 'm1',
      content: 'I can arrange a showing for you tomorrow at 10 AM. Does that work?',
      timestamp: '2024-12-19T14:30:00',
      senderId: 'agent1',
      read: false
    },
    unreadCount: 2,
    messages: [
      { id: 'm0', content: 'Hi! I\'m interested in the 4BHK Villa in Koramangala. Is it still available?', timestamp: '2024-12-19T10:00:00', senderId: 'user', read: true },
      { id: 'm1', content: 'Hello! Yes, the property is still available. It\'s one of our finest Vastu-compliant homes.', timestamp: '2024-12-19T10:15:00', senderId: 'agent1', read: true },
      { id: 'm2', content: 'Great! What\'s the Vastu score?', timestamp: '2024-12-19T11:00:00', senderId: 'user', read: true },
      { id: 'm3', content: 'It has a 95% Vastu score with excellent east-facing entrance and proper room placements according to Vastu principles.', timestamp: '2024-12-19T11:30:00', senderId: 'agent1', read: true },
      { id: 'm4', content: 'That sounds perfect! Can I schedule a visit?', timestamp: '2024-12-19T14:00:00', senderId: 'user', read: true },
      { id: 'm5', content: 'I can arrange a showing for you tomorrow at 10 AM. Does that work?', timestamp: '2024-12-19T14:30:00', senderId: 'agent1', read: false }
    ]
  },
  {
    id: '2',
    participant: {
      id: 'agent2',
      name: 'Rahul Verma',
      photo: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100',
      role: 'AGENT',
      online: false
    },
    property: {
      id: 'prop2',
      title: 'Modern 3BHK Apartment',
      image: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=100'
    },
    lastMessage: {
      id: 'm2',
      content: 'The seller has accepted your offer! Congratulations! 🎉',
      timestamp: '2024-12-18T16:00:00',
      senderId: 'agent2',
      read: true
    },
    unreadCount: 0,
    messages: [
      { id: 'm0', content: 'Hi Rahul, any update on my offer?', timestamp: '2024-12-18T14:00:00', senderId: 'user', read: true },
      { id: 'm1', content: 'Hi! I\'m following up with the seller right now.', timestamp: '2024-12-18T14:30:00', senderId: 'agent2', read: true },
      { id: 'm2', content: 'The seller has accepted your offer! Congratulations! 🎉', timestamp: '2024-12-18T16:00:00', senderId: 'agent2', read: true }
    ]
  },
  {
    id: '3',
    participant: {
      id: 'seller1',
      name: 'Vikram Mehta',
      photo: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100',
      role: 'SELLER',
      online: true
    },
    property: {
      id: 'prop3',
      title: 'Premium Penthouse in Indiranagar',
      image: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=100'
    },
    lastMessage: {
      id: 'm3',
      content: 'I\'ve uploaded the Vastu certificate to the documents section.',
      timestamp: '2024-12-17T11:00:00',
      senderId: 'seller1',
      read: true
    },
    unreadCount: 0,
    messages: [
      { id: 'm0', content: 'Could you share the Vastu certification for the property?', timestamp: '2024-12-17T09:00:00', senderId: 'user', read: true },
      { id: 'm1', content: 'Sure! Let me get that for you.', timestamp: '2024-12-17T09:30:00', senderId: 'seller1', read: true },
      { id: 'm2', content: 'I\'ve uploaded the Vastu certificate to the documents section.', timestamp: '2024-12-17T11:00:00', senderId: 'seller1', read: true }
    ]
  },
  {
    id: '4',
    participant: {
      id: 'agent3',
      name: 'Anita Reddy',
      photo: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100',
      role: 'AGENT',
      online: false
    },
    lastMessage: {
      id: 'm4',
      content: 'I have some new listings that match your criteria. Would you like me to share them?',
      timestamp: '2024-12-15T09:00:00',
      senderId: 'agent3',
      read: true
    },
    unreadCount: 0,
    messages: [
      { id: 'm0', content: 'I have some new listings that match your criteria. Would you like me to share them?', timestamp: '2024-12-15T09:00:00', senderId: 'agent3', read: true }
    ]
  }
];

export default function MessagesPage() {
  const [conversations, setConversations] = useState<Conversation[]>([]);
  const [loading, setLoading] = useState(true);
  const [selectedConversation, setSelectedConversation] = useState<Conversation | null>(null);
  const [newMessage, setNewMessage] = useState('');
  const [searchQuery, setSearchQuery] = useState('');
  const [showMobileList, setShowMobileList] = useState(true);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    setTimeout(() => {
      setConversations(mockConversations);
      setLoading(false);
    }, 500);
  }, []);

  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [selectedConversation?.messages]);

  const formatTime = (timestamp: string) => {
    const date = new Date(timestamp);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));

    if (days === 0) {
      return date.toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit' });
    } else if (days === 1) {
      return 'Yesterday';
    } else if (days < 7) {
      return date.toLocaleDateString('en-IN', { weekday: 'short' });
    } else {
      return date.toLocaleDateString('en-IN', { day: 'numeric', month: 'short' });
    }
  };

  const formatMessageTime = (timestamp: string) => {
    const date = new Date(timestamp);
    return date.toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit' });
  };

  const formatMessageDate = (timestamp: string) => {
    const date = new Date(timestamp);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));

    if (days === 0) return 'Today';
    if (days === 1) return 'Yesterday';
    return date.toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });
  };

  const getRoleBadgeColor = (role: string) => {
    switch (role) {
      case 'AGENT': return 'bg-purple-100 text-purple-700';
      case 'BUYER': return 'bg-blue-100 text-blue-700';
      case 'SELLER': return 'bg-green-100 text-green-700';
      default: return 'bg-gray-100 text-gray-700';
    }
  };

  const handleSendMessage = () => {
    if (!newMessage.trim() || !selectedConversation) return;

    const newMsg: Message = {
      id: `m${Date.now()}`,
      content: newMessage,
      timestamp: new Date().toISOString(),
      senderId: 'user',
      read: true
    };

    setConversations(prev => prev.map(conv =>
      conv.id === selectedConversation.id
        ? { ...conv, messages: [...conv.messages, newMsg], lastMessage: newMsg }
        : conv
    ));

    setSelectedConversation(prev => prev ? {
      ...prev,
      messages: [...prev.messages, newMsg],
      lastMessage: newMsg
    } : null);

    setNewMessage('');
  };

  const handleSelectConversation = (conv: Conversation) => {
    setSelectedConversation(conv);
    setShowMobileList(false);
    
    // Mark messages as read
    if (conv.unreadCount > 0) {
      setConversations(prev => prev.map(c =>
        c.id === conv.id ? { ...c, unreadCount: 0 } : c
      ));
    }
  };

  const filteredConversations = conversations.filter(conv =>
    conv.participant.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
    conv.property?.title.toLowerCase().includes(searchQuery.toLowerCase())
  );

  const totalUnread = conversations.reduce((sum, conv) => sum + conv.unreadCount, 0);

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="h-[calc(100vh-180px)] flex flex-col">
      {/* Header */}
      <div className="flex items-center justify-between mb-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Messages</h1>
          {totalUnread > 0 && (
            <p className="text-gray-600">{totalUnread} unread message{totalUnread !== 1 ? 's' : ''}</p>
          )}
        </div>
        <button className="p-2 hover:bg-gray-100 rounded-lg transition-colors">
          <svg className="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
          </svg>
        </button>
      </div>

      <div className="flex-1 flex bg-white rounded-xl border border-gray-200 overflow-hidden">
        {/* Conversations List */}
        <div className={`w-full md:w-96 border-r border-gray-200 flex flex-col ${!showMobileList && selectedConversation ? 'hidden md:flex' : 'flex'}`}>
          {/* Search */}
          <div className="p-4 border-b border-gray-200">
            <div className="relative">
              <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <input
                type="text"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                placeholder="Search conversations..."
                className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
              />
            </div>
          </div>

          {/* Conversation List */}
          <div className="flex-1 overflow-y-auto">
            {filteredConversations.length === 0 ? (
              <div className="p-8 text-center">
                <svg className="w-12 h-12 mx-auto text-gray-300 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
                <p className="text-gray-500">No conversations found</p>
              </div>
            ) : (
              filteredConversations.map((conv) => (
                <motion.button
                  key={conv.id}
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  onClick={() => handleSelectConversation(conv)}
                  className={`w-full p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors text-left ${
                    selectedConversation?.id === conv.id ? 'bg-orange-50' : ''
                  }`}
                >
                  <div className="flex items-start gap-3">
                    <div className="relative flex-shrink-0">
                      <img
                        src={conv.participant.photo}
                        alt={conv.participant.name}
                        className="w-12 h-12 rounded-full object-cover"
                      />
                      {conv.participant.online && (
                        <div className="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white" />
                      )}
                    </div>
                    <div className="flex-1 min-w-0">
                      <div className="flex items-center justify-between mb-1">
                        <div className="flex items-center gap-2">
                          <span className="font-medium text-gray-900 truncate">{conv.participant.name}</span>
                          <span className={`px-1.5 py-0.5 text-xs rounded ${getRoleBadgeColor(conv.participant.role)}`}>
                            {conv.participant.role}
                          </span>
                        </div>
                        <span className="text-xs text-gray-500 flex-shrink-0 ml-2">
                          {formatTime(conv.lastMessage.timestamp)}
                        </span>
                      </div>
                      {conv.property && (
                        <div className="flex items-center gap-2 mb-1">
                          <img
                            src={conv.property.image}
                            alt=""
                            className="w-5 h-5 rounded object-cover"
                          />
                          <span className="text-xs text-gray-500 truncate">{conv.property.title}</span>
                        </div>
                      )}
                      <div className="flex items-center justify-between">
                        <p className={`text-sm truncate ${conv.unreadCount > 0 ? 'text-gray-900 font-medium' : 'text-gray-500'}`}>
                          {conv.lastMessage.senderId === 'user' && 'You: '}
                          {conv.lastMessage.content}
                        </p>
                        {conv.unreadCount > 0 && (
                          <span className="ml-2 w-5 h-5 bg-orange-500 text-white text-xs rounded-full flex items-center justify-center flex-shrink-0">
                            {conv.unreadCount}
                          </span>
                        )}
                      </div>
                    </div>
                  </div>
                </motion.button>
              ))
            )}
          </div>
        </div>

        {/* Chat Area */}
        <div className={`flex-1 flex flex-col ${showMobileList && !selectedConversation ? 'hidden md:flex' : 'flex'}`}>
          {selectedConversation ? (
            <>
              {/* Chat Header */}
              <div className="p-4 border-b border-gray-200 flex items-center justify-between">
                <div className="flex items-center gap-3">
                  <button
                    onClick={() => setShowMobileList(true)}
                    className="md:hidden p-2 hover:bg-gray-100 rounded-lg"
                  >
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                    </svg>
                  </button>
                  <div className="relative">
                    <img
                      src={selectedConversation.participant.photo}
                      alt={selectedConversation.participant.name}
                      className="w-10 h-10 rounded-full object-cover"
                    />
                    {selectedConversation.participant.online && (
                      <div className="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 rounded-full border-2 border-white" />
                    )}
                  </div>
                  <div>
                    <div className="flex items-center gap-2">
                      <Link
                        href={selectedConversation.participant.role === 'AGENT' ? `/agent/${selectedConversation.participant.id}` : '#'}
                        className="font-medium text-gray-900 hover:text-orange-600"
                      >
                        {selectedConversation.participant.name}
                      </Link>
                      <span className={`px-1.5 py-0.5 text-xs rounded ${getRoleBadgeColor(selectedConversation.participant.role)}`}>
                        {selectedConversation.participant.role}
                      </span>
                    </div>
                    <p className="text-xs text-gray-500">
                      {selectedConversation.participant.online ? 'Online' : 'Offline'}
                    </p>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  {selectedConversation.property && (
                    <Link
                      href={`/property/${selectedConversation.property.id}`}
                      className="hidden md:flex items-center gap-2 px-3 py-1.5 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"
                    >
                      <img
                        src={selectedConversation.property.image}
                        alt=""
                        className="w-6 h-6 rounded object-cover"
                      />
                      <span className="text-sm text-gray-700 max-w-[150px] truncate">
                        {selectedConversation.property.title}
                      </span>
                    </Link>
                  )}
                  <button className="p-2 hover:bg-gray-100 rounded-lg">
                    <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                  </button>
                  <button className="p-2 hover:bg-gray-100 rounded-lg">
                    <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                    </svg>
                  </button>
                  <button className="p-2 hover:bg-gray-100 rounded-lg">
                    <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                    </svg>
                  </button>
                </div>
              </div>

              {/* Messages */}
              <div className="flex-1 overflow-y-auto p-4 space-y-4">
                {selectedConversation.messages.reduce((acc: JSX.Element[], msg, index, arr) => {
                  const currentDate = formatMessageDate(msg.timestamp);
                  const prevDate = index > 0 ? formatMessageDate(arr[index - 1].timestamp) : null;

                  if (currentDate !== prevDate) {
                    acc.push(
                      <div key={`date-${msg.id}`} className="flex items-center justify-center my-4">
                        <span className="px-3 py-1 bg-gray-100 text-gray-500 text-xs rounded-full">
                          {currentDate}
                        </span>
                      </div>
                    );
                  }

                  const isUser = msg.senderId === 'user';
                  acc.push(
                    <motion.div
                      key={msg.id}
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      className={`flex ${isUser ? 'justify-end' : 'justify-start'}`}
                    >
                      <div className={`max-w-[75%] ${isUser ? 'order-2' : 'order-1'}`}>
                        {!isUser && (
                          <img
                            src={selectedConversation.participant.photo}
                            alt=""
                            className="w-6 h-6 rounded-full mb-1"
                          />
                        )}
                        <div
                          className={`px-4 py-2 rounded-2xl ${
                            isUser
                              ? 'bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-br-md'
                              : 'bg-gray-100 text-gray-900 rounded-bl-md'
                          }`}
                        >
                          <p className="text-sm whitespace-pre-wrap">{msg.content}</p>
                        </div>
                        <div className={`mt-1 text-xs text-gray-400 ${isUser ? 'text-right' : 'text-left'}`}>
                          {formatMessageTime(msg.timestamp)}
                          {isUser && msg.read && (
                            <span className="ml-2">✓✓</span>
                          )}
                        </div>
                      </div>
                    </motion.div>
                  );

                  return acc;
                }, [])}
                <div ref={messagesEndRef} />
              </div>

              {/* Message Input */}
              <div className="p-4 border-t border-gray-200">
                <div className="flex items-end gap-2">
                  <button className="p-2 hover:bg-gray-100 rounded-lg">
                    <svg className="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                    </svg>
                  </button>
                  <div className="flex-1 relative">
                    <textarea
                      value={newMessage}
                      onChange={(e) => setNewMessage(e.target.value)}
                      onKeyDown={(e) => {
                        if (e.key === 'Enter' && !e.shiftKey) {
                          e.preventDefault();
                          handleSendMessage();
                        }
                      }}
                      placeholder="Type a message..."
                      rows={1}
                      className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none"
                    />
                  </div>
                  <button
                    onClick={handleSendMessage}
                    disabled={!newMessage.trim()}
                    className="p-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-xl hover:from-orange-600 hover:to-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                  </button>
                </div>
              </div>
            </>
          ) : (
            <div className="flex-1 flex items-center justify-center">
              <div className="text-center">
                <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
                <h3 className="text-lg font-medium text-gray-900 mb-2">No conversation selected</h3>
                <p className="text-gray-500">Choose a conversation from the list to start messaging</p>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
}
Page · TSX
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface Document {
  id: string;
  name: string;
  type: 'CONTRACT' | 'DEED' | 'INSPECTION' | 'VASTU' | 'DISCLOSURE' | 'FINANCIAL' | 'ID' | 'OTHER';
  status: 'PENDING_SIGNATURE' | 'SIGNED' | 'UPLOADED' | 'REJECTED' | 'EXPIRED';
  fileType: 'pdf' | 'docx' | 'jpg' | 'png';
  fileSize: string;
  uploadedAt: string;
  expiresAt?: string;
  propertyId?: string;
  propertyTitle?: string;
  signedBy?: string[];
  pendingSignatures?: string[];
  url: string;
}

const mockDocuments: Document[] = [
  {
    id: '1',
    name: 'Purchase Agreement - 4BHK Villa Koramangala',
    type: 'CONTRACT',
    status: 'PENDING_SIGNATURE',
    fileType: 'pdf',
    fileSize: '2.4 MB',
    uploadedAt: '2024-12-18T10:00:00',
    expiresAt: '2024-12-25T23:59:00',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    signedBy: ['Seller - Vikram Mehta'],
    pendingSignatures: ['Buyer - You', 'Agent - Priya Sharma'],
    url: '/documents/purchase-agreement.pdf'
  },
  {
    id: '2',
    name: 'Vastu Compliance Certificate',
    type: 'VASTU',
    status: 'UPLOADED',
    fileType: 'pdf',
    fileSize: '1.2 MB',
    uploadedAt: '2024-12-17T14:00:00',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    url: '/documents/vastu-certificate.pdf'
  },
  {
    id: '3',
    name: 'Home Inspection Report',
    type: 'INSPECTION',
    status: 'UPLOADED',
    fileType: 'pdf',
    fileSize: '5.8 MB',
    uploadedAt: '2024-12-16T09:00:00',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    url: '/documents/inspection-report.pdf'
  },
  {
    id: '4',
    name: 'Property Deed',
    type: 'DEED',
    status: 'SIGNED',
    fileType: 'pdf',
    fileSize: '3.1 MB',
    uploadedAt: '2024-12-10T11:00:00',
    propertyId: 'prop2',
    propertyTitle: 'Modern 3BHK Apartment',
    signedBy: ['Seller - Anita Reddy', 'Buyer - You', 'Agent - Rahul Verma'],
    url: '/documents/property-deed.pdf'
  },
  {
    id: '5',
    name: 'Seller Disclosure Statement',
    type: 'DISCLOSURE',
    status: 'UPLOADED',
    fileType: 'pdf',
    fileSize: '890 KB',
    uploadedAt: '2024-12-15T16:00:00',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    url: '/documents/disclosure.pdf'
  },
  {
    id: '6',
    name: 'Loan Pre-Approval Letter',
    type: 'FINANCIAL',
    status: 'UPLOADED',
    fileType: 'pdf',
    fileSize: '450 KB',
    uploadedAt: '2024-12-12T10:00:00',
    expiresAt: '2025-01-12T23:59:00',
    url: '/documents/preapproval.pdf'
  },
  {
    id: '7',
    name: 'Aadhaar Card',
    type: 'ID',
    status: 'UPLOADED',
    fileType: 'jpg',
    fileSize: '1.5 MB',
    uploadedAt: '2024-12-01T10:00:00',
    url: '/documents/aadhaar.jpg'
  },
  {
    id: '8',
    name: 'Title Search Report',
    type: 'OTHER',
    status: 'PENDING_SIGNATURE',
    fileType: 'pdf',
    fileSize: '2.0 MB',
    uploadedAt: '2024-12-19T08:00:00',
    expiresAt: '2024-12-26T23:59:00',
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    pendingSignatures: ['Buyer - You'],
    url: '/documents/title-search.pdf'
  }
];

export default function DocumentsPage() {
  const [documents, setDocuments] = useState<Document[]>([]);
  const [loading, setLoading] = useState(true);
  const [filter, setFilter] = useState<'all' | Document['type']>('all');
  const [statusFilter, setStatusFilter] = useState<'all' | Document['status']>('all');
  const [searchQuery, setSearchQuery] = useState('');
  const [showUploadModal, setShowUploadModal] = useState(false);
  const [selectedDoc, setSelectedDoc] = useState<Document | null>(null);

  useEffect(() => {
    setTimeout(() => {
      setDocuments(mockDocuments);
      setLoading(false);
    }, 500);
  }, []);

  const getTypeIcon = (type: Document['type']) => {
    switch (type) {
      case 'CONTRACT':
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
        );
      case 'DEED':
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
          </svg>
        );
      case 'INSPECTION':
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
          </svg>
        );
      case 'VASTU':
        return (
          <span className="text-orange-500 font-bold">🕉️</span>
        );
      case 'DISCLOSURE':
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );
      case 'FINANCIAL':
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );
      case 'ID':
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2" />
          </svg>
        );
      default:
        return (
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
          </svg>
        );
    }
  };

  const getTypeColor = (type: Document['type']) => {
    switch (type) {
      case 'CONTRACT': return 'bg-purple-100 text-purple-700';
      case 'DEED': return 'bg-blue-100 text-blue-700';
      case 'INSPECTION': return 'bg-teal-100 text-teal-700';
      case 'VASTU': return 'bg-orange-100 text-orange-700';
      case 'DISCLOSURE': return 'bg-yellow-100 text-yellow-700';
      case 'FINANCIAL': return 'bg-green-100 text-green-700';
      case 'ID': return 'bg-gray-100 text-gray-700';
      default: return 'bg-gray-100 text-gray-700';
    }
  };

  const getStatusColor = (status: Document['status']) => {
    switch (status) {
      case 'PENDING_SIGNATURE': return 'bg-yellow-100 text-yellow-700 border-yellow-300';
      case 'SIGNED': return 'bg-green-100 text-green-700 border-green-300';
      case 'UPLOADED': return 'bg-blue-100 text-blue-700 border-blue-300';
      case 'REJECTED': return 'bg-red-100 text-red-700 border-red-300';
      case 'EXPIRED': return 'bg-gray-100 text-gray-500 border-gray-300';
      default: return 'bg-gray-100 text-gray-700 border-gray-300';
    }
  };

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' });
  };

  const getDaysRemaining = (expiresAt: string) => {
    const now = new Date();
    const expires = new Date(expiresAt);
    const diff = expires.getTime() - now.getTime();
    return Math.ceil(diff / (1000 * 60 * 60 * 24));
  };

  const getFileIcon = (fileType: Document['fileType']) => {
    switch (fileType) {
      case 'pdf':
        return <span className="text-red-500 font-bold text-xs">PDF</span>;
      case 'docx':
        return <span className="text-blue-500 font-bold text-xs">DOC</span>;
      case 'jpg':
      case 'png':
        return <span className="text-green-500 font-bold text-xs">IMG</span>;
      default:
        return <span className="text-gray-500 font-bold text-xs">FILE</span>;
    }
  };

  const filteredDocuments = documents.filter(doc => {
    const typeMatch = filter === 'all' || doc.type === filter;
    const statusMatch = statusFilter === 'all' || doc.status === statusFilter;
    const searchMatch = doc.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        doc.propertyTitle?.toLowerCase().includes(searchQuery.toLowerCase());
    return typeMatch && statusMatch && searchMatch;
  });

  const stats = {
    total: documents.length,
    pendingSignature: documents.filter(d => d.status === 'PENDING_SIGNATURE').length,
    signed: documents.filter(d => d.status === 'SIGNED').length,
    uploaded: documents.filter(d => d.status === 'UPLOADED').length
  };

  const documentTypes: Array<{ value: Document['type'] | 'all'; label: string }> = [
    { value: 'all', label: 'All Types' },
    { value: 'CONTRACT', label: 'Contracts' },
    { value: 'DEED', label: 'Deeds' },
    { value: 'INSPECTION', label: 'Inspections' },
    { value: 'VASTU', label: 'Vastu' },
    { value: 'DISCLOSURE', label: 'Disclosures' },
    { value: 'FINANCIAL', label: 'Financial' },
    { value: 'ID', label: 'ID Documents' },
    { value: 'OTHER', label: 'Other' }
  ];

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Documents</h1>
          <p className="text-gray-600 mt-1">Manage your property documents and signatures</p>
        </div>
        <button
          onClick={() => setShowUploadModal(true)}
          className="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors"
        >
          <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
          </svg>
          Upload Document
        </button>
      </div>

      {/* Alert for Pending Signatures */}
      {stats.pendingSignature > 0 && (
        <motion.div
          initial={{ opacity: 0, y: -10 }}
          animate={{ opacity: 1, y: 0 }}
          className="bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-center gap-4"
        >
          <div className="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">
            <svg className="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
          </div>
          <div className="flex-1">
            <h3 className="font-medium text-yellow-800">Action Required</h3>
            <p className="text-yellow-700 text-sm">You have {stats.pendingSignature} document{stats.pendingSignature !== 1 ? 's' : ''} awaiting your signature.</p>
          </div>
          <button
            onClick={() => setStatusFilter('PENDING_SIGNATURE')}
            className="px-4 py-2 bg-yellow-600 text-white rounded-lg font-medium hover:bg-yellow-700 transition-colors text-sm"
          >
            Review Now
          </button>
        </motion.div>
      )}

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-gray-900">{stats.total}</div>
          <div className="text-gray-600">Total Documents</div>
        </motion.div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.05 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-yellow-600">{stats.pendingSignature}</div>
          <div className="text-gray-600">Pending Signature</div>
        </motion.div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-green-600">{stats.signed}</div>
          <div className="text-gray-600">Signed</div>
        </motion.div>
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.15 }}
          className="bg-white rounded-xl border border-gray-200 p-4"
        >
          <div className="text-3xl font-bold text-blue-600">{stats.uploaded}</div>
          <div className="text-gray-600">Uploaded</div>
        </motion.div>
      </div>

      {/* Filters */}
      <div className="bg-white rounded-xl border border-gray-200 p-4">
        <div className="flex flex-col md:flex-row gap-4">
          {/* Search */}
          <div className="flex-1 relative">
            <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            <input
              type="text"
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              placeholder="Search documents..."
              className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
            />
          </div>

          {/* Type Filter */}
          <select
            value={filter}
            onChange={(e) => setFilter(e.target.value as typeof filter)}
            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
          >
            {documentTypes.map(type => (
              <option key={type.value} value={type.value}>{type.label}</option>
            ))}
          </select>

          {/* Status Filter */}
          <select
            value={statusFilter}
            onChange={(e) => setStatusFilter(e.target.value as typeof statusFilter)}
            className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
          >
            <option value="all">All Statuses</option>
            <option value="PENDING_SIGNATURE">Pending Signature</option>
            <option value="SIGNED">Signed</option>
            <option value="UPLOADED">Uploaded</option>
            <option value="REJECTED">Rejected</option>
            <option value="EXPIRED">Expired</option>
          </select>
        </div>
      </div>

      {/* Documents List */}
      <div className="space-y-3">
        <AnimatePresence>
          {filteredDocuments.length === 0 ? (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              className="text-center py-12 bg-white rounded-xl border border-gray-200"
            >
              <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
              <h3 className="text-lg font-medium text-gray-900 mb-2">No documents found</h3>
              <p className="text-gray-600 mb-4">Upload your first document to get started.</p>
              <button
                onClick={() => setShowUploadModal(true)}
                className="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium"
              >
                Upload Document
              </button>
            </motion.div>
          ) : (
            filteredDocuments.map((doc, index) => (
              <motion.div
                key={doc.id}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                exit={{ opacity: 0, x: -100 }}
                transition={{ delay: index * 0.05 }}
                className="bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow"
              >
                <div className="flex items-start gap-4">
                  {/* Icon */}
                  <div className={`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${getTypeColor(doc.type)}`}>
                    {getTypeIcon(doc.type)}
                  </div>

                  {/* Content */}
                  <div className="flex-1 min-w-0">
                    <div className="flex items-start justify-between gap-4">
                      <div>
                        <h3 className="font-medium text-gray-900 truncate">{doc.name}</h3>
                        <div className="flex items-center gap-3 mt-1 text-sm text-gray-500">
                          <span className="flex items-center gap-1">
                            {getFileIcon(doc.fileType)}
                            <span>{doc.fileSize}</span>
                          </span>
                          <span>Uploaded {formatDate(doc.uploadedAt)}</span>
                        </div>
                        {doc.propertyTitle && (
                          <Link
                            href={`/property/${doc.propertyId}`}
                            className="text-sm text-orange-600 hover:underline mt-1 inline-block"
                          >
                            {doc.propertyTitle}
                          </Link>
                        )}
                      </div>
                      <span className={`px-3 py-1 rounded-full text-xs font-medium border flex-shrink-0 ${getStatusColor(doc.status)}`}>
                        {doc.status.replace('_', ' ')}
                      </span>
                    </div>

                    {/* Signature Info */}
                    {doc.status === 'PENDING_SIGNATURE' && doc.pendingSignatures && (
                      <div className="mt-3 p-3 bg-yellow-50 rounded-lg">
                        <div className="text-sm text-yellow-800">
                          <span className="font-medium">Waiting for:</span> {doc.pendingSignatures.join(', ')}
                        </div>
                        {doc.expiresAt && (
                          <div className={`text-xs mt-1 ${getDaysRemaining(doc.expiresAt) <= 3 ? 'text-red-600' : 'text-yellow-600'}`}>
                            Expires in {getDaysRemaining(doc.expiresAt)} day{getDaysRemaining(doc.expiresAt) !== 1 ? 's' : ''}
                          </div>
                        )}
                      </div>
                    )}

                    {doc.status === 'SIGNED' && doc.signedBy && (
                      <div className="mt-3 flex items-center gap-2 text-sm text-green-700">
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                        </svg>
                        <span>Signed by: {doc.signedBy.join(', ')}</span>
                      </div>
                    )}

                    {/* Actions */}
                    <div className="mt-3 flex items-center gap-2">
                      <button className="px-3 py-1.5 text-gray-700 bg-gray-100 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors">
                        View
                      </button>
                      <button className="px-3 py-1.5 text-gray-700 bg-gray-100 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors">
                        Download
                      </button>
                      {doc.status === 'PENDING_SIGNATURE' && doc.pendingSignatures?.includes('Buyer - You') && (
                        <button className="px-3 py-1.5 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg text-sm font-medium hover:from-orange-600 hover:to-amber-600 transition-colors">
                          Sign Now
                        </button>
                      )}
                      <button className="px-3 py-1.5 text-red-600 hover:bg-red-50 rounded-lg text-sm font-medium transition-colors ml-auto">
                        Delete
                      </button>
                    </div>
                  </div>
                </div>
              </motion.div>
            ))
          )}
        </AnimatePresence>
      </div>

      {/* Upload Modal */}
      <AnimatePresence>
        {showUploadModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowUploadModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              onClick={(e) => e.stopPropagation()}
              className="bg-white rounded-2xl max-w-lg w-full p-6"
            >
              <h2 className="text-xl font-bold text-gray-900 mb-4">Upload Document</h2>
              
              {/* Upload Area */}
              <div className="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-orange-500 transition-colors cursor-pointer">
                <svg className="w-12 h-12 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p className="text-gray-600 mb-2">Drag and drop files here, or click to browse</p>
                <p className="text-gray-400 text-sm">Supports PDF, DOCX, JPG, PNG (Max 25MB)</p>
              </div>

              {/* Document Type */}
              <div className="mt-4">
                <label className="block text-sm font-medium text-gray-700 mb-1">Document Type</label>
                <select className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                  {documentTypes.filter(t => t.value !== 'all').map(type => (
                    <option key={type.value} value={type.value}>{type.label}</option>
                  ))}
                </select>
              </div>

              {/* Property (Optional) */}
              <div className="mt-4">
                <label className="block text-sm font-medium text-gray-700 mb-1">Related Property (Optional)</label>
                <select className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                  <option value="">No property</option>
                  <option value="prop1">Luxurious 4BHK Villa with Vastu</option>
                  <option value="prop2">Modern 3BHK Apartment</option>
                </select>
              </div>

              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowUploadModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                >
                  Cancel
                </button>
                <button className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors">
                  Upload
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
Page · TSX
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface BirthDetails {
  date: string;
  time: string;
  place: string;
  latitude: number;
  longitude: number;
}

interface PlanetaryPosition {
  planet: string;
  sign: string;
  house: number;
  degree: number;
  retrograde: boolean;
}

interface AstrologyProfile {
  rashi: string; // Moon Sign
  nakshatra: string;
  lagna: string; // Ascendant
  planetaryPositions: PlanetaryPosition[];
  currentDasha: {
    mahadasha: string;
    antardasha: string;
    startDate: string;
    endDate: string;
  };
  favorableDirections: string[];
  favorableColors: string[];
  favorableNumbers: number[];
  auspiciousDays: string[];
}

interface PropertyCompatibility {
  propertyId: string;
  propertyTitle: string;
  propertyImage: string;
  propertyAddress: string;
  compatibilityScore: number;
  vastuScore: number;
  astrologyFactors: Array<{
    factor: string;
    status: 'excellent' | 'good' | 'neutral' | 'caution';
    description: string;
  }>;
  recommendations: string[];
  muhurat: {
    bestDates: string[];
    avoidDates: string[];
  };
}

const mockProfile: AstrologyProfile = {
  rashi: 'Vrishabha (Taurus)',
  nakshatra: 'Rohini',
  lagna: 'Simha (Leo)',
  planetaryPositions: [
    { planet: 'Sun', sign: 'Aries', house: 9, degree: 15.4, retrograde: false },
    { planet: 'Moon', sign: 'Taurus', house: 10, degree: 8.2, retrograde: false },
    { planet: 'Mars', sign: 'Gemini', house: 11, degree: 22.7, retrograde: false },
    { planet: 'Mercury', sign: 'Aries', house: 9, degree: 5.1, retrograde: true },
    { planet: 'Jupiter', sign: 'Sagittarius', house: 5, degree: 18.9, retrograde: false },
    { planet: 'Venus', sign: 'Pisces', house: 8, degree: 27.3, retrograde: false },
    { planet: 'Saturn', sign: 'Capricorn', house: 6, degree: 11.6, retrograde: false },
    { planet: 'Rahu', sign: 'Cancer', house: 12, degree: 3.8, retrograde: true },
    { planet: 'Ketu', sign: 'Capricorn', house: 6, degree: 3.8, retrograde: true }
  ],
  currentDasha: {
    mahadasha: 'Jupiter',
    antardasha: 'Venus',
    startDate: '2024-03-15',
    endDate: '2026-11-15'
  },
  favorableDirections: ['East', 'North', 'Northeast'],
  favorableColors: ['White', 'Cream', 'Light Blue', 'Green'],
  favorableNumbers: [2, 6, 9],
  auspiciousDays: ['Friday', 'Monday', 'Wednesday']
};

const mockCompatibilities: PropertyCompatibility[] = [
  {
    propertyId: 'prop1',
    propertyTitle: 'Luxurious 4BHK Villa with Vastu',
    propertyImage: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=400',
    propertyAddress: '123 Koramangala 4th Block, Bangalore',
    compatibilityScore: 92,
    vastuScore: 95,
    astrologyFactors: [
      { factor: 'Main Entrance Direction', status: 'excellent', description: 'East-facing entrance aligns perfectly with your favorable direction' },
      { factor: 'Master Bedroom Position', status: 'good', description: 'Southwest placement supports stability and grounding' },
      { factor: 'Kitchen Location', status: 'excellent', description: 'Southeast kitchen enhances prosperity and health' },
      { factor: 'Property Number', status: 'neutral', description: 'Building number 123 reduces to 6, which is favorable' }
    ],
    recommendations: [
      'Place a Tulsi plant in the Northeast corner',
      'Use light blue curtains in the living room',
      'Install a small water feature near the entrance'
    ],
    muhurat: {
      bestDates: ['2025-01-10', '2025-01-17', '2025-01-24'],
      avoidDates: ['2025-01-08', '2025-01-15', '2025-01-22']
    }
  },
  {
    propertyId: 'prop2',
    propertyTitle: 'Modern 3BHK Apartment',
    propertyImage: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400',
    propertyAddress: '456 HSR Layout, Bangalore',
    compatibilityScore: 78,
    vastuScore: 82,
    astrologyFactors: [
      { factor: 'Main Entrance Direction', status: 'good', description: 'North-facing entrance is favorable for you' },
      { factor: 'Master Bedroom Position', status: 'caution', description: 'Southeast bedroom may cause restlessness' },
      { factor: 'Kitchen Location', status: 'good', description: 'Kitchen placement is acceptable' },
      { factor: 'Floor Level', status: 'excellent', description: '6th floor aligns with your favorable number' }
    ],
    recommendations: [
      'Consider placing the bed with head towards South',
      'Use green plants in the bedroom for better sleep',
      'Avoid red colors in the bedroom'
    ],
    muhurat: {
      bestDates: ['2025-01-12', '2025-01-19'],
      avoidDates: ['2025-01-09', '2025-01-16']
    }
  }
];

export default function AstrologyPage() {
  const [loading, setLoading] = useState(true);
  const [birthDetails, setBirthDetails] = useState<BirthDetails | null>(null);
  const [profile, setProfile] = useState<AstrologyProfile | null>(null);
  const [compatibilities, setCompatibilities] = useState<PropertyCompatibility[]>([]);
  const [showSetupModal, setShowSetupModal] = useState(false);
  const [activeTab, setActiveTab] = useState<'profile' | 'compatibility' | 'muhurat'>('profile');
  const [setupForm, setSetupForm] = useState({
    date: '',
    time: '',
    place: ''
  });

  useEffect(() => {
    setTimeout(() => {
      // Simulating user has already set up their profile
      setBirthDetails({
        date: '1990-04-15',
        time: '06:30',
        place: 'Mumbai, Maharashtra',
        latitude: 19.076,
        longitude: 72.8777
      });
      setProfile(mockProfile);
      setCompatibilities(mockCompatibilities);
      setLoading(false);
    }, 500);
  }, []);

  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'excellent': return 'text-green-600 bg-green-100';
      case 'good': return 'text-blue-600 bg-blue-100';
      case 'neutral': return 'text-gray-600 bg-gray-100';
      case 'caution': return 'text-yellow-600 bg-yellow-100';
      default: return 'text-gray-600 bg-gray-100';
    }
  };

  const getStatusIcon = (status: string) => {
    switch (status) {
      case 'excellent':
        return (
          <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );
      case 'good':
        return (
          <svg className="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
          </svg>
        );
      case 'caution':
        return (
          <svg className="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
        );
      default:
        return (
          <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );
    }
  };

  const getScoreColor = (score: number) => {
    if (score >= 90) return 'text-green-600';
    if (score >= 75) return 'text-blue-600';
    if (score >= 60) return 'text-yellow-600';
    return 'text-red-600';
  };

  const handleSetupSubmit = () => {
    // In real app, would calculate profile from birth details
    setBirthDetails({
      date: setupForm.date,
      time: setupForm.time,
      place: setupForm.place,
      latitude: 19.076,
      longitude: 72.8777
    });
    setProfile(mockProfile);
    setCompatibilities(mockCompatibilities);
    setShowSetupModal(false);
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  if (!profile) {
    return (
      <div className="max-w-2xl mx-auto">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl p-8 text-center"
        >
          <div className="w-20 h-20 bg-gradient-to-r from-orange-500 to-amber-500 rounded-full flex items-center justify-center mx-auto mb-6">
            <span className="text-4xl">🕉️</span>
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-3">Jyotish Compatibility</h1>
          <p className="text-gray-600 mb-6">
            Unlock personalized property recommendations based on ancient Vedic astrology. 
            Discover how different properties align with your cosmic blueprint.
          </p>
          <button
            onClick={() => setShowSetupModal(true)}
            className="px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors"
          >
            Set Up Your Profile
          </button>
        </motion.div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900 flex items-center gap-2">
            <span className="text-orange-500">🕉️</span>
            Jyotish Compatibility
          </h1>
          <p className="text-gray-600 mt-1">Property recommendations aligned with your Vedic astrology profile</p>
        </div>
        <button
          onClick={() => setShowSetupModal(true)}
          className="px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors"
        >
          Update Birth Details
        </button>
      </div>

      {/* Tabs */}
      <div className="flex gap-2 border-b border-gray-200">
        {[
          { id: 'profile', label: 'Your Profile' },
          { id: 'compatibility', label: 'Property Match' },
          { id: 'muhurat', label: 'Auspicious Times' }
        ].map((tab) => (
          <button
            key={tab.id}
            onClick={() => setActiveTab(tab.id as typeof activeTab)}
            className={`px-4 py-3 font-medium border-b-2 transition-colors ${
              activeTab === tab.id
                ? 'text-orange-600 border-orange-600'
                : 'text-gray-500 border-transparent hover:text-gray-700'
            }`}
          >
            {tab.label}
          </button>
        ))}
      </div>

      {/* Profile Tab */}
      {activeTab === 'profile' && profile && (
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          className="space-y-6"
        >
          {/* Birth Details Card */}
          <div className="bg-white rounded-xl border border-gray-200 p-6">
            <h2 className="text-lg font-semibold text-gray-900 mb-4">Birth Details</h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <div className="text-sm text-gray-500">Date of Birth</div>
                <div className="font-medium text-gray-900">{birthDetails && formatDate(birthDetails.date)}</div>
              </div>
              <div>
                <div className="text-sm text-gray-500">Time of Birth</div>
                <div className="font-medium text-gray-900">{birthDetails?.time}</div>
              </div>
              <div>
                <div className="text-sm text-gray-500">Place of Birth</div>
                <div className="font-medium text-gray-900">{birthDetails?.place}</div>
              </div>
            </div>
          </div>

          {/* Key Indicators */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div className="bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6">
              <div className="text-sm text-orange-600 font-medium mb-1">Moon Sign (Rashi)</div>
              <div className="text-xl font-bold text-gray-900">{profile.rashi}</div>
            </div>
            <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6">
              <div className="text-sm text-purple-600 font-medium mb-1">Birth Star (Nakshatra)</div>
              <div className="text-xl font-bold text-gray-900">{profile.nakshatra}</div>
            </div>
            <div className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-6">
              <div className="text-sm text-blue-600 font-medium mb-1">Ascendant (Lagna)</div>
              <div className="text-xl font-bold text-gray-900">{profile.lagna}</div>
            </div>
          </div>

          {/* Current Dasha */}
          <div className="bg-white rounded-xl border border-gray-200 p-6">
            <h2 className="text-lg font-semibold text-gray-900 mb-4">Current Planetary Period (Dasha)</h2>
            <div className="flex items-center gap-6">
              <div className="w-16 h-16 bg-gradient-to-r from-yellow-400 to-orange-400 rounded-full flex items-center justify-center text-white text-2xl">
                ♃
              </div>
              <div>
                <div className="text-xl font-bold text-gray-900">
                  {profile.currentDasha.mahadasha} - {profile.currentDasha.antardasha}
                </div>
                <div className="text-gray-600">
                  {formatDate(profile.currentDasha.startDate)} to {formatDate(profile.currentDasha.endDate)}
                </div>
                <div className="mt-2 text-sm text-green-600">
                  Jupiter period is excellent for property acquisition and long-term investments
                </div>
              </div>
            </div>
          </div>

          {/* Favorable Factors */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div className="bg-white rounded-xl border border-gray-200 p-6">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">Favorable for Property</h2>
              <div className="space-y-4">
                <div>
                  <div className="text-sm text-gray-500 mb-2">Directions</div>
                  <div className="flex flex-wrap gap-2">
                    {profile.favorableDirections.map((dir, i) => (
                      <span key={i} className="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium">
                        {dir}
                      </span>
                    ))}
                  </div>
                </div>
                <div>
                  <div className="text-sm text-gray-500 mb-2">Colors</div>
                  <div className="flex flex-wrap gap-2">
                    {profile.favorableColors.map((color, i) => (
                      <span key={i} className="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium">
                        {color}
                      </span>
                    ))}
                  </div>
                </div>
                <div>
                  <div className="text-sm text-gray-500 mb-2">Numbers</div>
                  <div className="flex flex-wrap gap-2">
                    {profile.favorableNumbers.map((num, i) => (
                      <span key={i} className="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-medium">
                        {num}
                      </span>
                    ))}
                  </div>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-xl border border-gray-200 p-6">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">Planetary Positions</h2>
              <div className="space-y-2 max-h-64 overflow-y-auto">
                {profile.planetaryPositions.map((planet, i) => (
                  <div key={i} className="flex items-center justify-between py-2 border-b border-gray-100 last:border-0">
                    <div className="flex items-center gap-2">
                      <span className="font-medium text-gray-900">{planet.planet}</span>
                      {planet.retrograde && (
                        <span className="text-xs text-red-500">(R)</span>
                      )}
                    </div>
                    <div className="text-sm text-gray-600">
                      {planet.sign} • House {planet.house} • {planet.degree.toFixed(1)}°
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </motion.div>
      )}

      {/* Compatibility Tab */}
      {activeTab === 'compatibility' && (
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          className="space-y-6"
        >
          {compatibilities.length === 0 ? (
            <div className="text-center py-12 bg-white rounded-xl border border-gray-200">
              <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
              </svg>
              <h3 className="text-lg font-medium text-gray-900 mb-2">No saved properties</h3>
              <p className="text-gray-600 mb-4">Save properties to see their astrological compatibility</p>
              <Link
                href="/search"
                className="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium"
              >
                Browse Properties
              </Link>
            </div>
          ) : (
            compatibilities.map((comp, index) => (
              <motion.div
                key={comp.propertyId}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.1 }}
                className="bg-white rounded-xl border border-gray-200 overflow-hidden"
              >
                <div className="flex flex-col md:flex-row">
                  {/* Property Image */}
                  <div className="relative w-full md:w-64 h-48 md:h-auto flex-shrink-0">
                    <img
                      src={comp.propertyImage}
                      alt={comp.propertyTitle}
                      className="w-full h-full object-cover"
                    />
                    <div className="absolute top-3 left-3 flex gap-2">
                      <div className={`px-3 py-1 rounded-full text-sm font-bold bg-white/90 ${getScoreColor(comp.compatibilityScore)}`}>
                        {comp.compatibilityScore}% Match
                      </div>
                    </div>
                  </div>

                  {/* Content */}
                  <div className="flex-1 p-5">
                    <Link href={`/property/${comp.propertyId}`} className="hover:text-orange-600">
                      <h3 className="text-lg font-semibold text-gray-900">{comp.propertyTitle}</h3>
                    </Link>
                    <p className="text-gray-600 text-sm mt-1">{comp.propertyAddress}</p>

                    {/* Scores */}
                    <div className="flex gap-4 mt-4">
                      <div className="text-center">
                        <div className={`text-2xl font-bold ${getScoreColor(comp.compatibilityScore)}`}>
                          {comp.compatibilityScore}%
                        </div>
                        <div className="text-xs text-gray-500">Astro Match</div>
                      </div>
                      <div className="text-center">
                        <div className={`text-2xl font-bold ${getScoreColor(comp.vastuScore)}`}>
                          {comp.vastuScore}%
                        </div>
                        <div className="text-xs text-gray-500">Vastu Score</div>
                      </div>
                    </div>

                    {/* Factors */}
                    <div className="mt-4 space-y-2">
                      {comp.astrologyFactors.map((factor, i) => (
                        <div key={i} className="flex items-start gap-3">
                          {getStatusIcon(factor.status)}
                          <div>
                            <span className="font-medium text-gray-900">{factor.factor}:</span>
                            <span className="text-gray-600 ml-1">{factor.description}</span>
                          </div>
                        </div>
                      ))}
                    </div>

                    {/* Recommendations */}
                    {comp.recommendations.length > 0 && (
                      <div className="mt-4 p-3 bg-orange-50 rounded-lg">
                        <div className="text-sm font-medium text-orange-800 mb-2">Recommendations:</div>
                        <ul className="text-sm text-orange-700 space-y-1">
                          {comp.recommendations.map((rec, i) => (
                            <li key={i}>• {rec}</li>
                          ))}
                        </ul>
                      </div>
                    )}

                    <div className="mt-4 flex gap-2">
                      <Link
                        href={`/property/${comp.propertyId}`}
                        className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors text-sm"
                      >
                        View Property
                      </Link>
                      <button className="px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors text-sm">
                        View Full Report
                      </button>
                    </div>
                  </div>
                </div>
              </motion.div>
            ))
          )}
        </motion.div>
      )}

      {/* Muhurat Tab */}
      {activeTab === 'muhurat' && (
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          className="space-y-6"
        >
          <div className="bg-white rounded-xl border border-gray-200 p-6">
            <h2 className="text-lg font-semibold text-gray-900 mb-4">Auspicious Times for Property Transactions</h2>
            <p className="text-gray-600 mb-6">
              Based on your birth chart and current planetary transits, here are the most favorable 
              times for property-related activities like signing agreements, possession, and griha pravesh.
            </p>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <h3 className="font-medium text-green-700 mb-3 flex items-center gap-2">
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                  </svg>
                  Best Dates (January 2025)
                </h3>
                <div className="space-y-2">
                  {['Jan 10 (Friday)', 'Jan 17 (Friday)', 'Jan 24 (Friday)', 'Jan 27 (Monday)'].map((date, i) => (
                    <div key={i} className="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                      <span className="text-green-800">{date}</span>
                      <span className="text-xs text-green-600">Shubh Muhurat</span>
                    </div>
                  ))}
                </div>
              </div>
              <div>
                <h3 className="font-medium text-red-700 mb-3 flex items-center gap-2">
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                  Dates to Avoid
                </h3>
                <div className="space-y-2">
                  {['Jan 8 (Wed) - Rahu Kaal', 'Jan 14 (Tue) - Amavasya', 'Jan 15 (Wed) - Makar Sankranti', 'Jan 22 (Wed) - Ekadashi'].map((date, i) => (
                    <div key={i} className="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                      <span className="text-red-800">{date}</span>
                      <span className="text-xs text-red-600">Avoid</span>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>

          <div className="bg-gradient-to-r from-orange-500 to-amber-500 rounded-xl p-6 text-white">
            <h3 className="font-semibold text-lg mb-2">Need a Personalized Muhurat?</h3>
            <p className="text-orange-100 mb-4">
              Get a detailed muhurat analysis for your specific property transaction with exact timings.
            </p>
            <button className="px-4 py-2 bg-white text-orange-600 rounded-lg font-medium hover:bg-orange-50 transition-colors">
              Consult Jyotish Expert
            </button>
          </div>
        </motion.div>
      )}

      {/* Setup Modal */}
      <AnimatePresence>
        {showSetupModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowSetupModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              onClick={(e) => e.stopPropagation()}
              className="bg-white rounded-2xl max-w-md w-full p-6"
            >
              <div className="text-center mb-6">
                <div className="w-16 h-16 bg-gradient-to-r from-orange-500 to-amber-500 rounded-full flex items-center justify-center mx-auto mb-4">
                  <span className="text-3xl">🕉️</span>
                </div>
                <h2 className="text-xl font-bold text-gray-900">Birth Details</h2>
                <p className="text-gray-600 text-sm mt-1">For accurate Jyotish calculations</p>
              </div>

              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
                  <input
                    type="date"
                    value={setupForm.date}
                    onChange={(e) => setSetupForm(prev => ({ ...prev, date: e.target.value }))}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Time of Birth</label>
                  <input
                    type="time"
                    value={setupForm.time}
                    onChange={(e) => setSetupForm(prev => ({ ...prev, time: e.target.value }))}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  />
                  <p className="text-xs text-gray-500 mt-1">Accurate time helps in precise calculations</p>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Place of Birth</label>
                  <input
                    type="text"
                    value={setupForm.place}
                    onChange={(e) => setSetupForm(prev => ({ ...prev, place: e.target.value }))}
                    placeholder="City, State"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  />
                </div>
              </div>

              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowSetupModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg font-medium hover:bg-gray-50 transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={handleSetupSubmit}
                  disabled={!setupForm.date || !setupForm.time || !setupForm.place}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-colors disabled:opacity-50"
                >
                  Calculate Profile
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}










'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface UserProfile {
  id: string;
  firstName: string;
  lastName: string;
  email: string;
  phone: string;
  avatar: string;
  role: 'BUYER' | 'SELLER' | 'AGENT' | 'ADMIN';
  createdAt: string;
  emailVerified: boolean;
  phoneVerified: boolean;
  twoFactorEnabled: boolean;
}

interface NotificationSettings {
  emailNotifications: boolean;
  smsNotifications: boolean;
  pushNotifications: boolean;
  newListings: boolean;
  priceChanges: boolean;
  openHouses: boolean;
  savedSearchAlerts: boolean;
  offerUpdates: boolean;
  documentUpdates: boolean;
  showingReminders: boolean;
  marketReports: boolean;
  newsletter: boolean;
}

interface PrivacySettings {
  profileVisibility: 'PUBLIC' | 'PRIVATE' | 'AGENTS_ONLY';
  showContactInfo: boolean;
  showSearchHistory: boolean;
  allowDataAnalytics: boolean;
  shareWithPartners: boolean;
}

interface PreferenceSettings {
  language: string;
  currency: string;
  timezone: string;
  measurementUnit: 'SQFT' | 'SQMT';
  dateFormat: string;
  theme: 'LIGHT' | 'DARK' | 'SYSTEM';
  defaultView: 'LIST' | 'GRID' | 'MAP';
  resultsPerPage: number;
}

interface VastuPreferences {
  enabled: boolean;
  minScore: number;
  priorityFactors: string[];
  avoidFactors: string[];
}

interface AstrologyPreferences {
  enabled: boolean;
  birthDate: string;
  birthTime: string;
  birthPlace: string;
  considerMuhurat: boolean;
  considerDirections: boolean;
}

const mockUserProfile: UserProfile = {
  id: 'user-1',
  firstName: 'Rajesh',
  lastName: 'Kumar',
  email: 'rajesh.kumar@example.com',
  phone: '+91 98765 43210',
  avatar: '/avatars/user-1.jpg',
  role: 'BUYER',
  createdAt: '2024-01-15',
  emailVerified: true,
  phoneVerified: false,
  twoFactorEnabled: false,
};

const mockNotificationSettings: NotificationSettings = {
  emailNotifications: true,
  smsNotifications: true,
  pushNotifications: true,
  newListings: true,
  priceChanges: true,
  openHouses: false,
  savedSearchAlerts: true,
  offerUpdates: true,
  documentUpdates: true,
  showingReminders: true,
  marketReports: false,
  newsletter: true,
};

const mockPrivacySettings: PrivacySettings = {
  profileVisibility: 'AGENTS_ONLY',
  showContactInfo: false,
  showSearchHistory: true,
  allowDataAnalytics: true,
  shareWithPartners: false,
};

const mockPreferenceSettings: PreferenceSettings = {
  language: 'en',
  currency: 'INR',
  timezone: 'Asia/Kolkata',
  measurementUnit: 'SQFT',
  dateFormat: 'DD/MM/YYYY',
  theme: 'LIGHT',
  defaultView: 'GRID',
  resultsPerPage: 20,
};

const mockVastuPreferences: VastuPreferences = {
  enabled: true,
  minScore: 70,
  priorityFactors: ['Main Entrance', 'Kitchen Placement', 'Master Bedroom'],
  avoidFactors: ['South-facing Entrance', 'Toilet in Northeast'],
};

const mockAstrologyPreferences: AstrologyPreferences = {
  enabled: true,
  birthDate: '1985-03-15',
  birthTime: '10:30',
  birthPlace: 'Mumbai, Maharashtra',
  considerMuhurat: true,
  considerDirections: true,
};

type SettingsTab = 'profile' | 'notifications' | 'privacy' | 'preferences' | 'dharma' | 'security';

export default function SettingsPage() {
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [activeTab, setActiveTab] = useState<SettingsTab>('profile');
  const [profile, setProfile] = useState<UserProfile>(mockUserProfile);
  const [notifications, setNotifications] = useState<NotificationSettings>(mockNotificationSettings);
  const [privacy, setPrivacy] = useState<PrivacySettings>(mockPrivacySettings);
  const [preferences, setPreferences] = useState<PreferenceSettings>(mockPreferenceSettings);
  const [vastu, setVastu] = useState<VastuPreferences>(mockVastuPreferences);
  const [astrology, setAstrology] = useState<AstrologyPreferences>(mockAstrologyPreferences);
  const [showPasswordModal, setShowPasswordModal] = useState(false);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [successMessage, setSuccessMessage] = useState('');

  useEffect(() => {
    setTimeout(() => setLoading(false), 500);
  }, []);

  const handleSave = async () => {
    setSaving(true);
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 1000));
    setSaving(false);
    setSuccessMessage('Settings saved successfully!');
    setTimeout(() => setSuccessMessage(''), 3000);
  };

  const tabs: { id: SettingsTab; label: string; icon: JSX.Element }[] = [
    {
      id: 'profile',
      label: 'Profile',
      icon: (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
        </svg>
      ),
    },
    {
      id: 'notifications',
      label: 'Notifications',
      icon: (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
        </svg>
      ),
    },
    {
      id: 'privacy',
      label: 'Privacy',
      icon: (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
      ),
    },
    {
      id: 'preferences',
      label: 'Preferences',
      icon: (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
        </svg>
      ),
    },
    {
      id: 'dharma',
      label: 'Dharma Settings',
      icon: <span className="text-lg">🕉️</span>,
    },
    {
      id: 'security',
      label: 'Security',
      icon: (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
      ),
    },
  ];

  const Toggle = ({ enabled, onChange, label, description }: { enabled: boolean; onChange: (val: boolean) => void; label: string; description?: string }) => (
    <div className="flex items-center justify-between py-3">
      <div>
        <p className="font-medium text-gray-900">{label}</p>
        {description && <p className="text-sm text-gray-500">{description}</p>}
      </div>
      <button
        onClick={() => onChange(!enabled)}
        className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${
          enabled ? 'bg-orange-500' : 'bg-gray-200'
        }`}
      >
        <span
          className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
            enabled ? 'translate-x-6' : 'translate-x-1'
          }`}
        />
      </button>
    </div>
  );

  if (loading) {
    return (
      <div className="flex items-center justify-center h-96">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Settings</h1>
          <p className="text-gray-600">Manage your account and preferences</p>
        </div>
        <button
          onClick={handleSave}
          disabled={saving}
          className="px-6 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 disabled:opacity-50 flex items-center gap-2"
        >
          {saving ? (
            <>
              <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
              Saving...
            </>
          ) : (
            <>
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
              </svg>
              Save Changes
            </>
          )}
        </button>
      </div>

      {/* Success Message */}
      <AnimatePresence>
        {successMessage && (
          <motion.div
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0, y: -20 }}
            className="bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg flex items-center gap-2"
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {successMessage}
          </motion.div>
        )}
      </AnimatePresence>

      <div className="flex gap-6">
        {/* Sidebar Tabs */}
        <div className="w-56 flex-shrink-0">
          <nav className="space-y-1">
            {tabs.map((tab) => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${
                  activeTab === tab.id
                    ? 'bg-orange-50 text-orange-600 font-medium'
                    : 'text-gray-600 hover:bg-gray-50'
                }`}
              >
                {tab.icon}
                {tab.label}
              </button>
            ))}
          </nav>
        </div>

        {/* Content Area */}
        <div className="flex-1">
          <motion.div
            key={activeTab}
            initial={{ opacity: 0, x: 20 }}
            animate={{ opacity: 1, x: 0 }}
            className="bg-white rounded-xl border border-gray-200 p-6"
          >
            {/* Profile Tab */}
            {activeTab === 'profile' && (
              <div className="space-y-6">
                <h2 className="text-lg font-semibold text-gray-900">Profile Information</h2>
                
                {/* Avatar */}
                <div className="flex items-center gap-6">
                  <div className="relative">
                    <div className="w-24 h-24 rounded-full bg-gradient-to-br from-orange-400 to-amber-500 flex items-center justify-center text-white text-2xl font-bold">
                      {profile.firstName[0]}{profile.lastName[0]}
                    </div>
                    <button className="absolute bottom-0 right-0 p-2 bg-white rounded-full shadow-lg border border-gray-200 hover:bg-gray-50">
                      <svg className="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                      </svg>
                    </button>
                  </div>
                  <div>
                    <p className="font-medium text-gray-900">{profile.firstName} {profile.lastName}</p>
                    <p className="text-sm text-gray-500">Member since {new Date(profile.createdAt).toLocaleDateString()}</p>
                    <span className="inline-block mt-2 px-3 py-1 bg-orange-100 text-orange-600 text-sm rounded-full capitalize">
                      {profile.role.toLowerCase()}
                    </span>
                  </div>
                </div>

                {/* Form Fields */}
                <div className="grid grid-cols-2 gap-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                    <input
                      type="text"
                      value={profile.firstName}
                      onChange={(e) => setProfile({ ...profile, firstName: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                    <input
                      type="text"
                      value={profile.lastName}
                      onChange={(e) => setProfile({ ...profile, lastName: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <div className="relative">
                      <input
                        type="email"
                        value={profile.email}
                        onChange={(e) => setProfile({ ...profile, email: e.target.value })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                      />
                      {profile.emailVerified && (
                        <span className="absolute right-3 top-1/2 -translate-y-1/2 text-green-500">
                          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                        </span>
                      )}
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                    <div className="relative">
                      <input
                        type="tel"
                        value={profile.phone}
                        onChange={(e) => setProfile({ ...profile, phone: e.target.value })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                      />
                      {!profile.phoneVerified && (
                        <button className="absolute right-3 top-1/2 -translate-y-1/2 text-orange-500 text-sm font-medium hover:text-orange-600">
                          Verify
                        </button>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* Notifications Tab */}
            {activeTab === 'notifications' && (
              <div className="space-y-6">
                <h2 className="text-lg font-semibold text-gray-900">Notification Preferences</h2>
                
                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Notification Channels</h3>
                  <Toggle
                    enabled={notifications.emailNotifications}
                    onChange={(val) => setNotifications({ ...notifications, emailNotifications: val })}
                    label="Email Notifications"
                    description="Receive notifications via email"
                  />
                  <Toggle
                    enabled={notifications.smsNotifications}
                    onChange={(val) => setNotifications({ ...notifications, smsNotifications: val })}
                    label="SMS Notifications"
                    description="Receive notifications via text message"
                  />
                  <Toggle
                    enabled={notifications.pushNotifications}
                    onChange={(val) => setNotifications({ ...notifications, pushNotifications: val })}
                    label="Push Notifications"
                    description="Receive browser push notifications"
                  />
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Property Alerts</h3>
                  <Toggle
                    enabled={notifications.newListings}
                    onChange={(val) => setNotifications({ ...notifications, newListings: val })}
                    label="New Listings"
                    description="Get notified when new properties match your criteria"
                  />
                  <Toggle
                    enabled={notifications.priceChanges}
                    onChange={(val) => setNotifications({ ...notifications, priceChanges: val })}
                    label="Price Changes"
                    description="Get notified when saved property prices change"
                  />
                  <Toggle
                    enabled={notifications.openHouses}
                    onChange={(val) => setNotifications({ ...notifications, openHouses: val })}
                    label="Open Houses"
                    description="Get notified about upcoming open houses"
                  />
                  <Toggle
                    enabled={notifications.savedSearchAlerts}
                    onChange={(val) => setNotifications({ ...notifications, savedSearchAlerts: val })}
                    label="Saved Search Alerts"
                    description="Receive alerts for your saved searches"
                  />
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Transaction Updates</h3>
                  <Toggle
                    enabled={notifications.offerUpdates}
                    onChange={(val) => setNotifications({ ...notifications, offerUpdates: val })}
                    label="Offer Updates"
                    description="Get notified about offer status changes"
                  />
                  <Toggle
                    enabled={notifications.documentUpdates}
                    onChange={(val) => setNotifications({ ...notifications, documentUpdates: val })}
                    label="Document Updates"
                    description="Get notified when documents need attention"
                  />
                  <Toggle
                    enabled={notifications.showingReminders}
                    onChange={(val) => setNotifications({ ...notifications, showingReminders: val })}
                    label="Showing Reminders"
                    description="Receive reminders before scheduled showings"
                  />
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Marketing</h3>
                  <Toggle
                    enabled={notifications.marketReports}
                    onChange={(val) => setNotifications({ ...notifications, marketReports: val })}
                    label="Market Reports"
                    description="Weekly market insights and trends"
                  />
                  <Toggle
                    enabled={notifications.newsletter}
                    onChange={(val) => setNotifications({ ...notifications, newsletter: val })}
                    label="Newsletter"
                    description="Monthly newsletter with tips and updates"
                  />
                </div>
              </div>
            )}

            {/* Privacy Tab */}
            {activeTab === 'privacy' && (
              <div className="space-y-6">
                <h2 className="text-lg font-semibold text-gray-900">Privacy Settings</h2>
                
                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Profile Visibility</h3>
                  <div className="space-y-3">
                    {['PUBLIC', 'AGENTS_ONLY', 'PRIVATE'].map((option) => (
                      <label key={option} className="flex items-center gap-3 cursor-pointer">
                        <input
                          type="radio"
                          name="visibility"
                          checked={privacy.profileVisibility === option}
                          onChange={() => setPrivacy({ ...privacy, profileVisibility: option as any })}
                          className="w-4 h-4 text-orange-500 focus:ring-orange-500"
                        />
                        <div>
                          <p className="font-medium text-gray-900 capitalize">{option.toLowerCase().replace('_', ' ')}</p>
                          <p className="text-sm text-gray-500">
                            {option === 'PUBLIC' && 'Anyone can view your profile'}
                            {option === 'AGENTS_ONLY' && 'Only verified agents can view your profile'}
                            {option === 'PRIVATE' && 'Your profile is hidden from everyone'}
                          </p>
                        </div>
                      </label>
                    ))}
                  </div>
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Data Sharing</h3>
                  <Toggle
                    enabled={privacy.showContactInfo}
                    onChange={(val) => setPrivacy({ ...privacy, showContactInfo: val })}
                    label="Show Contact Information"
                    description="Allow others to see your phone and email"
                  />
                  <Toggle
                    enabled={privacy.showSearchHistory}
                    onChange={(val) => setPrivacy({ ...privacy, showSearchHistory: val })}
                    label="Search History"
                    description="Use search history for personalized recommendations"
                  />
                  <Toggle
                    enabled={privacy.allowDataAnalytics}
                    onChange={(val) => setPrivacy({ ...privacy, allowDataAnalytics: val })}
                    label="Analytics"
                    description="Help improve our service with anonymous usage data"
                  />
                  <Toggle
                    enabled={privacy.shareWithPartners}
                    onChange={(val) => setPrivacy({ ...privacy, shareWithPartners: val })}
                    label="Partner Sharing"
                    description="Share data with trusted partners for offers"
                  />
                </div>

                <div className="pt-4 border-t">
                  <h3 className="font-medium text-gray-700 mb-4">Data Management</h3>
                  <div className="flex gap-4">
                    <button className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center gap-2">
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                      </svg>
                      Download My Data
                    </button>
                    <button
                      onClick={() => setShowDeleteModal(true)}
                      className="px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 flex items-center gap-2"
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                      </svg>
                      Delete My Account
                    </button>
                  </div>
                </div>
              </div>
            )}

            {/* Preferences Tab */}
            {activeTab === 'preferences' && (
              <div className="space-y-6">
                <h2 className="text-lg font-semibold text-gray-900">App Preferences</h2>
                
                <div className="grid grid-cols-2 gap-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Language</label>
                    <select
                      value={preferences.language}
                      onChange={(e) => setPreferences({ ...preferences, language: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="en">English</option>
                      <option value="hi">हिंदी (Hindi)</option>
                      <option value="mr">मराठी (Marathi)</option>
                      <option value="gu">ગુજરાતી (Gujarati)</option>
                      <option value="ta">தமிழ் (Tamil)</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Currency</label>
                    <select
                      value={preferences.currency}
                      onChange={(e) => setPreferences({ ...preferences, currency: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="INR">₹ INR (Indian Rupee)</option>
                      <option value="USD">$ USD (US Dollar)</option>
                      <option value="GBP">£ GBP (British Pound)</option>
                      <option value="EUR">€ EUR (Euro)</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Timezone</label>
                    <select
                      value={preferences.timezone}
                      onChange={(e) => setPreferences({ ...preferences, timezone: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="Asia/Kolkata">India Standard Time (IST)</option>
                      <option value="America/New_York">Eastern Time (ET)</option>
                      <option value="America/Los_Angeles">Pacific Time (PT)</option>
                      <option value="Europe/London">Greenwich Mean Time (GMT)</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Measurement Unit</label>
                    <select
                      value={preferences.measurementUnit}
                      onChange={(e) => setPreferences({ ...preferences, measurementUnit: e.target.value as any })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="SQFT">Square Feet (sq ft)</option>
                      <option value="SQMT">Square Meters (sq m)</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Date Format</label>
                    <select
                      value={preferences.dateFormat}
                      onChange={(e) => setPreferences({ ...preferences, dateFormat: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                      <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                      <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Results Per Page</label>
                    <select
                      value={preferences.resultsPerPage}
                      onChange={(e) => setPreferences({ ...preferences, resultsPerPage: parseInt(e.target.value) })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value={10}>10</option>
                      <option value={20}>20</option>
                      <option value={50}>50</option>
                      <option value={100}>100</option>
                    </select>
                  </div>
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Display</h3>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-3">Theme</label>
                    <div className="flex gap-4">
                      {['LIGHT', 'DARK', 'SYSTEM'].map((theme) => (
                        <button
                          key={theme}
                          onClick={() => setPreferences({ ...preferences, theme: theme as any })}
                          className={`flex-1 p-4 border-2 rounded-lg text-center transition-colors ${
                            preferences.theme === theme
                              ? 'border-orange-500 bg-orange-50'
                              : 'border-gray-200 hover:border-gray-300'
                          }`}
                        >
                          <div className="mb-2">
                            {theme === 'LIGHT' && (
                              <svg className="w-8 h-8 mx-auto text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                              </svg>
                            )}
                            {theme === 'DARK' && (
                              <svg className="w-8 h-8 mx-auto text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                              </svg>
                            )}
                            {theme === 'SYSTEM' && (
                              <svg className="w-8 h-8 mx-auto text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                              </svg>
                            )}
                          </div>
                          <p className="font-medium text-gray-900 capitalize">{theme.toLowerCase()}</p>
                        </button>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-3">Default View</label>
                    <div className="flex gap-4">
                      {['LIST', 'GRID', 'MAP'].map((view) => (
                        <button
                          key={view}
                          onClick={() => setPreferences({ ...preferences, defaultView: view as any })}
                          className={`flex-1 p-3 border-2 rounded-lg text-center transition-colors ${
                            preferences.defaultView === view
                              ? 'border-orange-500 bg-orange-50'
                              : 'border-gray-200 hover:border-gray-300'
                          }`}
                        >
                          <p className="font-medium text-gray-900 capitalize">{view.toLowerCase()}</p>
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* Dharma Settings Tab */}
            {activeTab === 'dharma' && (
              <div className="space-y-6">
                <h2 className="text-lg font-semibold text-gray-900 flex items-center gap-2">
                  <span>🕉️</span> Dharma Settings
                </h2>
                <p className="text-gray-600">Configure Vastu Shastra and Jyotish preferences for property recommendations</p>
                
                {/* Vastu Settings */}
                <div className="space-y-4 p-4 bg-orange-50 rounded-lg">
                  <div className="flex items-center justify-between">
                    <h3 className="font-medium text-gray-900">Vastu Shastra Analysis</h3>
                    <Toggle
                      enabled={vastu.enabled}
                      onChange={(val) => setVastu({ ...vastu, enabled: val })}
                      label=""
                    />
                  </div>
                  
                  {vastu.enabled && (
                    <div className="space-y-4 pt-4 border-t border-orange-200">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Minimum Vastu Score: {vastu.minScore}%
                        </label>
                        <input
                          type="range"
                          min="0"
                          max="100"
                          value={vastu.minScore}
                          onChange={(e) => setVastu({ ...vastu, minScore: parseInt(e.target.value) })}
                          className="w-full h-2 bg-orange-200 rounded-lg appearance-none cursor-pointer"
                        />
                        <div className="flex justify-between text-xs text-gray-500 mt-1">
                          <span>0%</span>
                          <span>50%</span>
                          <span>100%</span>
                        </div>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">Priority Factors</label>
                        <div className="flex flex-wrap gap-2">
                          {vastu.priorityFactors.map((factor, index) => (
                            <span key={index} className="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm flex items-center gap-1">
                              {factor}
                              <button onClick={() => setVastu({ ...vastu, priorityFactors: vastu.priorityFactors.filter((_, i) => i !== index) })}>
                                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                </svg>
                              </button>
                            </span>
                          ))}
                        </div>
                      </div>
                      
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">Factors to Avoid</label>
                        <div className="flex flex-wrap gap-2">
                          {vastu.avoidFactors.map((factor, index) => (
                            <span key={index} className="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm flex items-center gap-1">
                              {factor}
                              <button onClick={() => setVastu({ ...vastu, avoidFactors: vastu.avoidFactors.filter((_, i) => i !== index) })}>
                                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                </svg>
                              </button>
                            </span>
                          ))}
                        </div>
                      </div>
                    </div>
                  )}
                </div>

                {/* Jyotish Settings */}
                <div className="space-y-4 p-4 bg-purple-50 rounded-lg">
                  <div className="flex items-center justify-between">
                    <h3 className="font-medium text-gray-900">Jyotish (Vedic Astrology)</h3>
                    <Toggle
                      enabled={astrology.enabled}
                      onChange={(val) => setAstrology({ ...astrology, enabled: val })}
                      label=""
                    />
                  </div>
                  
                  {astrology.enabled && (
                    <div className="space-y-4 pt-4 border-t border-purple-200">
                      <div className="grid grid-cols-3 gap-4">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">Birth Date</label>
                          <input
                            type="date"
                            value={astrology.birthDate}
                            onChange={(e) => setAstrology({ ...astrology, birthDate: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">Birth Time</label>
                          <input
                            type="time"
                            value={astrology.birthTime}
                            onChange={(e) => setAstrology({ ...astrology, birthTime: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">Birth Place</label>
                          <input
                            type="text"
                            value={astrology.birthPlace}
                            onChange={(e) => setAstrology({ ...astrology, birthPlace: e.target.value })}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                          />
                        </div>
                      </div>
                      
                      <Toggle
                        enabled={astrology.considerMuhurat}
                        onChange={(val) => setAstrology({ ...astrology, considerMuhurat: val })}
                        label="Consider Muhurat"
                        description="Show auspicious dates for property transactions"
                      />
                      <Toggle
                        enabled={astrology.considerDirections}
                        onChange={(val) => setAstrology({ ...astrology, considerDirections: val })}
                        label="Consider Favorable Directions"
                        description="Factor in astrologically favorable directions"
                      />
                    </div>
                  )}
                </div>
              </div>
            )}

            {/* Security Tab */}
            {activeTab === 'security' && (
              <div className="space-y-6">
                <h2 className="text-lg font-semibold text-gray-900">Security Settings</h2>
                
                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Password</h3>
                  <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div>
                      <p className="font-medium text-gray-900">Password</p>
                      <p className="text-sm text-gray-500">Last changed 30 days ago</p>
                    </div>
                    <button
                      onClick={() => setShowPasswordModal(true)}
                      className="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100"
                    >
                      Change Password
                    </button>
                  </div>
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Two-Factor Authentication</h3>
                  <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div>
                      <p className="font-medium text-gray-900">Two-Factor Authentication</p>
                      <p className="text-sm text-gray-500">
                        {profile.twoFactorEnabled
                          ? 'Enabled - Your account is protected with 2FA'
                          : 'Not enabled - Add an extra layer of security'}
                      </p>
                    </div>
                    <button className={`px-4 py-2 rounded-lg ${
                      profile.twoFactorEnabled
                        ? 'border border-red-300 text-red-600 hover:bg-red-50'
                        : 'bg-orange-500 text-white hover:bg-orange-600'
                    }`}>
                      {profile.twoFactorEnabled ? 'Disable' : 'Enable'}
                    </button>
                  </div>
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Connected Devices</h3>
                  <div className="space-y-3">
                    {[
                      { name: 'Chrome on Windows', location: 'Mumbai, India', lastActive: 'Active now', current: true },
                      { name: 'Safari on iPhone', location: 'Mumbai, India', lastActive: '2 hours ago', current: false },
                      { name: 'Chrome on MacBook', location: 'Pune, India', lastActive: '3 days ago', current: false },
                    ].map((device, index) => (
                      <div key={index} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div className="flex items-center gap-4">
                          <div className="p-2 bg-gray-200 rounded-lg">
                            <svg className="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                          </div>
                          <div>
                            <p className="font-medium text-gray-900 flex items-center gap-2">
                              {device.name}
                              {device.current && (
                                <span className="px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full">
                                  This device
                                </span>
                              )}
                            </p>
                            <p className="text-sm text-gray-500">{device.location} • {device.lastActive}</p>
                          </div>
                        </div>
                        {!device.current && (
                          <button className="text-red-600 hover:text-red-700 text-sm font-medium">
                            Sign out
                          </button>
                        )}
                      </div>
                    ))}
                  </div>
                </div>

                <div className="space-y-4">
                  <h3 className="font-medium text-gray-700 border-b pb-2">Login History</h3>
                  <div className="space-y-2">
                    {[
                      { time: 'Today, 10:30 AM', location: 'Mumbai, India', device: 'Chrome on Windows', success: true },
                      { time: 'Yesterday, 8:15 PM', location: 'Mumbai, India', device: 'Safari on iPhone', success: true },
                      { time: '2 days ago', location: 'Unknown Location', device: 'Unknown Device', success: false },
                    ].map((login, index) => (
                      <div key={index} className={`flex items-center justify-between p-3 rounded-lg ${
                        login.success ? 'bg-gray-50' : 'bg-red-50'
                      }`}>
                        <div className="flex items-center gap-3">
                          <div className={`w-2 h-2 rounded-full ${login.success ? 'bg-green-500' : 'bg-red-500'}`} />
                          <div>
                            <p className="text-sm font-medium text-gray-900">{login.time}</p>
                            <p className="text-xs text-gray-500">{login.device} • {login.location}</p>
                          </div>
                        </div>
                        <span className={`text-xs font-medium ${login.success ? 'text-green-600' : 'text-red-600'}`}>
                          {login.success ? 'Successful' : 'Failed'}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            )}
          </motion.div>
        </div>
      </div>

      {/* Password Change Modal */}
      <AnimatePresence>
        {showPasswordModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
            onClick={() => setShowPasswordModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl p-6 max-w-md w-full mx-4"
              onClick={(e) => e.stopPropagation()}
            >
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Change Password</h3>
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Current Password</label>
                  <input
                    type="password"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">New Password</label>
                  <input
                    type="password"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Confirm New Password</label>
                  <input
                    type="password"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
              </div>
              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowPasswordModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:from-orange-600 hover:to-amber-600">
                  Update Password
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Delete Account Modal */}
      <AnimatePresence>
        {showDeleteModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
            onClick={() => setShowDeleteModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl p-6 max-w-md w-full mx-4"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="text-center mb-4">
                <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <svg className="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                  </svg>
                </div>
                <h3 className="text-lg font-semibold text-gray-900">Delete Account</h3>
                <p className="text-gray-600 mt-2">
                  This action cannot be undone. All your data, saved properties, and history will be permanently deleted.
                </p>
              </div>
              <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Type "DELETE" to confirm
                </label>
                <input
                  type="text"
                  placeholder="DELETE"
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
                />
              </div>
              <div className="flex gap-3">
                <button
                  onClick={() => setShowDeleteModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button className="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
                  Delete Account
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface Plan {
  id: string;
  name: string;
  description: string;
  price: number;
  billingCycle: 'MONTHLY' | 'YEARLY';
  features: string[];
  limits: {
    savedSearches: number;
    favoriteProperties: number;
    agentMessages: number;
    vastuAnalysis: number;
    astrologyReports: number;
  };
  popular?: boolean;
}

interface Subscription {
  id: string;
  planId: string;
  planName: string;
  status: 'ACTIVE' | 'CANCELLED' | 'PAST_DUE' | 'TRIAL';
  currentPeriodStart: string;
  currentPeriodEnd: string;
  cancelAtPeriodEnd: boolean;
  trialEndsAt?: string;
}

interface Usage {
  savedSearches: { used: number; limit: number };
  favoriteProperties: { used: number; limit: number };
  agentMessages: { used: number; limit: number };
  vastuAnalysis: { used: number; limit: number };
  astrologyReports: { used: number; limit: number };
}

interface PaymentMethod {
  id: string;
  type: 'CARD' | 'UPI' | 'NETBANKING';
  last4?: string;
  brand?: string;
  expiryMonth?: number;
  expiryYear?: number;
  upiId?: string;
  bankName?: string;
  isDefault: boolean;
}

interface Invoice {
  id: string;
  date: string;
  amount: number;
  status: 'PAID' | 'PENDING' | 'FAILED';
  description: string;
  pdfUrl: string;
}

const plans: Plan[] = [
  {
    id: 'free',
    name: 'Free',
    description: 'Perfect for getting started',
    price: 0,
    billingCycle: 'MONTHLY',
    features: [
      'Browse unlimited properties',
      'Basic property search',
      'Save up to 5 properties',
      '2 saved searches',
      'Email support',
    ],
    limits: {
      savedSearches: 2,
      favoriteProperties: 5,
      agentMessages: 10,
      vastuAnalysis: 1,
      astrologyReports: 0,
    },
  },
  {
    id: 'basic',
    name: 'Basic',
    description: 'For active home seekers',
    price: 499,
    billingCycle: 'MONTHLY',
    features: [
      'Everything in Free',
      'Save up to 25 properties',
      '10 saved searches with alerts',
      'Unlimited agent messaging',
      'Basic Vastu analysis',
      'Priority support',
    ],
    limits: {
      savedSearches: 10,
      favoriteProperties: 25,
      agentMessages: -1,
      vastuAnalysis: 10,
      astrologyReports: 2,
    },
  },
  {
    id: 'premium',
    name: 'Premium',
    description: 'Complete dharmic property search',
    price: 999,
    billingCycle: 'MONTHLY',
    popular: true,
    features: [
      'Everything in Basic',
      'Unlimited saved properties',
      'Unlimited saved searches',
      'Advanced Vastu analysis',
      'Jyotish compatibility reports',
      'Muhurat recommendations',
      'Dedicated support',
      'Early access to new features',
    ],
    limits: {
      savedSearches: -1,
      favoriteProperties: -1,
      agentMessages: -1,
      vastuAnalysis: -1,
      astrologyReports: -1,
    },
  },
  {
    id: 'agent',
    name: 'Agent Pro',
    description: 'For real estate professionals',
    price: 2999,
    billingCycle: 'MONTHLY',
    features: [
      'Everything in Premium',
      'List unlimited properties',
      'Lead management tools',
      'Client CRM',
      'Analytics dashboard',
      'Blockchain verification',
      'White-label reports',
      'API access',
    ],
    limits: {
      savedSearches: -1,
      favoriteProperties: -1,
      agentMessages: -1,
      vastuAnalysis: -1,
      astrologyReports: -1,
    },
  },
];

const mockSubscription: Subscription = {
  id: 'sub-1',
  planId: 'basic',
  planName: 'Basic',
  status: 'ACTIVE',
  currentPeriodStart: '2024-11-15',
  currentPeriodEnd: '2024-12-15',
  cancelAtPeriodEnd: false,
};

const mockUsage: Usage = {
  savedSearches: { used: 6, limit: 10 },
  favoriteProperties: { used: 18, limit: 25 },
  agentMessages: { used: 45, limit: -1 },
  vastuAnalysis: { used: 3, limit: 10 },
  astrologyReports: { used: 1, limit: 2 },
};

const mockPaymentMethods: PaymentMethod[] = [
  {
    id: 'pm-1',
    type: 'CARD',
    last4: '4242',
    brand: 'Visa',
    expiryMonth: 12,
    expiryYear: 2025,
    isDefault: true,
  },
  {
    id: 'pm-2',
    type: 'UPI',
    upiId: 'rajesh@upi',
    isDefault: false,
  },
];

const mockInvoices: Invoice[] = [
  { id: 'inv-1', date: '2024-11-15', amount: 499, status: 'PAID', description: 'Basic Plan - November 2024', pdfUrl: '#' },
  { id: 'inv-2', date: '2024-10-15', amount: 499, status: 'PAID', description: 'Basic Plan - October 2024', pdfUrl: '#' },
  { id: 'inv-3', date: '2024-09-15', amount: 499, status: 'PAID', description: 'Basic Plan - September 2024', pdfUrl: '#' },
];

export default function SubscriptionPage() {
  const [loading, setLoading] = useState(true);
  const [subscription, setSubscription] = useState<Subscription>(mockSubscription);
  const [usage, setUsage] = useState<Usage>(mockUsage);
  const [paymentMethods, setPaymentMethods] = useState<PaymentMethod[]>(mockPaymentMethods);
  const [invoices, setInvoices] = useState<Invoice[]>(mockInvoices);
  const [billingCycle, setBillingCycle] = useState<'MONTHLY' | 'YEARLY'>('MONTHLY');
  const [showUpgradeModal, setShowUpgradeModal] = useState(false);
  const [showCancelModal, setShowCancelModal] = useState(false);
  const [showPaymentModal, setShowPaymentModal] = useState(false);
  const [selectedPlan, setSelectedPlan] = useState<Plan | null>(null);

  useEffect(() => {
    setTimeout(() => setLoading(false), 500);
  }, []);

  const formatPrice = (price: number) => {
    return new Intl.NumberFormat('en-IN', {
      style: 'currency',
      currency: 'INR',
      maximumFractionDigits: 0,
    }).format(price);
  };

  const getUsagePercentage = (used: number, limit: number) => {
    if (limit === -1) return 0; // Unlimited
    return Math.min((used / limit) * 100, 100);
  };

  const getUsageColor = (percentage: number) => {
    if (percentage >= 90) return 'bg-red-500';
    if (percentage >= 70) return 'bg-yellow-500';
    return 'bg-green-500';
  };

  const handleUpgrade = (plan: Plan) => {
    setSelectedPlan(plan);
    setShowUpgradeModal(true);
  };

  const confirmUpgrade = () => {
    if (selectedPlan) {
      setSubscription({
        ...subscription,
        planId: selectedPlan.id,
        planName: selectedPlan.name,
      });
      setShowUpgradeModal(false);
      setSelectedPlan(null);
    }
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-96">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  const currentPlan = plans.find(p => p.id === subscription.planId);

  return (
    <div className="space-y-6">
      {/* Header */}
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Subscription</h1>
        <p className="text-gray-600">Manage your plan, billing, and usage</p>
      </div>

      {/* Current Plan Card */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="bg-gradient-to-r from-orange-500 to-amber-500 rounded-xl p-6 text-white"
      >
        <div className="flex items-start justify-between">
          <div>
            <p className="text-orange-100 text-sm">Current Plan</p>
            <h2 className="text-3xl font-bold mt-1">{subscription.planName}</h2>
            <p className="text-orange-100 mt-2">
              {subscription.status === 'ACTIVE' && !subscription.cancelAtPeriodEnd && (
                <>Renews on {new Date(subscription.currentPeriodEnd).toLocaleDateString()}</>
              )}
              {subscription.cancelAtPeriodEnd && (
                <>Expires on {new Date(subscription.currentPeriodEnd).toLocaleDateString()}</>
              )}
              {subscription.status === 'TRIAL' && subscription.trialEndsAt && (
                <>Trial ends on {new Date(subscription.trialEndsAt).toLocaleDateString()}</>
              )}
            </p>
          </div>
          <div className="text-right">
            <p className="text-4xl font-bold">{formatPrice(currentPlan?.price || 0)}</p>
            <p className="text-orange-100">per month</p>
          </div>
        </div>
        <div className="flex gap-3 mt-6">
          <button
            onClick={() => setShowCancelModal(true)}
            className="px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white transition-colors"
          >
            {subscription.cancelAtPeriodEnd ? 'Reactivate' : 'Cancel Plan'}
          </button>
          {currentPlan?.id !== 'agent' && (
            <button
              onClick={() => handleUpgrade(plans.find(p => p.id === 'premium') || plans[2])}
              className="px-4 py-2 bg-white text-orange-600 rounded-lg font-medium hover:bg-orange-50 transition-colors"
            >
              Upgrade Plan
            </button>
          )}
        </div>
      </motion.div>

      {/* Usage Overview */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.1 }}
        className="bg-white rounded-xl border border-gray-200 p-6"
      >
        <h3 className="text-lg font-semibold text-gray-900 mb-4">Usage This Period</h3>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {[
            { label: 'Saved Searches', ...usage.savedSearches, icon: '🔍' },
            { label: 'Favorite Properties', ...usage.favoriteProperties, icon: '❤️' },
            { label: 'Agent Messages', ...usage.agentMessages, icon: '💬' },
            { label: 'Vastu Analysis', ...usage.vastuAnalysis, icon: '🕉️' },
            { label: 'Astrology Reports', ...usage.astrologyReports, icon: '⭐' },
          ].map((item, index) => (
            <div key={index} className="space-y-2">
              <div className="flex items-center justify-between">
                <span className="text-gray-700 flex items-center gap-2">
                  <span>{item.icon}</span>
                  {item.label}
                </span>
                <span className="text-sm text-gray-500">
                  {item.used} / {item.limit === -1 ? '∞' : item.limit}
                </span>
              </div>
              <div className="h-2 bg-gray-100 rounded-full overflow-hidden">
                <div
                  className={`h-full rounded-full transition-all ${
                    item.limit === -1 ? 'bg-green-500' : getUsageColor(getUsagePercentage(item.used, item.limit))
                  }`}
                  style={{ width: item.limit === -1 ? '100%' : `${getUsagePercentage(item.used, item.limit)}%` }}
                />
              </div>
              {item.limit !== -1 && getUsagePercentage(item.used, item.limit) >= 80 && (
                <p className="text-xs text-yellow-600">
                  {item.limit - item.used} remaining
                </p>
              )}
            </div>
          ))}
        </div>
      </motion.div>

      {/* Available Plans */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.2 }}
      >
        <div className="flex items-center justify-between mb-4">
          <h3 className="text-lg font-semibold text-gray-900">Available Plans</h3>
          <div className="flex items-center gap-2 bg-gray-100 p-1 rounded-lg">
            <button
              onClick={() => setBillingCycle('MONTHLY')}
              className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                billingCycle === 'MONTHLY' ? 'bg-white shadow text-gray-900' : 'text-gray-600'
              }`}
            >
              Monthly
            </button>
            <button
              onClick={() => setBillingCycle('YEARLY')}
              className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                billingCycle === 'YEARLY' ? 'bg-white shadow text-gray-900' : 'text-gray-600'
              }`}
            >
              Yearly
              <span className="ml-1 text-green-600 text-xs">Save 20%</span>
            </button>
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          {plans.map((plan) => (
            <div
              key={plan.id}
              className={`relative bg-white rounded-xl border-2 p-6 transition-all ${
                plan.popular ? 'border-orange-500 shadow-lg' : 'border-gray-200'
              } ${subscription.planId === plan.id ? 'ring-2 ring-orange-500' : ''}`}
            >
              {plan.popular && (
                <div className="absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 bg-orange-500 text-white text-xs font-medium rounded-full">
                  Most Popular
                </div>
              )}
              {subscription.planId === plan.id && (
                <div className="absolute top-4 right-4">
                  <svg className="w-6 h-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
              )}
              <h4 className="text-lg font-semibold text-gray-900">{plan.name}</h4>
              <p className="text-sm text-gray-500 mt-1">{plan.description}</p>
              <div className="mt-4">
                <span className="text-3xl font-bold text-gray-900">
                  {formatPrice(billingCycle === 'YEARLY' ? plan.price * 10 : plan.price)}
                </span>
                <span className="text-gray-500">/{billingCycle === 'YEARLY' ? 'year' : 'month'}</span>
              </div>
              <ul className="mt-4 space-y-2">
                {plan.features.slice(0, 5).map((feature, index) => (
                  <li key={index} className="flex items-start gap-2 text-sm text-gray-600">
                    <svg className="w-5 h-5 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                    </svg>
                    {feature}
                  </li>
                ))}
                {plan.features.length > 5 && (
                  <li className="text-sm text-orange-500 font-medium">
                    +{plan.features.length - 5} more features
                  </li>
                )}
              </ul>
              <button
                onClick={() => handleUpgrade(plan)}
                disabled={subscription.planId === plan.id}
                className={`w-full mt-6 py-2 rounded-lg font-medium transition-colors ${
                  subscription.planId === plan.id
                    ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                    : plan.popular
                    ? 'bg-gradient-to-r from-orange-500 to-amber-500 text-white hover:from-orange-600 hover:to-amber-600'
                    : 'border border-gray-300 text-gray-700 hover:bg-gray-50'
                }`}
              >
                {subscription.planId === plan.id ? 'Current Plan' : 'Select Plan'}
              </button>
            </div>
          ))}
        </div>
      </motion.div>

      {/* Payment Methods */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.3 }}
        className="bg-white rounded-xl border border-gray-200 p-6"
      >
        <div className="flex items-center justify-between mb-4">
          <h3 className="text-lg font-semibold text-gray-900">Payment Methods</h3>
          <button
            onClick={() => setShowPaymentModal(true)}
            className="px-4 py-2 text-orange-500 hover:text-orange-600 font-medium flex items-center gap-2"
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
            </svg>
            Add New
          </button>
        </div>
        <div className="space-y-3">
          {paymentMethods.map((method) => (
            <div
              key={method.id}
              className={`flex items-center justify-between p-4 rounded-lg border ${
                method.isDefault ? 'border-orange-200 bg-orange-50' : 'border-gray-200'
              }`}
            >
              <div className="flex items-center gap-4">
                <div className="w-12 h-8 bg-gray-100 rounded flex items-center justify-center">
                  {method.type === 'CARD' && (
                    <span className="text-sm font-bold text-gray-600">{method.brand}</span>
                  )}
                  {method.type === 'UPI' && <span className="text-lg">📱</span>}
                  {method.type === 'NETBANKING' && <span className="text-lg">🏦</span>}
                </div>
                <div>
                  {method.type === 'CARD' && (
                    <>
                      <p className="font-medium text-gray-900">•••• •••• •••• {method.last4}</p>
                      <p className="text-sm text-gray-500">
                        Expires {method.expiryMonth}/{method.expiryYear}
                      </p>
                    </>
                  )}
                  {method.type === 'UPI' && (
                    <p className="font-medium text-gray-900">{method.upiId}</p>
                  )}
                  {method.type === 'NETBANKING' && (
                    <p className="font-medium text-gray-900">{method.bankName}</p>
                  )}
                </div>
                {method.isDefault && (
                  <span className="px-2 py-1 bg-orange-100 text-orange-600 text-xs font-medium rounded">
                    Default
                  </span>
                )}
              </div>
              <div className="flex items-center gap-2">
                {!method.isDefault && (
                  <button className="text-sm text-gray-500 hover:text-gray-700">Set as default</button>
                )}
                <button className="text-sm text-red-500 hover:text-red-600">Remove</button>
              </div>
            </div>
          ))}
        </div>
      </motion.div>

      {/* Billing History */}
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.4 }}
        className="bg-white rounded-xl border border-gray-200 p-6"
      >
        <h3 className="text-lg font-semibold text-gray-900 mb-4">Billing History</h3>
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead>
              <tr className="text-left text-sm text-gray-500 border-b">
                <th className="pb-3 font-medium">Date</th>
                <th className="pb-3 font-medium">Description</th>
                <th className="pb-3 font-medium">Amount</th>
                <th className="pb-3 font-medium">Status</th>
                <th className="pb-3 font-medium">Invoice</th>
              </tr>
            </thead>
            <tbody>
              {invoices.map((invoice) => (
                <tr key={invoice.id} className="border-b last:border-0">
                  <td className="py-4 text-gray-900">
                    {new Date(invoice.date).toLocaleDateString()}
                  </td>
                  <td className="py-4 text-gray-600">{invoice.description}</td>
                  <td className="py-4 font-medium text-gray-900">{formatPrice(invoice.amount)}</td>
                  <td className="py-4">
                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                      invoice.status === 'PAID' ? 'bg-green-100 text-green-700' :
                      invoice.status === 'PENDING' ? 'bg-yellow-100 text-yellow-700' :
                      'bg-red-100 text-red-700'
                    }`}>
                      {invoice.status}
                    </span>
                  </td>
                  <td className="py-4">
                    <a
                      href={invoice.pdfUrl}
                      className="text-orange-500 hover:text-orange-600 flex items-center gap-1"
                    >
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                      </svg>
                      PDF
                    </a>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </motion.div>

      {/* Upgrade Modal */}
      <AnimatePresence>
        {showUpgradeModal && selectedPlan && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
            onClick={() => setShowUpgradeModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl p-6 max-w-md w-full mx-4"
              onClick={(e) => e.stopPropagation()}
            >
              <h3 className="text-lg font-semibold text-gray-900">
                {selectedPlan.price > (currentPlan?.price || 0) ? 'Upgrade' : 'Change'} to {selectedPlan.name}
              </h3>
              <p className="text-gray-600 mt-2">
                {selectedPlan.price > (currentPlan?.price || 0) ? (
                  <>You&apos;ll be charged the prorated difference immediately.</>
                ) : (
                  <>Your plan will change at the end of your current billing period.</>
                )}
              </p>
              <div className="bg-gray-50 rounded-lg p-4 mt-4">
                <div className="flex justify-between mb-2">
                  <span className="text-gray-600">New plan</span>
                  <span className="font-medium">{selectedPlan.name}</span>
                </div>
                <div className="flex justify-between mb-2">
                  <span className="text-gray-600">Price</span>
                  <span className="font-medium">{formatPrice(selectedPlan.price)}/month</span>
                </div>
                {selectedPlan.price > (currentPlan?.price || 0) && (
                  <div className="flex justify-between border-t pt-2 mt-2">
                    <span className="text-gray-600">Due today (prorated)</span>
                    <span className="font-bold text-orange-600">
                      {formatPrice(Math.round((selectedPlan.price - (currentPlan?.price || 0)) / 2))}
                    </span>
                  </div>
                )}
              </div>
              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowUpgradeModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button
                  onClick={confirmUpgrade}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:from-orange-600 hover:to-amber-600"
                >
                  Confirm
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Cancel Modal */}
      <AnimatePresence>
        {showCancelModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
            onClick={() => setShowCancelModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl p-6 max-w-md w-full mx-4"
              onClick={(e) => e.stopPropagation()}
            >
              {subscription.cancelAtPeriodEnd ? (
                <>
                  <h3 className="text-lg font-semibold text-gray-900">Reactivate Subscription</h3>
                  <p className="text-gray-600 mt-2">
                    Your subscription will continue and you won&apos;t lose access to any features.
                  </p>
                  <div className="flex gap-3 mt-6">
                    <button
                      onClick={() => setShowCancelModal(false)}
                      className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                    >
                      Cancel
                    </button>
                    <button
                      onClick={() => {
                        setSubscription({ ...subscription, cancelAtPeriodEnd: false });
                        setShowCancelModal(false);
                      }}
                      className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:from-orange-600 hover:to-amber-600"
                    >
                      Reactivate
                    </button>
                  </div>
                </>
              ) : (
                <>
                  <h3 className="text-lg font-semibold text-gray-900">Cancel Subscription</h3>
                  <p className="text-gray-600 mt-2">
                    Your subscription will remain active until {new Date(subscription.currentPeriodEnd).toLocaleDateString()}.
                    After that, you&apos;ll lose access to premium features.
                  </p>
                  <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4">
                    <p className="text-sm text-yellow-800">
                      <strong>What you&apos;ll lose:</strong>
                    </p>
                    <ul className="mt-2 space-y-1 text-sm text-yellow-700">
                      <li>• Unlimited saved searches</li>
                      <li>• Advanced Vastu analysis</li>
                      <li>• Jyotish compatibility reports</li>
                      <li>• Priority support</li>
                    </ul>
                  </div>
                  <div className="flex gap-3 mt-6">
                    <button
                      onClick={() => setShowCancelModal(false)}
                      className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:from-orange-600 hover:to-amber-600"
                    >
                      Keep Subscription
                    </button>
                    <button
                      onClick={() => {
                        setSubscription({ ...subscription, cancelAtPeriodEnd: true });
                        setShowCancelModal(false);
                      }}
                      className="flex-1 px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50"
                    >
                      Cancel Anyway
                    </button>
                  </div>
                </>
              )}
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Add Payment Method Modal */}
      <AnimatePresence>
        {showPaymentModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
            onClick={() => setShowPaymentModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl p-6 max-w-md w-full mx-4"
              onClick={(e) => e.stopPropagation()}
            >
              <h3 className="text-lg font-semibold text-gray-900 mb-4">Add Payment Method</h3>
              <div className="space-y-4">
                <div className="grid grid-cols-3 gap-3">
                  {['Card', 'UPI', 'Netbanking'].map((type) => (
                    <button
                      key={type}
                      className="p-4 border-2 border-gray-200 rounded-lg text-center hover:border-orange-500 focus:border-orange-500 focus:ring-2 focus:ring-orange-500"
                    >
                      <span className="text-2xl">
                        {type === 'Card' ? '💳' : type === 'UPI' ? '📱' : '🏦'}
                      </span>
                      <p className="text-sm font-medium mt-1">{type}</p>
                    </button>
                  ))}
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Card Number</label>
                  <input
                    type="text"
                    placeholder="1234 5678 9012 3456"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Expiry Date</label>
                    <input
                      type="text"
                      placeholder="MM/YY"
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">CVV</label>
                    <input
                      type="text"
                      placeholder="123"
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                </div>
                <label className="flex items-center gap-2">
                  <input type="checkbox" className="w-4 h-4 text-orange-500 rounded focus:ring-orange-500" />
                  <span className="text-sm text-gray-600">Set as default payment method</span>
                </label>
              </div>
              <div className="flex gap-3 mt-6">
                <button
                  onClick={() => setShowPaymentModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button
                  onClick={() => setShowPaymentModal(false)}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:from-orange-600 hover:to-amber-600"
                >
                  Add Card
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface Client {
  id: string;
  firstName: string;
  lastName: string;
  email: string;
  phone: string;
  avatar?: string;
  type: 'BUYER' | 'SELLER' | 'BOTH';
  status: 'ACTIVE' | 'INACTIVE' | 'LEAD' | 'CLOSED';
  source: 'REFERRAL' | 'WEBSITE' | 'SOCIAL_MEDIA' | 'COLD_CALL' | 'OPEN_HOUSE' | 'OTHER';
  budget?: { min: number; max: number };
  preferredLocations?: string[];
  propertyType?: string[];
  notes?: string;
  assignedAt: string;
  lastContact: string;
  nextFollowUp?: string;
  tags: string[];
  properties: {
    interested: number;
    viewed: number;
    offers: number;
    closed: number;
  };
  transactions: {
    id: string;
    propertyTitle: string;
    status: 'PENDING' | 'ACTIVE' | 'CLOSED' | 'CANCELLED';
    amount: number;
    role: 'BUYER' | 'SELLER';
  }[];
}

interface ClientFormData {
  firstName: string;
  lastName: string;
  email: string;
  phone: string;
  type: 'BUYER' | 'SELLER' | 'BOTH';
  source: string;
  budgetMin: string;
  budgetMax: string;
  preferredLocations: string;
  notes: string;
}

const mockClients: Client[] = [
  {
    id: 'client-1',
    firstName: 'Priya',
    lastName: 'Sharma',
    email: 'priya.sharma@example.com',
    phone: '+91 98765 11111',
    type: 'BUYER',
    status: 'ACTIVE',
    source: 'REFERRAL',
    budget: { min: 8000000, max: 12000000 },
    preferredLocations: ['Bandra', 'Juhu', 'Andheri West'],
    propertyType: ['Apartment', 'Penthouse'],
    notes: 'Looking for 3BHK with sea view. Prefers Vastu-compliant properties.',
    assignedAt: '2024-09-15',
    lastContact: '2024-11-28',
    nextFollowUp: '2024-12-05',
    tags: ['Premium', 'Vastu Required', 'Quick Decision'],
    properties: { interested: 8, viewed: 5, offers: 2, closed: 0 },
    transactions: [],
  },
  {
    id: 'client-2',
    firstName: 'Amit',
    lastName: 'Patel',
    email: 'amit.patel@example.com',
    phone: '+91 98765 22222',
    type: 'SELLER',
    status: 'ACTIVE',
    source: 'WEBSITE',
    notes: 'Selling 2 properties in Worli. Wants quick sale.',
    assignedAt: '2024-10-01',
    lastContact: '2024-11-30',
    nextFollowUp: '2024-12-02',
    tags: ['Motivated Seller', 'Multiple Properties'],
    properties: { interested: 0, viewed: 0, offers: 3, closed: 1 },
    transactions: [
      { id: 'txn-1', propertyTitle: 'Worli Sea Face Apartment', status: 'ACTIVE', amount: 45000000, role: 'SELLER' },
    ],
  },
  {
    id: 'client-3',
    firstName: 'Neha',
    lastName: 'Gupta',
    email: 'neha.gupta@example.com',
    phone: '+91 98765 33333',
    type: 'BOTH',
    status: 'ACTIVE',
    source: 'SOCIAL_MEDIA',
    budget: { min: 15000000, max: 25000000 },
    preferredLocations: ['Powai', 'Ghatkopar'],
    notes: 'Selling current home and upgrading. Interested in Jyotish-compatible properties.',
    assignedAt: '2024-08-20',
    lastContact: '2024-11-25',
    tags: ['Upgrade', 'Jyotish', 'Flexible Timeline'],
    properties: { interested: 12, viewed: 8, offers: 1, closed: 0 },
    transactions: [],
  },
  {
    id: 'client-4',
    firstName: 'Rajesh',
    lastName: 'Mehta',
    email: 'rajesh.mehta@example.com',
    phone: '+91 98765 44444',
    type: 'BUYER',
    status: 'LEAD',
    source: 'OPEN_HOUSE',
    budget: { min: 5000000, max: 8000000 },
    preferredLocations: ['Thane', 'Navi Mumbai'],
    assignedAt: '2024-11-20',
    lastContact: '2024-11-20',
    nextFollowUp: '2024-12-01',
    tags: ['First-Time Buyer', 'Loan Required'],
    properties: { interested: 3, viewed: 1, offers: 0, closed: 0 },
    transactions: [],
  },
  {
    id: 'client-5',
    firstName: 'Sunita',
    lastName: 'Rao',
    email: 'sunita.rao@example.com',
    phone: '+91 98765 55555',
    type: 'SELLER',
    status: 'CLOSED',
    source: 'REFERRAL',
    assignedAt: '2024-06-01',
    lastContact: '2024-10-15',
    tags: ['Completed', 'Referral Source'],
    properties: { interested: 0, viewed: 0, offers: 5, closed: 1 },
    transactions: [
      { id: 'txn-2', propertyTitle: 'Colaba Heritage Flat', status: 'CLOSED', amount: 85000000, role: 'SELLER' },
    ],
  },
];

export default function ClientsPage() {
  const [loading, setLoading] = useState(true);
  const [clients, setClients] = useState<Client[]>(mockClients);
  const [filteredClients, setFilteredClients] = useState<Client[]>(mockClients);
  const [searchQuery, setSearchQuery] = useState('');
  const [statusFilter, setStatusFilter] = useState<string>('all');
  const [typeFilter, setTypeFilter] = useState<string>('all');
  const [selectedClient, setSelectedClient] = useState<Client | null>(null);
  const [showClientModal, setShowClientModal] = useState(false);
  const [showAddModal, setShowAddModal] = useState(false);
  const [newClient, setNewClient] = useState<ClientFormData>({
    firstName: '',
    lastName: '',
    email: '',
    phone: '',
    type: 'BUYER',
    source: 'WEBSITE',
    budgetMin: '',
    budgetMax: '',
    preferredLocations: '',
    notes: '',
  });

  useEffect(() => {
    setTimeout(() => setLoading(false), 500);
  }, []);

  useEffect(() => {
    let filtered = clients;

    if (searchQuery) {
      const query = searchQuery.toLowerCase();
      filtered = filtered.filter(
        (client) =>
          client.firstName.toLowerCase().includes(query) ||
          client.lastName.toLowerCase().includes(query) ||
          client.email.toLowerCase().includes(query) ||
          client.phone.includes(query)
      );
    }

    if (statusFilter !== 'all') {
      filtered = filtered.filter((client) => client.status === statusFilter);
    }

    if (typeFilter !== 'all') {
      filtered = filtered.filter((client) => client.type === typeFilter || client.type === 'BOTH');
    }

    setFilteredClients(filtered);
  }, [clients, searchQuery, statusFilter, typeFilter]);

  const formatPrice = (price: number) => {
    if (price >= 10000000) {
      return `₹${(price / 10000000).toFixed(1)}Cr`;
    } else if (price >= 100000) {
      return `₹${(price / 100000).toFixed(1)}L`;
    }
    return `₹${price.toLocaleString()}`;
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'ACTIVE': return 'bg-green-100 text-green-700';
      case 'LEAD': return 'bg-blue-100 text-blue-700';
      case 'INACTIVE': return 'bg-gray-100 text-gray-700';
      case 'CLOSED': return 'bg-purple-100 text-purple-700';
      default: return 'bg-gray-100 text-gray-700';
    }
  };

  const getTypeColor = (type: string) => {
    switch (type) {
      case 'BUYER': return 'bg-teal-100 text-teal-700';
      case 'SELLER': return 'bg-orange-100 text-orange-700';
      case 'BOTH': return 'bg-purple-100 text-purple-700';
      default: return 'bg-gray-100 text-gray-700';
    }
  };

  const stats = {
    total: clients.length,
    active: clients.filter((c) => c.status === 'ACTIVE').length,
    leads: clients.filter((c) => c.status === 'LEAD').length,
    closed: clients.filter((c) => c.status === 'CLOSED').length,
  };

  const handleAddClient = () => {
    const client: Client = {
      id: `client-${Date.now()}`,
      firstName: newClient.firstName,
      lastName: newClient.lastName,
      email: newClient.email,
      phone: newClient.phone,
      type: newClient.type,
      status: 'LEAD',
      source: newClient.source as any,
      budget: newClient.budgetMin && newClient.budgetMax ? {
        min: parseInt(newClient.budgetMin),
        max: parseInt(newClient.budgetMax),
      } : undefined,
      preferredLocations: newClient.preferredLocations ? newClient.preferredLocations.split(',').map(s => s.trim()) : [],
      notes: newClient.notes,
      assignedAt: new Date().toISOString().split('T')[0],
      lastContact: new Date().toISOString().split('T')[0],
      tags: [],
      properties: { interested: 0, viewed: 0, offers: 0, closed: 0 },
      transactions: [],
    };
    setClients([client, ...clients]);
    setShowAddModal(false);
    setNewClient({
      firstName: '',
      lastName: '',
      email: '',
      phone: '',
      type: 'BUYER',
      source: 'WEBSITE',
      budgetMin: '',
      budgetMax: '',
      preferredLocations: '',
      notes: '',
    });
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-96">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Clients</h1>
          <p className="text-gray-600">Manage your client relationships</p>
        </div>
        <button
          onClick={() => setShowAddModal(true)}
          className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 flex items-center gap-2"
        >
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
          </svg>
          Add Client
        </button>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-4 gap-4">
        {[
          { label: 'Total Clients', value: stats.total, icon: '👥', color: 'bg-blue-50 text-blue-600' },
          { label: 'Active', value: stats.active, icon: '✅', color: 'bg-green-50 text-green-600' },
          { label: 'Leads', value: stats.leads, icon: '🎯', color: 'bg-yellow-50 text-yellow-600' },
          { label: 'Closed Deals', value: stats.closed, icon: '🎉', color: 'bg-purple-50 text-purple-600' },
        ].map((stat, index) => (
          <motion.div
            key={stat.label}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: index * 0.05 }}
            className={`p-4 rounded-xl ${stat.color}`}
          >
            <div className="flex items-center justify-between">
              <span className="text-2xl">{stat.icon}</span>
              <span className="text-2xl font-bold">{stat.value}</span>
            </div>
            <p className="text-sm mt-2 opacity-80">{stat.label}</p>
          </motion.div>
        ))}
      </div>

      {/* Filters */}
      <div className="flex items-center gap-4">
        <div className="flex-1 relative">
          <svg className="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
          <input
            type="text"
            placeholder="Search clients..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
          />
        </div>
        <select
          value={statusFilter}
          onChange={(e) => setStatusFilter(e.target.value)}
          className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
        >
          <option value="all">All Status</option>
          <option value="ACTIVE">Active</option>
          <option value="LEAD">Lead</option>
          <option value="INACTIVE">Inactive</option>
          <option value="CLOSED">Closed</option>
        </select>
        <select
          value={typeFilter}
          onChange={(e) => setTypeFilter(e.target.value)}
          className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
        >
          <option value="all">All Types</option>
          <option value="BUYER">Buyers</option>
          <option value="SELLER">Sellers</option>
        </select>
      </div>

      {/* Clients List */}
      <div className="grid gap-4">
        {filteredClients.length === 0 ? (
          <div className="text-center py-12 bg-white rounded-xl border border-gray-200">
            <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
            <p className="text-gray-500">No clients found</p>
          </div>
        ) : (
          filteredClients.map((client, index) => (
            <motion.div
              key={client.id}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: index * 0.05 }}
              className="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow cursor-pointer"
              onClick={() => {
                setSelectedClient(client);
                setShowClientModal(true);
              }}
            >
              <div className="flex items-start gap-4">
                {/* Avatar */}
                <div className="w-14 h-14 rounded-full bg-gradient-to-br from-orange-400 to-amber-500 flex items-center justify-center text-white text-lg font-bold flex-shrink-0">
                  {client.firstName[0]}{client.lastName[0]}
                </div>

                {/* Main Info */}
                <div className="flex-1 min-w-0">
                  <div className="flex items-center gap-3 mb-1">
                    <h3 className="font-semibold text-gray-900">
                      {client.firstName} {client.lastName}
                    </h3>
                    <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${getTypeColor(client.type)}`}>
                      {client.type}
                    </span>
                    <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${getStatusColor(client.status)}`}>
                      {client.status}
                    </span>
                  </div>
                  <div className="flex items-center gap-4 text-sm text-gray-500">
                    <span className="flex items-center gap-1">
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                      </svg>
                      {client.email}
                    </span>
                    <span className="flex items-center gap-1">
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                      </svg>
                      {client.phone}
                    </span>
                  </div>
                  {client.budget && (
                    <p className="text-sm text-gray-600 mt-2">
                      Budget: {formatPrice(client.budget.min)} - {formatPrice(client.budget.max)}
                    </p>
                  )}
                  {client.tags.length > 0 && (
                    <div className="flex flex-wrap gap-1 mt-2">
                      {client.tags.map((tag, i) => (
                        <span key={i} className="px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full">
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                </div>

                {/* Stats */}
                <div className="flex items-center gap-6 text-center">
                  <div>
                    <p className="text-lg font-semibold text-gray-900">{client.properties.viewed}</p>
                    <p className="text-xs text-gray-500">Viewed</p>
                  </div>
                  <div>
                    <p className="text-lg font-semibold text-gray-900">{client.properties.offers}</p>
                    <p className="text-xs text-gray-500">Offers</p>
                  </div>
                  <div>
                    <p className="text-lg font-semibold text-green-600">{client.properties.closed}</p>
                    <p className="text-xs text-gray-500">Closed</p>
                  </div>
                </div>

                {/* Follow-up */}
                <div className="text-right flex-shrink-0">
                  <p className="text-xs text-gray-500">Last Contact</p>
                  <p className="text-sm font-medium text-gray-900">
                    {new Date(client.lastContact).toLocaleDateString()}
                  </p>
                  {client.nextFollowUp && (
                    <>
                      <p className="text-xs text-gray-500 mt-2">Next Follow-up</p>
                      <p className={`text-sm font-medium ${
                        new Date(client.nextFollowUp) < new Date() ? 'text-red-600' : 'text-orange-600'
                      }`}>
                        {new Date(client.nextFollowUp).toLocaleDateString()}
                      </p>
                    </>
                  )}
                </div>
              </div>
            </motion.div>
          ))
        )}
      </div>

      {/* Client Detail Modal */}
      <AnimatePresence>
        {showClientModal && selectedClient && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowClientModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="p-6 border-b">
                <div className="flex items-start gap-4">
                  <div className="w-16 h-16 rounded-full bg-gradient-to-br from-orange-400 to-amber-500 flex items-center justify-center text-white text-xl font-bold">
                    {selectedClient.firstName[0]}{selectedClient.lastName[0]}
                  </div>
                  <div className="flex-1">
                    <h2 className="text-xl font-bold text-gray-900">
                      {selectedClient.firstName} {selectedClient.lastName}
                    </h2>
                    <div className="flex items-center gap-2 mt-1">
                      <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${getTypeColor(selectedClient.type)}`}>
                        {selectedClient.type}
                      </span>
                      <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${getStatusColor(selectedClient.status)}`}>
                        {selectedClient.status}
                      </span>
                    </div>
                  </div>
                  <button
                    onClick={() => setShowClientModal(false)}
                    className="p-2 hover:bg-gray-100 rounded-lg"
                  >
                    <svg className="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>

              <div className="p-6 space-y-6">
                {/* Contact Info */}
                <div>
                  <h3 className="font-semibold text-gray-900 mb-3">Contact Information</h3>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                      <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                      </svg>
                      <div>
                        <p className="text-xs text-gray-500">Email</p>
                        <p className="text-sm text-gray-900">{selectedClient.email}</p>
                      </div>
                    </div>
                    <div className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                      <svg className="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                      </svg>
                      <div>
                        <p className="text-xs text-gray-500">Phone</p>
                        <p className="text-sm text-gray-900">{selectedClient.phone}</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Preferences */}
                {(selectedClient.budget || selectedClient.preferredLocations) && (
                  <div>
                    <h3 className="font-semibold text-gray-900 mb-3">Preferences</h3>
                    <div className="space-y-3">
                      {selectedClient.budget && (
                        <div className="flex items-center gap-2">
                          <span className="text-gray-500 text-sm">Budget:</span>
                          <span className="font-medium">{formatPrice(selectedClient.budget.min)} - {formatPrice(selectedClient.budget.max)}</span>
                        </div>
                      )}
                      {selectedClient.preferredLocations && selectedClient.preferredLocations.length > 0 && (
                        <div className="flex items-start gap-2">
                          <span className="text-gray-500 text-sm">Locations:</span>
                          <div className="flex flex-wrap gap-1">
                            {selectedClient.preferredLocations.map((loc, i) => (
                              <span key={i} className="px-2 py-0.5 bg-blue-100 text-blue-700 text-sm rounded-full">
                                {loc}
                              </span>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Notes */}
                {selectedClient.notes && (
                  <div>
                    <h3 className="font-semibold text-gray-900 mb-3">Notes</h3>
                    <p className="text-gray-600 bg-yellow-50 p-3 rounded-lg">{selectedClient.notes}</p>
                  </div>
                )}

                {/* Activity */}
                <div>
                  <h3 className="font-semibold text-gray-900 mb-3">Activity</h3>
                  <div className="grid grid-cols-4 gap-4 text-center">
                    <div className="p-3 bg-gray-50 rounded-lg">
                      <p className="text-2xl font-bold text-gray-900">{selectedClient.properties.interested}</p>
                      <p className="text-xs text-gray-500">Interested</p>
                    </div>
                    <div className="p-3 bg-gray-50 rounded-lg">
                      <p className="text-2xl font-bold text-gray-900">{selectedClient.properties.viewed}</p>
                      <p className="text-xs text-gray-500">Viewed</p>
                    </div>
                    <div className="p-3 bg-gray-50 rounded-lg">
                      <p className="text-2xl font-bold text-gray-900">{selectedClient.properties.offers}</p>
                      <p className="text-xs text-gray-500">Offers</p>
                    </div>
                    <div className="p-3 bg-green-50 rounded-lg">
                      <p className="text-2xl font-bold text-green-600">{selectedClient.properties.closed}</p>
                      <p className="text-xs text-gray-500">Closed</p>
                    </div>
                  </div>
                </div>

                {/* Transactions */}
                {selectedClient.transactions.length > 0 && (
                  <div>
                    <h3 className="font-semibold text-gray-900 mb-3">Transactions</h3>
                    <div className="space-y-2">
                      {selectedClient.transactions.map((txn) => (
                        <div key={txn.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                          <div>
                            <p className="font-medium text-gray-900">{txn.propertyTitle}</p>
                            <p className="text-sm text-gray-500">{txn.role} • {formatPrice(txn.amount)}</p>
                          </div>
                          <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                            txn.status === 'CLOSED' ? 'bg-green-100 text-green-700' :
                            txn.status === 'ACTIVE' ? 'bg-blue-100 text-blue-700' :
                            'bg-gray-100 text-gray-700'
                          }`}>
                            {txn.status}
                          </span>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {/* Actions */}
                <div className="flex gap-3 pt-4 border-t">
                  <button className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 flex items-center justify-center gap-2">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                    </svg>
                    Message
                  </button>
                  <button className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    Call
                  </button>
                  <button className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Schedule
                  </button>
                </div>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Add Client Modal */}
      <AnimatePresence>
        {showAddModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowAddModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="p-6 border-b">
                <h2 className="text-xl font-bold text-gray-900">Add New Client</h2>
              </div>
              <div className="p-6 space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">First Name *</label>
                    <input
                      type="text"
                      value={newClient.firstName}
                      onChange={(e) => setNewClient({ ...newClient, firstName: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Last Name *</label>
                    <input
                      type="text"
                      value={newClient.lastName}
                      onChange={(e) => setNewClient({ ...newClient, lastName: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                  <input
                    type="email"
                    value={newClient.email}
                    onChange={(e) => setNewClient({ ...newClient, email: e.target.value })}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Phone *</label>
                  <input
                    type="tel"
                    value={newClient.phone}
                    onChange={(e) => setNewClient({ ...newClient, phone: e.target.value })}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Client Type</label>
                    <select
                      value={newClient.type}
                      onChange={(e) => setNewClient({ ...newClient, type: e.target.value as any })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="BUYER">Buyer</option>
                      <option value="SELLER">Seller</option>
                      <option value="BOTH">Both</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Source</label>
                    <select
                      value={newClient.source}
                      onChange={(e) => setNewClient({ ...newClient, source: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    >
                      <option value="WEBSITE">Website</option>
                      <option value="REFERRAL">Referral</option>
                      <option value="SOCIAL_MEDIA">Social Media</option>
                      <option value="OPEN_HOUSE">Open House</option>
                      <option value="COLD_CALL">Cold Call</option>
                      <option value="OTHER">Other</option>
                    </select>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Budget Min (₹)</label>
                    <input
                      type="number"
                      value={newClient.budgetMin}
                      onChange={(e) => setNewClient({ ...newClient, budgetMin: e.target.value })}
                      placeholder="e.g., 5000000"
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Budget Max (₹)</label>
                    <input
                      type="number"
                      value={newClient.budgetMax}
                      onChange={(e) => setNewClient({ ...newClient, budgetMax: e.target.value })}
                      placeholder="e.g., 10000000"
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Preferred Locations</label>
                  <input
                    type="text"
                    value={newClient.preferredLocations}
                    onChange={(e) => setNewClient({ ...newClient, preferredLocations: e.target.value })}
                    placeholder="e.g., Bandra, Juhu, Andheri (comma-separated)"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                  <textarea
                    value={newClient.notes}
                    onChange={(e) => setNewClient({ ...newClient, notes: e.target.value })}
                    rows={3}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
              </div>
              <div className="p-6 border-t flex gap-3">
                <button
                  onClick={() => setShowAddModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button
                  onClick={handleAddClient}
                  disabled={!newClient.firstName || !newClient.lastName || !newClient.email || !newClient.phone}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 disabled:opacity-50"
                >
                  Add Client
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

interface OpenHouse {
  id: string;
  propertyId: string;
  propertyTitle: string;
  propertyAddress: string;
  propertyImage: string;
  propertyPrice: number;
  date: string;
  startTime: string;
  endTime: string;
  status: 'UPCOMING' | 'ACTIVE' | 'COMPLETED' | 'CANCELLED';
  registrations: number;
  attendees: number;
  maxCapacity: number;
  description?: string;
  refreshments: boolean;
  virtualTour: boolean;
  vastuExpert: boolean;
  registeredVisitors: {
    id: string;
    name: string;
    email: string;
    phone: string;
    registeredAt: string;
    attended: boolean;
    notes?: string;
  }[];
  feedback?: {
    averageRating: number;
    totalResponses: number;
    interested: number;
  };
}

interface OpenHouseFormData {
  propertyId: string;
  date: string;
  startTime: string;
  endTime: string;
  maxCapacity: string;
  description: string;
  refreshments: boolean;
  virtualTour: boolean;
  vastuExpert: boolean;
}

const mockOpenHouses: OpenHouse[] = [
  {
    id: 'oh-1',
    propertyId: 'prop-1',
    propertyTitle: 'Luxury Sea-Facing Penthouse',
    propertyAddress: 'Bandra West, Mumbai',
    propertyImage: '/properties/penthouse-1.jpg',
    propertyPrice: 85000000,
    date: '2024-12-08',
    startTime: '10:00',
    endTime: '14:00',
    status: 'UPCOMING',
    registrations: 24,
    attendees: 0,
    maxCapacity: 30,
    description: 'Join us for an exclusive viewing of this stunning sea-facing penthouse with panoramic views.',
    refreshments: true,
    virtualTour: true,
    vastuExpert: true,
    registeredVisitors: [
      { id: 'v-1', name: 'Priya Sharma', email: 'priya@example.com', phone: '+91 98765 11111', registeredAt: '2024-12-01', attended: false },
      { id: 'v-2', name: 'Amit Patel', email: 'amit@example.com', phone: '+91 98765 22222', registeredAt: '2024-12-02', attended: false },
    ],
  },
  {
    id: 'oh-2',
    propertyId: 'prop-2',
    propertyTitle: 'Modern 3BHK Apartment',
    propertyAddress: 'Powai, Mumbai',
    propertyImage: '/properties/apartment-2.jpg',
    propertyPrice: 25000000,
    date: '2024-12-01',
    startTime: '11:00',
    endTime: '15:00',
    status: 'COMPLETED',
    registrations: 18,
    attendees: 14,
    maxCapacity: 25,
    refreshments: true,
    virtualTour: false,
    vastuExpert: false,
    registeredVisitors: [],
    feedback: {
      averageRating: 4.2,
      totalResponses: 12,
      interested: 5,
    },
  },
  {
    id: 'oh-3',
    propertyId: 'prop-3',
    propertyTitle: 'Heritage Bungalow',
    propertyAddress: 'Malabar Hill, Mumbai',
    propertyImage: '/properties/bungalow-1.jpg',
    propertyPrice: 150000000,
    date: '2024-12-15',
    startTime: '09:00',
    endTime: '13:00',
    status: 'UPCOMING',
    registrations: 8,
    attendees: 0,
    maxCapacity: 15,
    description: 'Exclusive by-appointment viewing of this rare heritage property with Vastu consultation.',
    refreshments: true,
    virtualTour: true,
    vastuExpert: true,
    registeredVisitors: [],
  },
  {
    id: 'oh-4',
    propertyId: 'prop-4',
    propertyTitle: 'Studio Apartment',
    propertyAddress: 'Andheri West, Mumbai',
    propertyImage: '/properties/studio-1.jpg',
    propertyPrice: 8500000,
    date: '2024-11-25',
    startTime: '14:00',
    endTime: '17:00',
    status: 'CANCELLED',
    registrations: 5,
    attendees: 0,
    maxCapacity: 20,
    refreshments: false,
    virtualTour: false,
    vastuExpert: false,
    registeredVisitors: [],
  },
];

const mockProperties = [
  { id: 'prop-1', title: 'Luxury Sea-Facing Penthouse', address: 'Bandra West, Mumbai' },
  { id: 'prop-2', title: 'Modern 3BHK Apartment', address: 'Powai, Mumbai' },
  { id: 'prop-3', title: 'Heritage Bungalow', address: 'Malabar Hill, Mumbai' },
  { id: 'prop-5', title: '2BHK Garden Apartment', address: 'Juhu, Mumbai' },
  { id: 'prop-6', title: 'Duplex Villa', address: 'Worli, Mumbai' },
];

export default function OpenHousesPage() {
  const [loading, setLoading] = useState(true);
  const [openHouses, setOpenHouses] = useState<OpenHouse[]>(mockOpenHouses);
  const [filteredOpenHouses, setFilteredOpenHouses] = useState<OpenHouse[]>(mockOpenHouses);
  const [statusFilter, setStatusFilter] = useState<string>('all');
  const [selectedOpenHouse, setSelectedOpenHouse] = useState<OpenHouse | null>(null);
  const [showDetailModal, setShowDetailModal] = useState(false);
  const [showCreateModal, setShowCreateModal] = useState(false);
  const [viewMode, setViewMode] = useState<'grid' | 'calendar'>('grid');
  const [newOpenHouse, setNewOpenHouse] = useState<OpenHouseFormData>({
    propertyId: '',
    date: '',
    startTime: '',
    endTime: '',
    maxCapacity: '20',
    description: '',
    refreshments: false,
    virtualTour: false,
    vastuExpert: false,
  });

  useEffect(() => {
    setTimeout(() => setLoading(false), 500);
  }, []);

  useEffect(() => {
    let filtered = openHouses;
    if (statusFilter !== 'all') {
      filtered = filtered.filter((oh) => oh.status === statusFilter);
    }
    setFilteredOpenHouses(filtered);
  }, [openHouses, statusFilter]);

  const formatPrice = (price: number) => {
    if (price >= 10000000) {
      return `₹${(price / 10000000).toFixed(1)}Cr`;
    } else if (price >= 100000) {
      return `₹${(price / 100000).toFixed(1)}L`;
    }
    return `₹${price.toLocaleString()}`;
  };

  const formatDate = (dateStr: string) => {
    return new Date(dateStr).toLocaleDateString('en-IN', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    });
  };

  const formatTime = (time: string) => {
    const [hours, minutes] = time.split(':');
    const h = parseInt(hours);
    const ampm = h >= 12 ? 'PM' : 'AM';
    const h12 = h % 12 || 12;
    return `${h12}:${minutes} ${ampm}`;
  };

  const getStatusColor = (status: string) => {
    switch (status) {
      case 'UPCOMING': return 'bg-blue-100 text-blue-700';
      case 'ACTIVE': return 'bg-green-100 text-green-700';
      case 'COMPLETED': return 'bg-purple-100 text-purple-700';
      case 'CANCELLED': return 'bg-red-100 text-red-700';
      default: return 'bg-gray-100 text-gray-700';
    }
  };

  const stats = {
    total: openHouses.length,
    upcoming: openHouses.filter((oh) => oh.status === 'UPCOMING').length,
    completed: openHouses.filter((oh) => oh.status === 'COMPLETED').length,
    totalRegistrations: openHouses.reduce((sum, oh) => sum + oh.registrations, 0),
  };

  const handleCreateOpenHouse = () => {
    const property = mockProperties.find(p => p.id === newOpenHouse.propertyId);
    if (!property) return;

    const oh: OpenHouse = {
      id: `oh-${Date.now()}`,
      propertyId: newOpenHouse.propertyId,
      propertyTitle: property.title,
      propertyAddress: property.address,
      propertyImage: '/properties/default.jpg',
      propertyPrice: 50000000,
      date: newOpenHouse.date,
      startTime: newOpenHouse.startTime,
      endTime: newOpenHouse.endTime,
      status: 'UPCOMING',
      registrations: 0,
      attendees: 0,
      maxCapacity: parseInt(newOpenHouse.maxCapacity),
      description: newOpenHouse.description,
      refreshments: newOpenHouse.refreshments,
      virtualTour: newOpenHouse.virtualTour,
      vastuExpert: newOpenHouse.vastuExpert,
      registeredVisitors: [],
    };

    setOpenHouses([oh, ...openHouses]);
    setShowCreateModal(false);
    setNewOpenHouse({
      propertyId: '',
      date: '',
      startTime: '',
      endTime: '',
      maxCapacity: '20',
      description: '',
      refreshments: false,
      virtualTour: false,
      vastuExpert: false,
    });
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-96">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"></div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Open Houses</h1>
          <p className="text-gray-600">Schedule and manage property open house events</p>
        </div>
        <button
          onClick={() => setShowCreateModal(true)}
          className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 flex items-center gap-2"
        >
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
          </svg>
          Schedule Open House
        </button>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-4 gap-4">
        {[
          { label: 'Total Events', value: stats.total, icon: '🏠', color: 'bg-blue-50 text-blue-600' },
          { label: 'Upcoming', value: stats.upcoming, icon: '📅', color: 'bg-green-50 text-green-600' },
          { label: 'Completed', value: stats.completed, icon: '✅', color: 'bg-purple-50 text-purple-600' },
          { label: 'Total Registrations', value: stats.totalRegistrations, icon: '👥', color: 'bg-orange-50 text-orange-600' },
        ].map((stat, index) => (
          <motion.div
            key={stat.label}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: index * 0.05 }}
            className={`p-4 rounded-xl ${stat.color}`}
          >
            <div className="flex items-center justify-between">
              <span className="text-2xl">{stat.icon}</span>
              <span className="text-2xl font-bold">{stat.value}</span>
            </div>
            <p className="text-sm mt-2 opacity-80">{stat.label}</p>
          </motion.div>
        ))}
      </div>

      {/* Filters */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-2">
          {['all', 'UPCOMING', 'COMPLETED', 'CANCELLED'].map((status) => (
            <button
              key={status}
              onClick={() => setStatusFilter(status)}
              className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
                statusFilter === status
                  ? 'bg-orange-500 text-white'
                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
              }`}
            >
              {status === 'all' ? 'All' : status.charAt(0) + status.slice(1).toLowerCase()}
            </button>
          ))}
        </div>
        <div className="flex items-center gap-2 bg-gray-100 p-1 rounded-lg">
          <button
            onClick={() => setViewMode('grid')}
            className={`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${
              viewMode === 'grid' ? 'bg-white shadow text-gray-900' : 'text-gray-600'
            }`}
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
            </svg>
          </button>
          <button
            onClick={() => setViewMode('calendar')}
            className={`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${
              viewMode === 'calendar' ? 'bg-white shadow text-gray-900' : 'text-gray-600'
            }`}
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
          </button>
        </div>
      </div>

      {/* Grid View */}
      {viewMode === 'grid' && (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredOpenHouses.length === 0 ? (
            <div className="col-span-full text-center py-12 bg-white rounded-xl border border-gray-200">
              <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              <p className="text-gray-500">No open houses found</p>
              <button
                onClick={() => setShowCreateModal(true)}
                className="mt-4 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600"
              >
                Schedule Open House
              </button>
            </div>
          ) : (
            filteredOpenHouses.map((oh, index) => (
              <motion.div
                key={oh.id}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.05 }}
                className="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow cursor-pointer"
                onClick={() => {
                  setSelectedOpenHouse(oh);
                  setShowDetailModal(true);
                }}
              >
                {/* Property Image */}
                <div className="relative h-40 bg-gradient-to-br from-orange-100 to-amber-100">
                  <div className="absolute inset-0 flex items-center justify-center">
                    <span className="text-6xl opacity-30">🏠</span>
                  </div>
                  <div className="absolute top-3 left-3">
                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(oh.status)}`}>
                      {oh.status}
                    </span>
                  </div>
                  <div className="absolute top-3 right-3">
                    <span className="px-2 py-1 bg-black/60 text-white rounded-full text-xs font-medium">
                      {formatPrice(oh.propertyPrice)}
                    </span>
                  </div>
                </div>

                <div className="p-4">
                  <h3 className="font-semibold text-gray-900 mb-1 truncate">{oh.propertyTitle}</h3>
                  <p className="text-sm text-gray-500 mb-3">{oh.propertyAddress}</p>

                  {/* Date & Time */}
                  <div className="flex items-center gap-2 text-sm text-gray-600 mb-3">
                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <span>{new Date(oh.date).toLocaleDateString()}</span>
                    <span>•</span>
                    <span>{formatTime(oh.startTime)} - {formatTime(oh.endTime)}</span>
                  </div>

                  {/* Features */}
                  <div className="flex items-center gap-2 mb-3">
                    {oh.refreshments && (
                      <span className="px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full">☕ Refreshments</span>
                    )}
                    {oh.virtualTour && (
                      <span className="px-2 py-0.5 bg-blue-100 text-blue-700 text-xs rounded-full">🎥 Virtual Tour</span>
                    )}
                    {oh.vastuExpert && (
                      <span className="px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded-full">🕉️ Vastu Expert</span>
                    )}
                  </div>

                  {/* Registration Stats */}
                  <div className="flex items-center justify-between pt-3 border-t">
                    <div className="flex items-center gap-1 text-sm text-gray-600">
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                      </svg>
                      <span>{oh.registrations} / {oh.maxCapacity}</span>
                    </div>
                    {oh.feedback && (
                      <div className="flex items-center gap-1 text-sm">
                        <span className="text-yellow-500">★</span>
                        <span className="text-gray-600">{oh.feedback.averageRating.toFixed(1)}</span>
                      </div>
                    )}
                  </div>
                </div>
              </motion.div>
            ))
          )}
        </div>
      )}

      {/* Calendar View */}
      {viewMode === 'calendar' && (
        <div className="bg-white rounded-xl border border-gray-200 p-6">
          <div className="text-center py-12">
            <svg className="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <p className="text-gray-500 mb-2">Calendar view coming soon</p>
            <p className="text-sm text-gray-400">Full calendar integration with drag-and-drop scheduling</p>
          </div>
        </div>
      )}

      {/* Detail Modal */}
      <AnimatePresence>
        {showDetailModal && selectedOpenHouse && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowDetailModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
              onClick={(e) => e.stopPropagation()}
            >
              {/* Header */}
              <div className="relative h-48 bg-gradient-to-br from-orange-100 to-amber-100">
                <div className="absolute inset-0 flex items-center justify-center">
                  <span className="text-8xl opacity-30">🏠</span>
                </div>
                <button
                  onClick={() => setShowDetailModal(false)}
                  className="absolute top-4 right-4 p-2 bg-white/80 rounded-full hover:bg-white"
                >
                  <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
                <div className="absolute bottom-4 left-4">
                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(selectedOpenHouse.status)}`}>
                    {selectedOpenHouse.status}
                  </span>
                </div>
              </div>

              <div className="p-6 space-y-6">
                {/* Property Info */}
                <div>
                  <h2 className="text-xl font-bold text-gray-900">{selectedOpenHouse.propertyTitle}</h2>
                  <p className="text-gray-500">{selectedOpenHouse.propertyAddress}</p>
                  <p className="text-lg font-semibold text-orange-600 mt-1">
                    {formatPrice(selectedOpenHouse.propertyPrice)}
                  </p>
                </div>

                {/* Date & Time */}
                <div className="bg-gray-50 rounded-lg p-4">
                  <h3 className="font-semibold text-gray-900 mb-3">Event Details</h3>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-blue-100 rounded-lg">
                        <svg className="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                      </div>
                      <div>
                        <p className="text-xs text-gray-500">Date</p>
                        <p className="font-medium">{formatDate(selectedOpenHouse.date)}</p>
                      </div>
                    </div>
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-green-100 rounded-lg">
                        <svg className="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                      </div>
                      <div>
                        <p className="text-xs text-gray-500">Time</p>
                        <p className="font-medium">{formatTime(selectedOpenHouse.startTime)} - {formatTime(selectedOpenHouse.endTime)}</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Description */}
                {selectedOpenHouse.description && (
                  <div>
                    <h3 className="font-semibold text-gray-900 mb-2">Description</h3>
                    <p className="text-gray-600">{selectedOpenHouse.description}</p>
                  </div>
                )}

                {/* Features */}
                <div>
                  <h3 className="font-semibold text-gray-900 mb-3">Features</h3>
                  <div className="flex flex-wrap gap-2">
                    {selectedOpenHouse.refreshments && (
                      <span className="px-3 py-1.5 bg-green-100 text-green-700 rounded-full flex items-center gap-2">
                        ☕ Refreshments Provided
                      </span>
                    )}
                    {selectedOpenHouse.virtualTour && (
                      <span className="px-3 py-1.5 bg-blue-100 text-blue-700 rounded-full flex items-center gap-2">
                        🎥 Virtual Tour Available
                      </span>
                    )}
                    {selectedOpenHouse.vastuExpert && (
                      <span className="px-3 py-1.5 bg-orange-100 text-orange-700 rounded-full flex items-center gap-2">
                        🕉️ Vastu Expert Present
                      </span>
                    )}
                  </div>
                </div>

                {/* Registration Stats */}
                <div>
                  <h3 className="font-semibold text-gray-900 mb-3">Registrations</h3>
                  <div className="flex items-center gap-4">
                    <div className="flex-1">
                      <div className="flex justify-between text-sm mb-1">
                        <span className="text-gray-600">Registered</span>
                        <span className="font-medium">{selectedOpenHouse.registrations} / {selectedOpenHouse.maxCapacity}</span>
                      </div>
                      <div className="h-2 bg-gray-100 rounded-full overflow-hidden">
                        <div
                          className="h-full bg-orange-500 rounded-full"
                          style={{ width: `${(selectedOpenHouse.registrations / selectedOpenHouse.maxCapacity) * 100}%` }}
                        />
                      </div>
                    </div>
                    {selectedOpenHouse.status === 'COMPLETED' && (
                      <div className="text-center px-4 py-2 bg-purple-50 rounded-lg">
                        <p className="text-2xl font-bold text-purple-600">{selectedOpenHouse.attendees}</p>
                        <p className="text-xs text-purple-500">Attended</p>
                      </div>
                    )}
                  </div>
                </div>

                {/* Feedback (if completed) */}
                {selectedOpenHouse.feedback && (
                  <div>
                    <h3 className="font-semibold text-gray-900 mb-3">Feedback</h3>
                    <div className="grid grid-cols-3 gap-4">
                      <div className="text-center p-3 bg-yellow-50 rounded-lg">
                        <div className="flex items-center justify-center gap-1">
                          <span className="text-2xl font-bold text-yellow-600">{selectedOpenHouse.feedback.averageRating.toFixed(1)}</span>
                          <span className="text-yellow-500">★</span>
                        </div>
                        <p className="text-xs text-yellow-600">Avg Rating</p>
                      </div>
                      <div className="text-center p-3 bg-blue-50 rounded-lg">
                        <p className="text-2xl font-bold text-blue-600">{selectedOpenHouse.feedback.totalResponses}</p>
                        <p className="text-xs text-blue-600">Responses</p>
                      </div>
                      <div className="text-center p-3 bg-green-50 rounded-lg">
                        <p className="text-2xl font-bold text-green-600">{selectedOpenHouse.feedback.interested}</p>
                        <p className="text-xs text-green-600">Interested</p>
                      </div>
                    </div>
                  </div>
                )}

                {/* Registered Visitors */}
                {selectedOpenHouse.registeredVisitors.length > 0 && (
                  <div>
                    <h3 className="font-semibold text-gray-900 mb-3">Registered Visitors</h3>
                    <div className="space-y-2 max-h-48 overflow-y-auto">
                      {selectedOpenHouse.registeredVisitors.map((visitor) => (
                        <div key={visitor.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                          <div className="flex items-center gap-3">
                            <div className="w-10 h-10 rounded-full bg-gradient-to-br from-orange-400 to-amber-500 flex items-center justify-center text-white font-medium">
                              {visitor.name.split(' ').map(n => n[0]).join('')}
                            </div>
                            <div>
                              <p className="font-medium text-gray-900">{visitor.name}</p>
                              <p className="text-sm text-gray-500">{visitor.email}</p>
                            </div>
                          </div>
                          {selectedOpenHouse.status === 'COMPLETED' && (
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                              visitor.attended ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
                            }`}>
                              {visitor.attended ? 'Attended' : 'No Show'}
                            </span>
                          )}
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {/* Actions */}
                <div className="flex gap-3 pt-4 border-t">
                  {selectedOpenHouse.status === 'UPCOMING' && (
                    <>
                      <button className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600">
                        Edit Event
                      </button>
                      <button className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                        Send Reminder
                      </button>
                      <button className="px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50">
                        Cancel
                      </button>
                    </>
                  )}
                  {selectedOpenHouse.status === 'COMPLETED' && (
                    <button className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600">
                      View Full Report
                    </button>
                  )}
                </div>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Create Modal */}
      <AnimatePresence>
        {showCreateModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowCreateModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95 }}
              animate={{ scale: 1 }}
              exit={{ scale: 0.95 }}
              className="bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="p-6 border-b">
                <h2 className="text-xl font-bold text-gray-900">Schedule Open House</h2>
              </div>
              <div className="p-6 space-y-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Property *</label>
                  <select
                    value={newOpenHouse.propertyId}
                    onChange={(e) => setNewOpenHouse({ ...newOpenHouse, propertyId: e.target.value })}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  >
                    <option value="">Select a property</option>
                    {mockProperties.map((prop) => (
                      <option key={prop.id} value={prop.id}>
                        {prop.title} - {prop.address}
                      </option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Date *</label>
                  <input
                    type="date"
                    value={newOpenHouse.date}
                    onChange={(e) => setNewOpenHouse({ ...newOpenHouse, date: e.target.value })}
                    min={new Date().toISOString().split('T')[0]}
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">Start Time *</label>
                    <input
                      type="time"
                      value={newOpenHouse.startTime}
                      onChange={(e) => setNewOpenHouse({ ...newOpenHouse, startTime: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">End Time *</label>
                    <input
                      type="time"
                      value={newOpenHouse.endTime}
                      onChange={(e) => setNewOpenHouse({ ...newOpenHouse, endTime: e.target.value })}
                      className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                    />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Max Capacity</label>
                  <input
                    type="number"
                    value={newOpenHouse.maxCapacity}
                    onChange={(e) => setNewOpenHouse({ ...newOpenHouse, maxCapacity: e.target.value })}
                    min="1"
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">Description</label>
                  <textarea
                    value={newOpenHouse.description}
                    onChange={(e) => setNewOpenHouse({ ...newOpenHouse, description: e.target.value })}
                    rows={3}
                    placeholder="Add details about the open house event..."
                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-3">Features</label>
                  <div className="space-y-2">
                    <label className="flex items-center gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        checked={newOpenHouse.refreshments}
                        onChange={(e) => setNewOpenHouse({ ...newOpenHouse, refreshments: e.target.checked })}
                        className="w-4 h-4 text-orange-500 rounded focus:ring-orange-500"
                      />
                      <span className="text-gray-700">☕ Refreshments will be provided</span>
                    </label>
                    <label className="flex items-center gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        checked={newOpenHouse.virtualTour}
                        onChange={(e) => setNewOpenHouse({ ...newOpenHouse, virtualTour: e.target.checked })}
                        className="w-4 h-4 text-orange-500 rounded focus:ring-orange-500"
                      />
                      <span className="text-gray-700">🎥 Virtual tour available</span>
                    </label>
                    <label className="flex items-center gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        checked={newOpenHouse.vastuExpert}
                        onChange={(e) => setNewOpenHouse({ ...newOpenHouse, vastuExpert: e.target.checked })}
                        className="w-4 h-4 text-orange-500 rounded focus:ring-orange-500"
                      />
                      <span className="text-gray-700">🕉️ Vastu expert will be present</span>
                    </label>
                  </div>
                </div>
              </div>
              <div className="p-6 border-t flex gap-3">
                <button
                  onClick={() => setShowCreateModal(false)}
                  className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button
                  onClick={handleCreateOpenHouse}
                  disabled={!newOpenHouse.propertyId || !newOpenHouse.date || !newOpenHouse.startTime || !newOpenHouse.endTime}
                  className="flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 disabled:opacity-50"
                >
                  Schedule
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}













'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface VastuScore {
  overall: number;
  entrance: number;
  kitchen: number;
  bedroom: number;
  bathroom: number;
}

interface AstrologyCompatibility {
  score: number;
  favorableDirections: string[];
  auspiciousDates: string[];
}

interface Property {
  id: string;
  title: string;
  address: string;
  city: string;
  state: string;
  price: number;
  propertyType: 'APARTMENT' | 'HOUSE' | 'VILLA' | 'PLOT' | 'COMMERCIAL';
  bedrooms: number;
  bathrooms: number;
  area: number;
  areaUnit: 'SQFT' | 'SQMT';
  yearBuilt: number;
  parking: number;
  furnished: 'UNFURNISHED' | 'SEMI_FURNISHED' | 'FULLY_FURNISHED';
  facing: string;
  floor?: number;
  totalFloors?: number;
  amenities: string[];
  images: string[];
  vastu: VastuScore;
  astrology?: AstrologyCompatibility;
  pricePerSqft: number;
  maintenanceFee?: number;
  availableFrom: string;
  listedDate: string;
  views: number;
  saves: number;
}

const mockProperties: Property[] = [
  {
    id: '1',
    title: 'Serene Valley Villa',
    address: '123 Green Valley Road',
    city: 'Bangalore',
    state: 'Karnataka',
    price: 15000000,
    propertyType: 'VILLA',
    bedrooms: 4,
    bathrooms: 4,
    area: 3500,
    areaUnit: 'SQFT',
    yearBuilt: 2021,
    parking: 2,
    furnished: 'SEMI_FURNISHED',
    facing: 'East',
    amenities: ['Swimming Pool', 'Garden', 'Gym', 'Security', 'Power Backup', 'Club House'],
    images: [],
    vastu: { overall: 92, entrance: 95, kitchen: 88, bedroom: 94, bathroom: 90 },
    astrology: { score: 88, favorableDirections: ['East', 'North'], auspiciousDates: ['2024-02-15', '2024-03-10'] },
    pricePerSqft: 4286,
    maintenanceFee: 8000,
    availableFrom: '2024-03-01',
    listedDate: '2024-01-15',
    views: 245,
    saves: 32,
  },
  {
    id: '2',
    title: 'Harmony Heights Apartment',
    address: '456 Peace Street',
    city: 'Mumbai',
    state: 'Maharashtra',
    price: 12500000,
    propertyType: 'APARTMENT',
    bedrooms: 3,
    bathrooms: 3,
    area: 1850,
    areaUnit: 'SQFT',
    yearBuilt: 2023,
    parking: 1,
    furnished: 'FULLY_FURNISHED',
    facing: 'North-East',
    floor: 12,
    totalFloors: 25,
    amenities: ['Gym', 'Security', 'Power Backup', 'Lift', 'Intercom', 'CCTV'],
    images: [],
    vastu: { overall: 85, entrance: 82, kitchen: 90, bedroom: 85, bathroom: 82 },
    astrology: { score: 75, favorableDirections: ['North', 'East'], auspiciousDates: ['2024-02-20'] },
    pricePerSqft: 6757,
    maintenanceFee: 6500,
    availableFrom: '2024-02-15',
    listedDate: '2024-01-20',
    views: 189,
    saves: 28,
  },
  {
    id: '3',
    title: 'Lotus Garden House',
    address: '789 Temple Road',
    city: 'Chennai',
    state: 'Tamil Nadu',
    price: 9500000,
    propertyType: 'HOUSE',
    bedrooms: 3,
    bathrooms: 2,
    area: 2200,
    areaUnit: 'SQFT',
    yearBuilt: 2019,
    parking: 2,
    furnished: 'UNFURNISHED',
    facing: 'South',
    amenities: ['Garden', 'Security', 'Power Backup', 'Water Storage'],
    images: [],
    vastu: { overall: 78, entrance: 75, kitchen: 82, bedroom: 80, bathroom: 76 },
    pricePerSqft: 4318,
    availableFrom: '2024-01-30',
    listedDate: '2024-01-10',
    views: 156,
    saves: 19,
  },
];

const allProperties: Property[] = [
  ...mockProperties,
  {
    id: '4',
    title: 'Sunrise Towers Penthouse',
    address: '101 Sky High Avenue',
    city: 'Delhi',
    state: 'Delhi',
    price: 25000000,
    propertyType: 'APARTMENT',
    bedrooms: 5,
    bathrooms: 5,
    area: 4500,
    areaUnit: 'SQFT',
    yearBuilt: 2022,
    parking: 3,
    furnished: 'FULLY_FURNISHED',
    facing: 'West',
    floor: 30,
    totalFloors: 32,
    amenities: ['Private Pool', 'Terrace', 'Gym', 'Spa', 'Concierge', 'Helipad Access'],
    images: [],
    vastu: { overall: 88, entrance: 90, kitchen: 85, bedroom: 92, bathroom: 84 },
    astrology: { score: 92, favorableDirections: ['West', 'North'], auspiciousDates: ['2024-03-01', '2024-03-15'] },
    pricePerSqft: 5556,
    maintenanceFee: 25000,
    availableFrom: '2024-04-01',
    listedDate: '2024-01-25',
    views: 320,
    saves: 45,
  },
];

export default function ComparePage() {
  const [selectedProperties, setSelectedProperties] = useState<Property[]>(mockProperties.slice(0, 2));
  const [showAddModal, setShowAddModal] = useState(false);
  const [searchQuery, setSearchQuery] = useState('');
  const [highlightDifferences, setHighlightDifferences] = useState(true);

  const formatPrice = (price: number) => {
    if (price >= 10000000) {
      return `₹${(price / 10000000).toFixed(2)} Cr`;
    } else if (price >= 100000) {
      return `₹${(price / 100000).toFixed(2)} L`;
    }
    return `₹${price.toLocaleString()}`;
  };

  const formatDate = (dateString: string) => {
    return new Date(dateString).toLocaleDateString('en-IN', {
      day: 'numeric',
      month: 'short',
      year: 'numeric',
    });
  };

  const removeProperty = (id: string) => {
    setSelectedProperties(prev => prev.filter(p => p.id !== id));
  };

  const addProperty = (property: Property) => {
    if (selectedProperties.length < 4 && !selectedProperties.find(p => p.id === property.id)) {
      setSelectedProperties(prev => [...prev, property]);
    }
    setShowAddModal(false);
  };

  const getComparisonClass = (values: (number | string | undefined)[], index: number, higherIsBetter: boolean = true) => {
    if (!highlightDifferences) return '';
    
    const numericValues = values.filter(v => typeof v === 'number') as number[];
    if (numericValues.length < 2) return '';
    
    const currentValue = values[index];
    if (typeof currentValue !== 'number') return '';
    
    const best = higherIsBetter ? Math.max(...numericValues) : Math.min(...numericValues);
    const worst = higherIsBetter ? Math.min(...numericValues) : Math.max(...numericValues);
    
    if (currentValue === best) return 'bg-green-50 text-green-700 font-semibold';
    if (currentValue === worst && numericValues.length > 2) return 'bg-red-50 text-red-700';
    return '';
  };

  const getVastuScoreColor = (score: number) => {
    if (score >= 85) return 'text-green-600';
    if (score >= 70) return 'text-yellow-600';
    return 'text-red-600';
  };

  const availableToAdd = allProperties.filter(
    p => !selectedProperties.find(sp => sp.id === p.id) &&
    (searchQuery === '' || 
     p.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
     p.city.toLowerCase().includes(searchQuery.toLowerCase()))
  );

  const comparisonRows = [
    { label: 'Price', key: 'price', format: (v: number) => formatPrice(v), higherIsBetter: false },
    { label: 'Price per Sq.Ft', key: 'pricePerSqft', format: (v: number) => `₹${v.toLocaleString()}`, higherIsBetter: false },
    { label: 'Area', key: 'area', format: (v: number, p: Property) => `${v.toLocaleString()} ${p.areaUnit}`, higherIsBetter: true },
    { label: 'Bedrooms', key: 'bedrooms', format: (v: number) => v.toString(), higherIsBetter: true },
    { label: 'Bathrooms', key: 'bathrooms', format: (v: number) => v.toString(), higherIsBetter: true },
    { label: 'Parking', key: 'parking', format: (v: number) => `${v} spot${v > 1 ? 's' : ''}`, higherIsBetter: true },
    { label: 'Year Built', key: 'yearBuilt', format: (v: number) => v.toString(), higherIsBetter: true },
    { label: 'Facing', key: 'facing', format: (v: string) => v, higherIsBetter: null },
    { label: 'Furnished', key: 'furnished', format: (v: string) => v.replace('_', ' '), higherIsBetter: null },
    { label: 'Maintenance', key: 'maintenanceFee', format: (v: number | undefined) => v ? `₹${v.toLocaleString()}/mo` : 'N/A', higherIsBetter: false },
    { label: 'Available From', key: 'availableFrom', format: (v: string) => formatDate(v), higherIsBetter: null },
  ];

  const vastuRows = [
    { label: 'Overall Score', key: 'overall' },
    { label: 'Entrance', key: 'entrance' },
    { label: 'Kitchen', key: 'kitchen' },
    { label: 'Bedroom', key: 'bedroom' },
    { label: 'Bathroom', key: 'bathroom' },
  ];

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Header */}
      <div className="bg-white border-b sticky top-0 z-40">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <Link href="/search" className="text-gray-600 hover:text-gray-900">
                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
              </Link>
              <div>
                <h1 className="text-2xl font-bold text-gray-900">Compare Properties</h1>
                <p className="text-sm text-gray-600">
                  {selectedProperties.length} of 4 properties selected
                </p>
              </div>
            </div>
            <div className="flex items-center gap-4">
              <label className="flex items-center gap-2 text-sm text-gray-600">
                <input
                  type="checkbox"
                  checked={highlightDifferences}
                  onChange={(e) => setHighlightDifferences(e.target.checked)}
                  className="w-4 h-4 rounded text-orange-500 focus:ring-orange-500"
                />
                Highlight differences
              </label>
              {selectedProperties.length < 4 && (
                <button
                  onClick={() => setShowAddModal(true)}
                  className="px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:shadow-lg transition-all flex items-center gap-2"
                >
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                  </svg>
                  Add Property
                </button>
              )}
            </div>
          </div>
        </div>
      </div>

      {/* Comparison Table */}
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {selectedProperties.length === 0 ? (
          <div className="text-center py-16">
            <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg className="w-12 h-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7" />
              </svg>
            </div>
            <h3 className="text-lg font-medium text-gray-900 mb-2">No properties to compare</h3>
            <p className="text-gray-600 mb-6">Add properties to start comparing</p>
            <button
              onClick={() => setShowAddModal(true)}
              className="px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:shadow-lg transition-all"
            >
              Add Properties
            </button>
          </div>
        ) : (
          <div className="bg-white rounded-xl shadow-sm border overflow-hidden">
            <div className="overflow-x-auto">
              <table className="w-full">
                {/* Property Headers */}
                <thead>
                  <tr className="bg-gray-50 border-b">
                    <th className="text-left p-4 w-48 font-medium text-gray-600">Property</th>
                    {selectedProperties.map((property) => (
                      <th key={property.id} className="p-4 min-w-[250px]">
                        <div className="relative">
                          <button
                            onClick={() => removeProperty(property.id)}
                            className="absolute -top-2 -right-2 w-6 h-6 bg-red-100 text-red-600 rounded-full hover:bg-red-200 flex items-center justify-center"
                          >
                            <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                            </svg>
                          </button>
                          <div className="aspect-video bg-gradient-to-br from-orange-100 to-amber-100 rounded-lg mb-3 flex items-center justify-center">
                            <svg className="w-12 h-12 text-orange-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                            </svg>
                          </div>
                          <h3 className="font-semibold text-gray-900">{property.title}</h3>
                          <p className="text-sm text-gray-500">{property.city}, {property.state}</p>
                          <p className="text-lg font-bold text-orange-600 mt-1">{formatPrice(property.price)}</p>
                        </div>
                      </th>
                    ))}
                    {selectedProperties.length < 4 && (
                      <th className="p-4 min-w-[200px]">
                        <button
                          onClick={() => setShowAddModal(true)}
                          className="w-full aspect-video border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center text-gray-400 hover:border-orange-400 hover:text-orange-500 transition-colors"
                        >
                          <svg className="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                          </svg>
                          <span className="text-sm mt-2">Add Property</span>
                        </button>
                      </th>
                    )}
                  </tr>
                </thead>

                <tbody>
                  {/* Property Type */}
                  <tr className="border-b">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Property Type</td>
                    {selectedProperties.map((property) => (
                      <td key={property.id} className="p-4 text-center">
                        <span className="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm">
                          {property.propertyType}
                        </span>
                      </td>
                    ))}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  {/* Basic Details */}
                  {comparisonRows.map((row) => (
                    <tr key={row.key} className="border-b hover:bg-gray-50">
                      <td className="p-4 font-medium text-gray-600 bg-gray-50">{row.label}</td>
                      {selectedProperties.map((property, index) => {
                        const value = property[row.key as keyof Property];
                        const values = selectedProperties.map(p => p[row.key as keyof Property]);
                        return (
                          <td
                            key={property.id}
                            className={`p-4 text-center ${row.higherIsBetter !== null ? getComparisonClass(values as (number | string | undefined)[], index, row.higherIsBetter) : ''}`}
                          >
                            {row.format(value as any, property)}
                          </td>
                        );
                      })}
                      {selectedProperties.length < 4 && <td />}
                    </tr>
                  ))}

                  {/* Floor Info */}
                  <tr className="border-b hover:bg-gray-50">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Floor</td>
                    {selectedProperties.map((property) => (
                      <td key={property.id} className="p-4 text-center">
                        {property.floor ? `${property.floor} of ${property.totalFloors}` : 'N/A'}
                      </td>
                    ))}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  {/* Section Header: Vastu Scores */}
                  <tr className="bg-gradient-to-r from-orange-50 to-amber-50">
                    <td colSpan={selectedProperties.length + 2} className="p-4">
                      <div className="flex items-center gap-2">
                        <span className="text-xl">🕉️</span>
                        <span className="font-semibold text-gray-900">Vastu Shastra Analysis</span>
                      </div>
                    </td>
                  </tr>

                  {vastuRows.map((row) => (
                    <tr key={row.key} className="border-b hover:bg-gray-50">
                      <td className="p-4 font-medium text-gray-600 bg-gray-50">{row.label}</td>
                      {selectedProperties.map((property, index) => {
                        const score = property.vastu[row.key as keyof VastuScore];
                        const scores = selectedProperties.map(p => p.vastu[row.key as keyof VastuScore]);
                        return (
                          <td
                            key={property.id}
                            className={`p-4 text-center ${getComparisonClass(scores, index, true)}`}
                          >
                            <div className="flex items-center justify-center gap-2">
                              <div className="w-16 h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div
                                  className={`h-full rounded-full ${
                                    score >= 85 ? 'bg-green-500' : score >= 70 ? 'bg-yellow-500' : 'bg-red-500'
                                  }`}
                                  style={{ width: `${score}%` }}
                                />
                              </div>
                              <span className={getVastuScoreColor(score)}>{score}%</span>
                            </div>
                          </td>
                        );
                      })}
                      {selectedProperties.length < 4 && <td />}
                    </tr>
                  ))}

                  {/* Section Header: Astrology */}
                  <tr className="bg-gradient-to-r from-purple-50 to-indigo-50">
                    <td colSpan={selectedProperties.length + 2} className="p-4">
                      <div className="flex items-center gap-2">
                        <span className="text-xl">⭐</span>
                        <span className="font-semibold text-gray-900">Jyotish Compatibility</span>
                      </div>
                    </td>
                  </tr>

                  <tr className="border-b hover:bg-gray-50">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Compatibility Score</td>
                    {selectedProperties.map((property, index) => {
                      const score = property.astrology?.score;
                      const scores = selectedProperties.map(p => p.astrology?.score);
                      return (
                        <td
                          key={property.id}
                          className={`p-4 text-center ${score ? getComparisonClass(scores as number[], index, true) : ''}`}
                        >
                          {score ? (
                            <span className={getVastuScoreColor(score)}>{score}%</span>
                          ) : (
                            <span className="text-gray-400">Not calculated</span>
                          )}
                        </td>
                      );
                    })}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  <tr className="border-b hover:bg-gray-50">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Favorable Directions</td>
                    {selectedProperties.map((property) => (
                      <td key={property.id} className="p-4 text-center">
                        {property.astrology?.favorableDirections ? (
                          <div className="flex flex-wrap gap-1 justify-center">
                            {property.astrology.favorableDirections.map((dir) => (
                              <span key={dir} className="px-2 py-1 bg-purple-100 text-purple-700 rounded text-sm">
                                {dir}
                              </span>
                            ))}
                          </div>
                        ) : (
                          <span className="text-gray-400">N/A</span>
                        )}
                      </td>
                    ))}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  {/* Section Header: Amenities */}
                  <tr className="bg-gradient-to-r from-green-50 to-teal-50">
                    <td colSpan={selectedProperties.length + 2} className="p-4">
                      <div className="flex items-center gap-2">
                        <span className="text-xl">✨</span>
                        <span className="font-semibold text-gray-900">Amenities</span>
                      </div>
                    </td>
                  </tr>

                  <tr className="border-b">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Features</td>
                    {selectedProperties.map((property) => (
                      <td key={property.id} className="p-4">
                        <div className="flex flex-wrap gap-1 justify-center">
                          {property.amenities.map((amenity) => (
                            <span
                              key={amenity}
                              className="px-2 py-1 bg-green-100 text-green-700 rounded text-xs"
                            >
                              {amenity}
                            </span>
                          ))}
                        </div>
                      </td>
                    ))}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  {/* Section Header: Engagement */}
                  <tr className="bg-gradient-to-r from-blue-50 to-cyan-50">
                    <td colSpan={selectedProperties.length + 2} className="p-4">
                      <div className="flex items-center gap-2">
                        <span className="text-xl">📊</span>
                        <span className="font-semibold text-gray-900">Engagement Stats</span>
                      </div>
                    </td>
                  </tr>

                  <tr className="border-b hover:bg-gray-50">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Views</td>
                    {selectedProperties.map((property, index) => {
                      const views = selectedProperties.map(p => p.views);
                      return (
                        <td
                          key={property.id}
                          className={`p-4 text-center ${getComparisonClass(views, index, true)}`}
                        >
                          {property.views}
                        </td>
                      );
                    })}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  <tr className="border-b hover:bg-gray-50">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Saves</td>
                    {selectedProperties.map((property, index) => {
                      const saves = selectedProperties.map(p => p.saves);
                      return (
                        <td
                          key={property.id}
                          className={`p-4 text-center ${getComparisonClass(saves, index, true)}`}
                        >
                          {property.saves}
                        </td>
                      );
                    })}
                    {selectedProperties.length < 4 && <td />}
                  </tr>

                  <tr className="hover:bg-gray-50">
                    <td className="p-4 font-medium text-gray-600 bg-gray-50">Listed</td>
                    {selectedProperties.map((property) => (
                      <td key={property.id} className="p-4 text-center text-gray-600">
                        {formatDate(property.listedDate)}
                      </td>
                    ))}
                    {selectedProperties.length < 4 && <td />}
                  </tr>
                </tbody>

                {/* Actions */}
                <tfoot>
                  <tr className="bg-gray-50 border-t">
                    <td className="p-4 font-medium text-gray-600">Actions</td>
                    {selectedProperties.map((property) => (
                      <td key={property.id} className="p-4">
                        <div className="flex flex-col gap-2">
                          <Link
                            href={`/property/${property.id}`}
                            className="w-full py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg text-center hover:shadow-lg transition-all text-sm"
                          >
                            View Details
                          </Link>
                          <button className="w-full py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm">
                            Schedule Visit
                          </button>
                        </div>
                      </td>
                    ))}
                    {selectedProperties.length < 4 && <td />}
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        )}
      </div>

      {/* Add Property Modal */}
      <AnimatePresence>
        {showAddModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowAddModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              className="bg-white rounded-xl max-w-lg w-full max-h-[80vh] overflow-hidden"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="p-6 border-b">
                <div className="flex items-center justify-between">
                  <h2 className="text-xl font-semibold text-gray-900">Add Property to Compare</h2>
                  <button
                    onClick={() => setShowAddModal(false)}
                    className="text-gray-400 hover:text-gray-600"
                  >
                    <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                <div className="mt-4">
                  <div className="relative">
                    <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    <input
                      type="text"
                      placeholder="Search properties..."
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                      className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                    />
                  </div>
                </div>
              </div>
              <div className="p-4 overflow-y-auto max-h-[50vh]">
                {availableToAdd.length === 0 ? (
                  <p className="text-center text-gray-500 py-8">No properties available to add</p>
                ) : (
                  <div className="space-y-3">
                    {availableToAdd.map((property) => (
                      <motion.div
                        key={property.id}
                        whileHover={{ scale: 1.02 }}
                        className="p-4 border rounded-lg hover:border-orange-300 hover:bg-orange-50/50 cursor-pointer transition-colors"
                        onClick={() => addProperty(property)}
                      >
                        <div className="flex items-center gap-4">
                          <div className="w-16 h-16 bg-gradient-to-br from-orange-100 to-amber-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <svg className="w-8 h-8 text-orange-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                            </svg>
                          </div>
                          <div className="flex-1 min-w-0">
                            <h3 className="font-semibold text-gray-900 truncate">{property.title}</h3>
                            <p className="text-sm text-gray-500">{property.city}, {property.state}</p>
                            <div className="flex items-center gap-4 mt-1">
                              <span className="text-orange-600 font-semibold">{formatPrice(property.price)}</span>
                              <span className="text-xs text-gray-500">
                                {property.bedrooms} BHK • {property.area.toLocaleString()} {property.areaUnit}
                              </span>
                            </div>
                          </div>
                          <div className="flex items-center gap-2">
                            <span className={`text-sm ${getVastuScoreColor(property.vastu.overall)}`}>
                              🕉️ {property.vastu.overall}%
                            </span>
                          </div>
                        </div>
                      </motion.div>
                    ))}
                  </div>
                )}
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import { useSearchParams } from 'next/navigation';

interface PaymentMethod {
  id: string;
  type: 'CARD' | 'UPI' | 'NETBANKING';
  last4?: string;
  brand?: string;
  upiId?: string;
  bankName?: string;
  isDefault: boolean;
}

interface PlanDetails {
  id: string;
  name: string;
  price: number;
  billingPeriod: 'MONTHLY' | 'YEARLY';
  features: string[];
}

interface PropertyBooking {
  propertyId: string;
  propertyTitle: string;
  propertyAddress: string;
  bookingType: 'TOKEN' | 'DOWN_PAYMENT' | 'FULL_PAYMENT';
  amount: number;
}

interface OrderSummary {
  type: 'SUBSCRIPTION' | 'PROPERTY_BOOKING' | 'SERVICE';
  plan?: PlanDetails;
  propertyBooking?: PropertyBooking;
  serviceName?: string;
  servicePrice?: number;
  subtotal: number;
  tax: number;
  discount: number;
  total: number;
}

const mockPaymentMethods: PaymentMethod[] = [
  {
    id: '1',
    type: 'CARD',
    last4: '4242',
    brand: 'Visa',
    isDefault: true,
  },
  {
    id: '2',
    type: 'UPI',
    upiId: 'user@okicici',
    isDefault: false,
  },
];

const plans: Record<string, PlanDetails> = {
  basic: {
    id: 'basic',
    name: 'Basic Plan',
    price: 499,
    billingPeriod: 'MONTHLY',
    features: ['25 Favorite Properties', '10 Saved Searches', 'Unlimited Messages', '10 Vastu Analyses'],
  },
  premium: {
    id: 'premium',
    name: 'Premium Plan',
    price: 999,
    billingPeriod: 'MONTHLY',
    features: ['Unlimited Favorites', 'Unlimited Searches', 'Jyotish Reports', 'Muhurat Calculations', 'Dedicated Support'],
  },
  agent: {
    id: 'agent',
    name: 'Agent Pro',
    price: 2999,
    billingPeriod: 'MONTHLY',
    features: ['All Premium Features', 'List Properties', 'CRM Access', 'Analytics Dashboard', 'Blockchain Integration'],
  },
};

export default function CheckoutPage() {
  const searchParams = useSearchParams();
  const [loading, setLoading] = useState(true);
  const [processing, setProcessing] = useState(false);
  const [paymentMethods, setPaymentMethods] = useState<PaymentMethod[]>([]);
  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState<string>('');
  const [showAddPayment, setShowAddPayment] = useState(false);
  const [orderSummary, setOrderSummary] = useState<OrderSummary | null>(null);
  const [paymentSuccess, setPaymentSuccess] = useState(false);
  const [promoCode, setPromoCode] = useState('');
  const [promoApplied, setPromoApplied] = useState(false);
  const [promoError, setPromoError] = useState('');
  
  // New payment form
  const [newPaymentType, setNewPaymentType] = useState<'CARD' | 'UPI' | 'NETBANKING'>('CARD');
  const [cardNumber, setCardNumber] = useState('');
  const [cardExpiry, setCardExpiry] = useState('');
  const [cardCvv, setCardCvv] = useState('');
  const [cardName, setCardName] = useState('');
  const [upiId, setUpiId] = useState('');
  const [selectedBank, setSelectedBank] = useState('');
  const [savePaymentMethod, setSavePaymentMethod] = useState(true);

  useEffect(() => {
    // Simulate loading
    const loadData = async () => {
      await new Promise(resolve => setTimeout(resolve, 500));
      
      setPaymentMethods(mockPaymentMethods);
      setSelectedPaymentMethod(mockPaymentMethods.find(pm => pm.isDefault)?.id || '');
      
      // Parse order from URL params
      const planId = searchParams.get('plan');
      const propertyId = searchParams.get('property');
      const bookingType = searchParams.get('bookingType');
      const serviceType = searchParams.get('service');
      
      let summary: OrderSummary;
      
      if (planId && plans[planId]) {
        const plan = plans[planId];
        const subtotal = plan.price;
        const tax = Math.round(subtotal * 0.18);
        summary = {
          type: 'SUBSCRIPTION',
          plan,
          subtotal,
          tax,
          discount: 0,
          total: subtotal + tax,
        };
      } else if (propertyId) {
        const amount = parseInt(searchParams.get('amount') || '100000');
        const subtotal = amount;
        const tax = Math.round(subtotal * 0.01); // 1% stamp duty approximation
        summary = {
          type: 'PROPERTY_BOOKING',
          propertyBooking: {
            propertyId,
            propertyTitle: 'Serene Valley Villa',
            propertyAddress: '123 Green Valley Road, Bangalore',
            bookingType: (bookingType as 'TOKEN' | 'DOWN_PAYMENT' | 'FULL_PAYMENT') || 'TOKEN',
            amount,
          },
          subtotal,
          tax,
          discount: 0,
          total: subtotal + tax,
        };
      } else {
        // Default to basic plan
        const plan = plans.basic;
        const subtotal = plan.price;
        const tax = Math.round(subtotal * 0.18);
        summary = {
          type: 'SUBSCRIPTION',
          plan,
          subtotal,
          tax,
          discount: 0,
          total: subtotal + tax,
        };
      }
      
      setOrderSummary(summary);
      setLoading(false);
    };
    
    loadData();
  }, [searchParams]);

  const formatPrice = (price: number) => {
    if (price >= 10000000) {
      return `₹${(price / 10000000).toFixed(2)} Cr`;
    } else if (price >= 100000) {
      return `₹${(price / 100000).toFixed(2)} L`;
    }
    return `₹${price.toLocaleString()}`;
  };

  const applyPromoCode = () => {
    if (!orderSummary) return;
    
    if (promoCode.toUpperCase() === 'DHARMA20') {
      const discount = Math.round(orderSummary.subtotal * 0.2);
      setOrderSummary({
        ...orderSummary,
        discount,
        total: orderSummary.subtotal + orderSummary.tax - discount,
      });
      setPromoApplied(true);
      setPromoError('');
    } else if (promoCode.toUpperCase() === 'FIRST50') {
      const discount = 50;
      setOrderSummary({
        ...orderSummary,
        discount,
        total: orderSummary.subtotal + orderSummary.tax - discount,
      });
      setPromoApplied(true);
      setPromoError('');
    } else {
      setPromoError('Invalid promo code');
    }
  };

  const removePromoCode = () => {
    if (!orderSummary) return;
    setOrderSummary({
      ...orderSummary,
      discount: 0,
      total: orderSummary.subtotal + orderSummary.tax,
    });
    setPromoApplied(false);
    setPromoCode('');
  };

  const formatCardNumber = (value: string) => {
    const cleaned = value.replace(/\D/g, '');
    const groups = cleaned.match(/.{1,4}/g) || [];
    return groups.join(' ').substr(0, 19);
  };

  const formatExpiry = (value: string) => {
    const cleaned = value.replace(/\D/g, '');
    if (cleaned.length >= 2) {
      return cleaned.slice(0, 2) + '/' + cleaned.slice(2, 4);
    }
    return cleaned;
  };

  const handlePayment = async () => {
    if (!selectedPaymentMethod && !showAddPayment) {
      setShowAddPayment(true);
      return;
    }
    
    setProcessing(true);
    
    // Simulate payment processing
    await new Promise(resolve => setTimeout(resolve, 2500));
    
    setProcessing(false);
    setPaymentSuccess(true);
  };

  const getPaymentMethodIcon = (type: string) => {
    switch (type) {
      case 'CARD':
        return (
          <svg className="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z" />
          </svg>
        );
      case 'UPI':
        return (
          <svg className="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
          </svg>
        );
      case 'NETBANKING':
        return (
          <svg className="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
            <path d="M4 10v7h3v-7H4zm6 0v7h3v-7h-3zM2 22h19v-3H2v3zm14-12v7h3v-7h-3zm-4.5-9L2 6v2h19V6l-9.5-5z" />
          </svg>
        );
      default:
        return null;
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4" />
          <p className="text-gray-600">Loading checkout...</p>
        </div>
      </div>
    );
  }

  if (paymentSuccess) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
        <motion.div
          initial={{ scale: 0.9, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center"
        >
          <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <motion.svg
              initial={{ scale: 0 }}
              animate={{ scale: 1 }}
              transition={{ delay: 0.2, type: 'spring' }}
              className="w-10 h-10 text-green-500"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" />
            </motion.svg>
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Payment Successful!</h1>
          <p className="text-gray-600 mb-6">
            Your payment of {formatPrice(orderSummary?.total || 0)} has been processed successfully.
          </p>
          <div className="bg-gray-50 rounded-lg p-4 mb-6">
            <p className="text-sm text-gray-500">Transaction ID</p>
            <p className="font-mono text-gray-900">TXN{Date.now().toString(36).toUpperCase()}</p>
          </div>
          <p className="text-sm text-gray-500 mb-6">
            A confirmation email has been sent to your registered email address.
          </p>
          <div className="space-y-3">
            <Link
              href="/dashboard"
              className="block w-full py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:shadow-lg transition-all"
            >
              Go to Dashboard
            </Link>
            <Link
              href="/"
              className="block w-full py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
            >
              Return Home
            </Link>
          </div>
        </motion.div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Header */}
      <div className="bg-white border-b">
        <div className="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <div className="flex items-center gap-4">
            <Link href="/" className="text-gray-600 hover:text-gray-900">
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
              </svg>
            </Link>
            <div className="flex items-center gap-2">
              <div className="w-10 h-10 bg-gradient-to-r from-orange-500 to-amber-500 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-lg">ॐ</span>
              </div>
              <span className="text-xl font-bold text-gray-900">Checkout</span>
            </div>
          </div>
        </div>
      </div>

      <div className="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div className="grid lg:grid-cols-3 gap-8">
          {/* Payment Form */}
          <div className="lg:col-span-2 space-y-6">
            {/* Order Type Banner */}
            <div className={`p-4 rounded-xl ${
              orderSummary?.type === 'SUBSCRIPTION' 
                ? 'bg-gradient-to-r from-orange-100 to-amber-100 border border-orange-200'
                : 'bg-gradient-to-r from-green-100 to-teal-100 border border-green-200'
            }`}>
              <div className="flex items-center gap-3">
                {orderSummary?.type === 'SUBSCRIPTION' ? (
                  <>
                    <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center">
                      <svg className="w-6 h-6 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                      </svg>
                    </div>
                    <div>
                      <h3 className="font-semibold text-gray-900">{orderSummary.plan?.name}</h3>
                      <p className="text-sm text-gray-600">
                        {orderSummary.plan?.billingPeriod === 'MONTHLY' ? 'Monthly' : 'Yearly'} Subscription
                      </p>
                    </div>
                  </>
                ) : (
                  <>
                    <div className="w-12 h-12 bg-white rounded-full flex items-center justify-center">
                      <svg className="w-6 h-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                      </svg>
                    </div>
                    <div>
                      <h3 className="font-semibold text-gray-900">{orderSummary?.propertyBooking?.propertyTitle}</h3>
                      <p className="text-sm text-gray-600">
                        {orderSummary?.propertyBooking?.bookingType === 'TOKEN' && 'Token Amount'}
                        {orderSummary?.propertyBooking?.bookingType === 'DOWN_PAYMENT' && 'Down Payment'}
                        {orderSummary?.propertyBooking?.bookingType === 'FULL_PAYMENT' && 'Full Payment'}
                      </p>
                    </div>
                  </>
                )}
              </div>
            </div>

            {/* Saved Payment Methods */}
            <div className="bg-white rounded-xl shadow-sm border p-6">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">Payment Method</h2>
              
              {paymentMethods.length > 0 && (
                <div className="space-y-3 mb-4">
                  {paymentMethods.map((method) => (
                    <label
                      key={method.id}
                      className={`flex items-center gap-4 p-4 border rounded-lg cursor-pointer transition-colors ${
                        selectedPaymentMethod === method.id
                          ? 'border-orange-500 bg-orange-50'
                          : 'border-gray-200 hover:border-gray-300'
                      }`}
                    >
                      <input
                        type="radio"
                        name="paymentMethod"
                        value={method.id}
                        checked={selectedPaymentMethod === method.id}
                        onChange={(e) => {
                          setSelectedPaymentMethod(e.target.value);
                          setShowAddPayment(false);
                        }}
                        className="w-4 h-4 text-orange-500 focus:ring-orange-500"
                      />
                      <div className="text-gray-600">
                        {getPaymentMethodIcon(method.type)}
                      </div>
                      <div className="flex-1">
                        {method.type === 'CARD' && (
                          <>
                            <p className="font-medium text-gray-900">{method.brand} •••• {method.last4}</p>
                            <p className="text-sm text-gray-500">Credit/Debit Card</p>
                          </>
                        )}
                        {method.type === 'UPI' && (
                          <>
                            <p className="font-medium text-gray-900">{method.upiId}</p>
                            <p className="text-sm text-gray-500">UPI</p>
                          </>
                        )}
                        {method.type === 'NETBANKING' && (
                          <>
                            <p className="font-medium text-gray-900">{method.bankName}</p>
                            <p className="text-sm text-gray-500">Net Banking</p>
                          </>
                        )}
                      </div>
                      {method.isDefault && (
                        <span className="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded">Default</span>
                      )}
                    </label>
                  ))}
                </div>
              )}

              {/* Add New Payment */}
              <button
                onClick={() => {
                  setShowAddPayment(!showAddPayment);
                  setSelectedPaymentMethod('');
                }}
                className={`w-full flex items-center justify-center gap-2 p-4 border-2 border-dashed rounded-lg transition-colors ${
                  showAddPayment
                    ? 'border-orange-500 bg-orange-50 text-orange-600'
                    : 'border-gray-300 text-gray-600 hover:border-gray-400'
                }`}
              >
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                </svg>
                Add New Payment Method
              </button>

              {/* New Payment Form */}
              <AnimatePresence>
                {showAddPayment && (
                  <motion.div
                    initial={{ height: 0, opacity: 0 }}
                    animate={{ height: 'auto', opacity: 1 }}
                    exit={{ height: 0, opacity: 0 }}
                    className="overflow-hidden"
                  >
                    <div className="pt-6 space-y-4">
                      {/* Payment Type Tabs */}
                      <div className="flex gap-2 p-1 bg-gray-100 rounded-lg">
                        {(['CARD', 'UPI', 'NETBANKING'] as const).map((type) => (
                          <button
                            key={type}
                            onClick={() => setNewPaymentType(type)}
                            className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${
                              newPaymentType === type
                                ? 'bg-white text-gray-900 shadow-sm'
                                : 'text-gray-600 hover:text-gray-900'
                            }`}
                          >
                            {type === 'CARD' && 'Card'}
                            {type === 'UPI' && 'UPI'}
                            {type === 'NETBANKING' && 'Net Banking'}
                          </button>
                        ))}
                      </div>

                      {/* Card Form */}
                      {newPaymentType === 'CARD' && (
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                              Card Number
                            </label>
                            <input
                              type="text"
                              value={cardNumber}
                              onChange={(e) => setCardNumber(formatCardNumber(e.target.value))}
                              placeholder="1234 5678 9012 3456"
                              maxLength={19}
                              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                            />
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                              Cardholder Name
                            </label>
                            <input
                              type="text"
                              value={cardName}
                              onChange={(e) => setCardName(e.target.value)}
                              placeholder="John Doe"
                              className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                            />
                          </div>
                          <div className="grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-sm font-medium text-gray-700 mb-1">
                                Expiry Date
                              </label>
                              <input
                                type="text"
                                value={cardExpiry}
                                onChange={(e) => setCardExpiry(formatExpiry(e.target.value))}
                                placeholder="MM/YY"
                                maxLength={5}
                                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                              />
                            </div>
                            <div>
                              <label className="block text-sm font-medium text-gray-700 mb-1">
                                CVV
                              </label>
                              <input
                                type="password"
                                value={cardCvv}
                                onChange={(e) => setCardCvv(e.target.value.replace(/\D/g, '').slice(0, 4))}
                                placeholder="•••"
                                maxLength={4}
                                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                              />
                            </div>
                          </div>
                        </div>
                      )}

                      {/* UPI Form */}
                      {newPaymentType === 'UPI' && (
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">
                            UPI ID
                          </label>
                          <input
                            type="text"
                            value={upiId}
                            onChange={(e) => setUpiId(e.target.value)}
                            placeholder="yourname@upi"
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                          />
                          <p className="text-sm text-gray-500 mt-1">
                            Enter your UPI ID linked to any UPI app
                          </p>
                        </div>
                      )}

                      {/* Net Banking Form */}
                      {newPaymentType === 'NETBANKING' && (
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">
                            Select Bank
                          </label>
                          <select
                            value={selectedBank}
                            onChange={(e) => setSelectedBank(e.target.value)}
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                          >
                            <option value="">Choose your bank</option>
                            <option value="sbi">State Bank of India</option>
                            <option value="hdfc">HDFC Bank</option>
                            <option value="icici">ICICI Bank</option>
                            <option value="axis">Axis Bank</option>
                            <option value="kotak">Kotak Mahindra Bank</option>
                            <option value="pnb">Punjab National Bank</option>
                            <option value="bob">Bank of Baroda</option>
                            <option value="idbi">IDBI Bank</option>
                          </select>
                          <p className="text-sm text-gray-500 mt-1">
                            You will be redirected to your bank's website
                          </p>
                        </div>
                      )}

                      {/* Save Payment Method */}
                      <label className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          checked={savePaymentMethod}
                          onChange={(e) => setSavePaymentMethod(e.target.checked)}
                          className="w-4 h-4 rounded text-orange-500 focus:ring-orange-500"
                        />
                        <span className="text-sm text-gray-600">
                          Save this payment method for future transactions
                        </span>
                      </label>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>

            {/* Promo Code */}
            <div className="bg-white rounded-xl shadow-sm border p-6">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">Promo Code</h2>
              {promoApplied ? (
                <div className="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg">
                  <div className="flex items-center gap-2">
                    <svg className="w-5 h-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                    </svg>
                    <span className="font-medium text-green-700">{promoCode.toUpperCase()}</span>
                    <span className="text-green-600">- {formatPrice(orderSummary?.discount || 0)} off</span>
                  </div>
                  <button
                    onClick={removePromoCode}
                    className="text-gray-400 hover:text-gray-600"
                  >
                    <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              ) : (
                <div className="flex gap-2">
                  <input
                    type="text"
                    value={promoCode}
                    onChange={(e) => {
                      setPromoCode(e.target.value);
                      setPromoError('');
                    }}
                    placeholder="Enter promo code"
                    className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                  />
                  <button
                    onClick={applyPromoCode}
                    disabled={!promoCode}
                    className="px-6 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
                  >
                    Apply
                  </button>
                </div>
              )}
              {promoError && (
                <p className="text-sm text-red-500 mt-2">{promoError}</p>
              )}
              <p className="text-sm text-gray-500 mt-2">
                Try: DHARMA20 for 20% off
              </p>
            </div>

            {/* Security Info */}
            <div className="flex items-center gap-4 p-4 bg-green-50 border border-green-200 rounded-lg">
              <svg className="w-8 h-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
              <div>
                <p className="font-medium text-green-900">Secure Payment</p>
                <p className="text-sm text-green-700">
                  Your payment information is encrypted and secure. We never store your full card details.
                </p>
              </div>
            </div>
          </div>

          {/* Order Summary */}
          <div className="lg:col-span-1">
            <div className="bg-white rounded-xl shadow-sm border p-6 sticky top-24">
              <h2 className="text-lg font-semibold text-gray-900 mb-4">Order Summary</h2>
              
              {orderSummary?.type === 'SUBSCRIPTION' && orderSummary.plan && (
                <div className="mb-4 pb-4 border-b">
                  <h3 className="font-medium text-gray-900">{orderSummary.plan.name}</h3>
                  <ul className="mt-2 space-y-1">
                    {orderSummary.plan.features.slice(0, 3).map((feature, i) => (
                      <li key={i} className="text-sm text-gray-600 flex items-center gap-2">
                        <svg className="w-4 h-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                        </svg>
                        {feature}
                      </li>
                    ))}
                    {orderSummary.plan.features.length > 3 && (
                      <li className="text-sm text-gray-500">
                        +{orderSummary.plan.features.length - 3} more features
                      </li>
                    )}
                  </ul>
                </div>
              )}

              {orderSummary?.type === 'PROPERTY_BOOKING' && orderSummary.propertyBooking && (
                <div className="mb-4 pb-4 border-b">
                  <h3 className="font-medium text-gray-900">{orderSummary.propertyBooking.propertyTitle}</h3>
                  <p className="text-sm text-gray-500">{orderSummary.propertyBooking.propertyAddress}</p>
                  <p className="text-sm text-gray-600 mt-2">
                    {orderSummary.propertyBooking.bookingType === 'TOKEN' && 'Token Booking Amount'}
                    {orderSummary.propertyBooking.bookingType === 'DOWN_PAYMENT' && 'Down Payment (10%)'}
                    {orderSummary.propertyBooking.bookingType === 'FULL_PAYMENT' && 'Full Payment'}
                  </p>
                </div>
              )}

              <div className="space-y-3">
                <div className="flex justify-between text-gray-600">
                  <span>Subtotal</span>
                  <span>{formatPrice(orderSummary?.subtotal || 0)}</span>
                </div>
                <div className="flex justify-between text-gray-600">
                  <span>Tax (GST)</span>
                  <span>{formatPrice(orderSummary?.tax || 0)}</span>
                </div>
                {(orderSummary?.discount || 0) > 0 && (
                  <div className="flex justify-between text-green-600">
                    <span>Discount</span>
                    <span>-{formatPrice(orderSummary?.discount || 0)}</span>
                  </div>
                )}
                <div className="pt-3 border-t">
                  <div className="flex justify-between">
                    <span className="text-lg font-semibold text-gray-900">Total</span>
                    <span className="text-lg font-bold text-gray-900">
                      {formatPrice(orderSummary?.total || 0)}
                    </span>
                  </div>
                </div>
              </div>

              <button
                onClick={handlePayment}
                disabled={processing}
                className="w-full mt-6 py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:shadow-lg transition-all disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2"
              >
                {processing ? (
                  <>
                    <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin" />
                    Processing...
                  </>
                ) : (
                  <>
                    <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                    </svg>
                    Pay {formatPrice(orderSummary?.total || 0)}
                  </>
                )}
              </button>

              <p className="text-xs text-gray-500 text-center mt-4">
                By completing this payment, you agree to our{' '}
                <Link href="/terms" className="text-orange-500 hover:underline">Terms of Service</Link>
                {' '}and{' '}
                <Link href="/privacy" className="text-orange-500 hover:underline">Privacy Policy</Link>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
'use client';

import { useState, useEffect, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import { useSearchParams } from 'next/navigation';

interface Participant {
  id: string;
  name: string;
  role: 'HOST' | 'GUEST';
  avatar?: string;
  isMuted: boolean;
  isVideoOff: boolean;
  isScreenSharing: boolean;
  isSpeaking: boolean;
}

interface ChatMessage {
  id: string;
  senderId: string;
  senderName: string;
  message: string;
  timestamp: Date;
}

interface CallInfo {
  id: string;
  propertyId: string;
  propertyTitle: string;
  propertyAddress: string;
  agentName: string;
  agentAvatar?: string;
  scheduledTime?: Date;
  duration: number;
}

export default function VideoCallPage() {
  const searchParams = useSearchParams();
  const [callState, setCallState] = useState<'WAITING' | 'CONNECTING' | 'CONNECTED' | 'ENDED'>('WAITING');
  const [isMuted, setIsMuted] = useState(false);
  const [isVideoOff, setIsVideoOff] = useState(false);
  const [isScreenSharing, setIsScreenSharing] = useState(false);
  const [showChat, setShowChat] = useState(false);
  const [showParticipants, setShowParticipants] = useState(false);
  const [showSettings, setShowSettings] = useState(false);
  const [isFullscreen, setIsFullscreen] = useState(false);
  const [callDuration, setCallDuration] = useState(0);
  const [messages, setMessages] = useState<ChatMessage[]>([]);
  const [newMessage, setNewMessage] = useState('');
  const [selectedCamera, setSelectedCamera] = useState('default');
  const [selectedMicrophone, setSelectedMicrophone] = useState('default');
  const [selectedSpeaker, setSelectedSpeaker] = useState('default');
  
  const videoContainerRef = useRef<HTMLDivElement>(null);
  const chatContainerRef = useRef<HTMLDivElement>(null);

  const [callInfo] = useState<CallInfo>({
    id: searchParams.get('id') || 'call-123',
    propertyId: searchParams.get('property') || 'prop-1',
    propertyTitle: 'Serene Valley Villa',
    propertyAddress: '123 Green Valley Road, Bangalore',
    agentName: 'Priya Sharma',
    agentAvatar: '',
    duration: 0,
  });

  const [participants, setParticipants] = useState<Participant[]>([
    {
      id: 'user-1',
      name: 'You',
      role: 'GUEST',
      isMuted: false,
      isVideoOff: false,
      isScreenSharing: false,
      isSpeaking: false,
    },
  ]);

  // Simulate call timer
  useEffect(() => {
    let interval: NodeJS.Timeout;
    if (callState === 'CONNECTED') {
      interval = setInterval(() => {
        setCallDuration(prev => prev + 1);
      }, 1000);
    }
    return () => clearInterval(interval);
  }, [callState]);

  // Simulate participant joining
  useEffect(() => {
    if (callState === 'CONNECTING') {
      const timer = setTimeout(() => {
        setParticipants(prev => [
          ...prev,
          {
            id: 'agent-1',
            name: callInfo.agentName,
            role: 'HOST',
            isMuted: false,
            isVideoOff: false,
            isScreenSharing: false,
            isSpeaking: false,
          },
        ]);
        setCallState('CONNECTED');
        
        // Add welcome message
        setMessages([{
          id: '1',
          senderId: 'agent-1',
          senderName: callInfo.agentName,
          message: `Hello! Thank you for joining the virtual tour for ${callInfo.propertyTitle}. How can I help you today?`,
          timestamp: new Date(),
        }]);
      }, 2000);
      return () => clearTimeout(timer);
    }
  }, [callState, callInfo]);

  // Scroll chat to bottom
  useEffect(() => {
    if (chatContainerRef.current) {
      chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
    }
  }, [messages]);

  const formatDuration = (seconds: number) => {
    const hrs = Math.floor(seconds / 3600);
    const mins = Math.floor((seconds % 3600) / 60);
    const secs = seconds % 60;
    if (hrs > 0) {
      return `${hrs}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  };

  const joinCall = () => {
    setCallState('CONNECTING');
  };

  const endCall = () => {
    setCallState('ENDED');
  };

  const toggleMute = () => {
    setIsMuted(!isMuted);
    setParticipants(prev =>
      prev.map(p => (p.id === 'user-1' ? { ...p, isMuted: !isMuted } : p))
    );
  };

  const toggleVideo = () => {
    setIsVideoOff(!isVideoOff);
    setParticipants(prev =>
      prev.map(p => (p.id === 'user-1' ? { ...p, isVideoOff: !isVideoOff } : p))
    );
  };

  const toggleScreenShare = () => {
    setIsScreenSharing(!isScreenSharing);
    setParticipants(prev =>
      prev.map(p => (p.id === 'user-1' ? { ...p, isScreenSharing: !isScreenSharing } : p))
    );
  };

  const toggleFullscreen = async () => {
    if (!document.fullscreenElement) {
      await videoContainerRef.current?.requestFullscreen();
      setIsFullscreen(true);
    } else {
      await document.exitFullscreen();
      setIsFullscreen(false);
    }
  };

  const sendMessage = () => {
    if (!newMessage.trim()) return;
    
    setMessages(prev => [
      ...prev,
      {
        id: Date.now().toString(),
        senderId: 'user-1',
        senderName: 'You',
        message: newMessage,
        timestamp: new Date(),
      },
    ]);
    setNewMessage('');

    // Simulate agent response
    setTimeout(() => {
      const responses = [
        'That\'s a great question! Let me show you that area.',
        'Yes, the property has excellent natural lighting throughout the day.',
        'The neighborhood is very peaceful with good schools nearby.',
        'I can schedule an in-person visit if you\'d like to see it yourself.',
        'The Vastu compliance for this property is excellent, especially for the master bedroom.',
      ];
      setMessages(prev => [
        ...prev,
        {
          id: (Date.now() + 1).toString(),
          senderId: 'agent-1',
          senderName: callInfo.agentName,
          message: responses[Math.floor(Math.random() * responses.length)],
          timestamp: new Date(),
        },
      ]);
    }, 1500);
  };

  // Waiting Room
  if (callState === 'WAITING') {
    return (
      <div className="min-h-screen bg-gray-900 flex items-center justify-center p-4">
        <motion.div
          initial={{ scale: 0.95, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="bg-gray-800 rounded-2xl p-8 max-w-md w-full"
        >
          <div className="text-center mb-8">
            <div className="w-20 h-20 bg-gradient-to-r from-orange-500 to-amber-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <svg className="w-10 h-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
            </div>
            <h1 className="text-2xl font-bold text-white mb-2">Virtual Property Tour</h1>
            <p className="text-gray-400">{callInfo.propertyTitle}</p>
          </div>

          {/* Preview Video */}
          <div className="relative aspect-video bg-gray-700 rounded-lg mb-6 overflow-hidden">
            <div className="absolute inset-0 flex items-center justify-center">
              {isVideoOff ? (
                <div className="w-20 h-20 bg-gray-600 rounded-full flex items-center justify-center">
                  <span className="text-2xl text-white font-semibold">Y</span>
                </div>
              ) : (
                <div className="text-gray-400 text-sm">Camera preview</div>
              )}
            </div>
            {isMuted && (
              <div className="absolute bottom-3 left-3 px-2 py-1 bg-red-500 rounded text-white text-xs flex items-center gap-1">
                <svg className="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clipRule="evenodd" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
                </svg>
                Muted
              </div>
            )}
          </div>

          {/* Controls */}
          <div className="flex justify-center gap-4 mb-8">
            <button
              onClick={toggleMute}
              className={`w-14 h-14 rounded-full flex items-center justify-center transition-colors ${
                isMuted ? 'bg-red-500 text-white' : 'bg-gray-700 text-white hover:bg-gray-600'
              }`}
            >
              {isMuted ? (
                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clipRule="evenodd" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
                </svg>
              ) : (
                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                </svg>
              )}
            </button>
            <button
              onClick={toggleVideo}
              className={`w-14 h-14 rounded-full flex items-center justify-center transition-colors ${
                isVideoOff ? 'bg-red-500 text-white' : 'bg-gray-700 text-white hover:bg-gray-600'
              }`}
            >
              {isVideoOff ? (
                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3l18 18" />
                </svg>
              ) : (
                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
              )}
            </button>
            <button
              onClick={() => setShowSettings(true)}
              className="w-14 h-14 bg-gray-700 text-white rounded-full flex items-center justify-center hover:bg-gray-600 transition-colors"
            >
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </button>
          </div>

          {/* Join Button */}
          <button
            onClick={joinCall}
            className="w-full py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-xl font-semibold hover:shadow-lg transition-all text-lg"
          >
            Join Tour
          </button>

          <Link
            href="/dashboard"
            className="block text-center text-gray-400 hover:text-white mt-4 transition-colors"
          >
            Cancel and return to dashboard
          </Link>
        </motion.div>

        {/* Settings Modal */}
        <AnimatePresence>
          {showSettings && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4"
              onClick={() => setShowSettings(false)}
            >
              <motion.div
                initial={{ scale: 0.95, opacity: 0 }}
                animate={{ scale: 1, opacity: 1 }}
                exit={{ scale: 0.95, opacity: 0 }}
                className="bg-gray-800 rounded-xl max-w-md w-full p-6"
                onClick={(e) => e.stopPropagation()}
              >
                <div className="flex items-center justify-between mb-6">
                  <h2 className="text-xl font-semibold text-white">Settings</h2>
                  <button onClick={() => setShowSettings(false)} className="text-gray-400 hover:text-white">
                    <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>

                <div className="space-y-4">
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">Camera</label>
                    <select
                      value={selectedCamera}
                      onChange={(e) => setSelectedCamera(e.target.value)}
                      className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500"
                    >
                      <option value="default">Default Camera</option>
                      <option value="front">Front Camera</option>
                      <option value="back">Back Camera</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">Microphone</label>
                    <select
                      value={selectedMicrophone}
                      onChange={(e) => setSelectedMicrophone(e.target.value)}
                      className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500"
                    >
                      <option value="default">Default Microphone</option>
                      <option value="headset">Headset Microphone</option>
                      <option value="external">External Microphone</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm text-gray-400 mb-2">Speaker</label>
                    <select
                      value={selectedSpeaker}
                      onChange={(e) => setSelectedSpeaker(e.target.value)}
                      className="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500"
                    >
                      <option value="default">Default Speaker</option>
                      <option value="headphones">Headphones</option>
                      <option value="external">External Speaker</option>
                    </select>
                  </div>
                </div>
              </motion.div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    );
  }

  // Connecting State
  if (callState === 'CONNECTING') {
    return (
      <div className="min-h-screen bg-gray-900 flex items-center justify-center">
        <motion.div
          initial={{ scale: 0.95, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="text-center"
        >
          <div className="w-24 h-24 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-6" />
          <h2 className="text-xl font-semibold text-white mb-2">Connecting...</h2>
          <p className="text-gray-400">Waiting for {callInfo.agentName} to join</p>
        </motion.div>
      </div>
    );
  }

  // Call Ended State
  if (callState === 'ENDED') {
    return (
      <div className="min-h-screen bg-gray-900 flex items-center justify-center p-4">
        <motion.div
          initial={{ scale: 0.95, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="bg-gray-800 rounded-2xl p-8 max-w-md w-full text-center"
        >
          <div className="w-20 h-20 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-6">
            <svg className="w-10 h-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.517l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z" />
            </svg>
          </div>
          <h1 className="text-2xl font-bold text-white mb-2">Tour Ended</h1>
          <p className="text-gray-400 mb-4">Duration: {formatDuration(callDuration)}</p>
          
          <div className="bg-gray-700 rounded-lg p-4 mb-6">
            <h3 className="font-medium text-white mb-1">{callInfo.propertyTitle}</h3>
            <p className="text-sm text-gray-400">{callInfo.propertyAddress}</p>
          </div>

          <div className="space-y-3">
            <Link
              href={`/property/${callInfo.propertyId}`}
              className="block w-full py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:shadow-lg transition-all"
            >
              View Property Details
            </Link>
            <Link
              href="/dashboard/showings"
              className="block w-full py-3 border border-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
            >
              Schedule In-Person Visit
            </Link>
            <Link
              href="/dashboard"
              className="block w-full py-3 text-gray-400 hover:text-white transition-colors"
            >
              Return to Dashboard
            </Link>
          </div>
        </motion.div>
      </div>
    );
  }

  // Connected - Main Call Interface
  return (
    <div ref={videoContainerRef} className="h-screen bg-gray-900 flex flex-col">
      {/* Header */}
      <div className="absolute top-0 left-0 right-0 z-30 p-4 bg-gradient-to-b from-black/60 to-transparent">
        <div className="flex items-center justify-between max-w-7xl mx-auto">
          <div className="flex items-center gap-3">
            <div className="w-10 h-10 bg-gradient-to-r from-orange-500 to-amber-500 rounded-lg flex items-center justify-center">
              <span className="text-white font-bold">ॐ</span>
            </div>
            <div>
              <h1 className="text-white font-medium">{callInfo.propertyTitle}</h1>
              <p className="text-gray-300 text-sm">{callInfo.propertyAddress}</p>
            </div>
          </div>
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-2 px-3 py-1.5 bg-red-500 rounded-full">
              <div className="w-2 h-2 bg-white rounded-full animate-pulse" />
              <span className="text-white text-sm font-medium">{formatDuration(callDuration)}</span>
            </div>
            <button
              onClick={toggleFullscreen}
              className="w-10 h-10 bg-white/10 rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-colors"
            >
              {isFullscreen ? (
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 9V5a2 2 0 012-2h2M15 9V5a2 2 0 00-2-2h-2M9 15v4a2 2 0 002 2h2m4-6v4a2 2 0 01-2 2h-2" />
                </svg>
              ) : (
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
                </svg>
              )}
            </button>
          </div>
        </div>
      </div>

      {/* Video Area */}
      <div className="flex-1 relative">
        {/* Main Video (Agent) */}
        <div className="absolute inset-0 bg-gray-800">
          <div className="h-full flex items-center justify-center">
            {participants.find(p => p.role === 'HOST')?.isVideoOff ? (
              <div className="w-32 h-32 bg-gray-700 rounded-full flex items-center justify-center">
                <span className="text-4xl text-white font-semibold">
                  {callInfo.agentName.charAt(0)}
                </span>
              </div>
            ) : (
              <div className="text-gray-500">
                <svg className="w-24 h-24 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
                <p>{callInfo.agentName} is sharing video</p>
              </div>
            )}
          </div>
          {/* Agent name overlay */}
          <div className="absolute bottom-4 left-4">
            <div className="flex items-center gap-2 px-3 py-1.5 bg-black/50 rounded-lg">
              <span className="text-white text-sm">{callInfo.agentName}</span>
              {participants.find(p => p.role === 'HOST')?.isMuted && (
                <svg className="w-4 h-4 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clipRule="evenodd" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
                </svg>
              )}
            </div>
          </div>
        </div>

        {/* Self Video (Picture-in-Picture) */}
        <motion.div
          drag
          dragConstraints={videoContainerRef}
          className="absolute bottom-24 right-4 w-48 aspect-video bg-gray-700 rounded-lg overflow-hidden shadow-xl cursor-move z-20"
        >
          {isVideoOff ? (
            <div className="h-full flex items-center justify-center">
              <div className="w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center">
                <span className="text-lg text-white font-semibold">Y</span>
              </div>
            </div>
          ) : (
            <div className="h-full flex items-center justify-center text-gray-500 text-sm">
              Your camera
            </div>
          )}
          <div className="absolute bottom-2 left-2 flex items-center gap-1">
            <span className="text-white text-xs bg-black/50 px-2 py-0.5 rounded">You</span>
            {isMuted && (
              <svg className="w-4 h-4 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clipRule="evenodd" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
              </svg>
            )}
          </div>
        </motion.div>

        {/* Chat Panel */}
        <AnimatePresence>
          {showChat && (
            <motion.div
              initial={{ x: '100%' }}
              animate={{ x: 0 }}
              exit={{ x: '100%' }}
              transition={{ type: 'spring', damping: 25, stiffness: 200 }}
              className="absolute right-0 top-0 bottom-0 w-80 bg-gray-800 border-l border-gray-700 z-20 flex flex-col"
            >
              <div className="p-4 border-b border-gray-700 flex items-center justify-between">
                <h3 className="text-white font-medium">Chat</h3>
                <button onClick={() => setShowChat(false)} className="text-gray-400 hover:text-white">
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
              <div ref={chatContainerRef} className="flex-1 overflow-y-auto p-4 space-y-4">
                {messages.map((msg) => (
                  <div
                    key={msg.id}
                    className={`${msg.senderId === 'user-1' ? 'ml-8' : 'mr-8'}`}
                  >
                    <div
                      className={`p-3 rounded-lg ${
                        msg.senderId === 'user-1'
                          ? 'bg-orange-500 text-white'
                          : 'bg-gray-700 text-white'
                      }`}
                    >
                      {msg.senderId !== 'user-1' && (
                        <p className="text-xs text-gray-300 mb-1">{msg.senderName}</p>
                      )}
                      <p className="text-sm">{msg.message}</p>
                    </div>
                    <p className="text-xs text-gray-500 mt-1">
                      {msg.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                    </p>
                  </div>
                ))}
              </div>
              <div className="p-4 border-t border-gray-700">
                <div className="flex gap-2">
                  <input
                    type="text"
                    value={newMessage}
                    onChange={(e) => setNewMessage(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
                    placeholder="Type a message..."
                    className="flex-1 px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500"
                  />
                  <button
                    onClick={sendMessage}
                    className="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors"
                  >
                    <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                  </button>
                </div>
              </div>
            </motion.div>
          )}
        </AnimatePresence>

        {/* Participants Panel */}
        <AnimatePresence>
          {showParticipants && (
            <motion.div
              initial={{ x: '-100%' }}
              animate={{ x: 0 }}
              exit={{ x: '-100%' }}
              transition={{ type: 'spring', damping: 25, stiffness: 200 }}
              className="absolute left-0 top-0 bottom-0 w-72 bg-gray-800 border-r border-gray-700 z-20"
            >
              <div className="p-4 border-b border-gray-700 flex items-center justify-between">
                <h3 className="text-white font-medium">Participants ({participants.length})</h3>
                <button onClick={() => setShowParticipants(false)} className="text-gray-400 hover:text-white">
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
              <div className="p-4 space-y-3">
                {participants.map((participant) => (
                  <div key={participant.id} className="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-700">
                    <div className="w-10 h-10 bg-gradient-to-r from-orange-500 to-amber-500 rounded-full flex items-center justify-center">
                      <span className="text-white font-medium">
                        {participant.name.charAt(0)}
                      </span>
                    </div>
                    <div className="flex-1">
                      <p className="text-white text-sm">{participant.name}</p>
                      <p className="text-gray-400 text-xs">{participant.role === 'HOST' ? 'Agent' : 'Guest'}</p>
                    </div>
                    <div className="flex items-center gap-2">
                      {participant.isMuted && (
                        <svg className="w-4 h-4 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clipRule="evenodd" />
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
                        </svg>
                      )}
                      {participant.isVideoOff && (
                        <svg className="w-4 h-4 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3l18 18" />
                        </svg>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </motion.div>
          )}
        </AnimatePresence>
      </div>

      {/* Controls Bar */}
      <div className="absolute bottom-0 left-0 right-0 z-30 p-4 bg-gradient-to-t from-black/60 to-transparent">
        <div className="flex items-center justify-center gap-3">
          <button
            onClick={toggleMute}
            className={`w-14 h-14 rounded-full flex items-center justify-center transition-all ${
              isMuted ? 'bg-red-500 text-white' : 'bg-white/10 text-white hover:bg-white/20'
            }`}
          >
            {isMuted ? (
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clipRule="evenodd" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
              </svg>
            ) : (
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
              </svg>
            )}
          </button>

          <button
            onClick={toggleVideo}
            className={`w-14 h-14 rounded-full flex items-center justify-center transition-all ${
              isVideoOff ? 'bg-red-500 text-white' : 'bg-white/10 text-white hover:bg-white/20'
            }`}
          >
            {isVideoOff ? (
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 3l18 18" />
              </svg>
            ) : (
              <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
            )}
          </button>

          <button
            onClick={toggleScreenShare}
            className={`w-14 h-14 rounded-full flex items-center justify-center transition-all ${
              isScreenSharing ? 'bg-green-500 text-white' : 'bg-white/10 text-white hover:bg-white/20'
            }`}
          >
            <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </button>

          <button
            onClick={() => setShowParticipants(!showParticipants)}
            className={`w-14 h-14 rounded-full flex items-center justify-center transition-all ${
              showParticipants ? 'bg-orange-500 text-white' : 'bg-white/10 text-white hover:bg-white/20'
            }`}
          >
            <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
          </button>

          <button
            onClick={() => setShowChat(!showChat)}
            className={`w-14 h-14 rounded-full flex items-center justify-center transition-all relative ${
              showChat ? 'bg-orange-500 text-white' : 'bg-white/10 text-white hover:bg-white/20'
            }`}
          >
            <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
            </svg>
            {messages.length > 0 && !showChat && (
              <span className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-xs flex items-center justify-center">
                {messages.length}
              </span>
            )}
          </button>

          <button
            onClick={endCall}
            className="w-16 h-14 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors"
          >
            <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.517l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  );
}
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';
import { useSearchParams } from 'next/navigation';

interface SignatureField {
  id: string;
  type: 'SIGNATURE' | 'INITIAL' | 'DATE' | 'TEXT' | 'CHECKBOX';
  label: string;
  page: number;
  x: number;
  y: number;
  width: number;
  height: number;
  required: boolean;
  value?: string;
  signed?: boolean;
}

interface Document {
  id: string;
  name: string;
  description: string;
  totalPages: number;
  fields: SignatureField[];
  status: 'PENDING' | 'IN_PROGRESS' | 'COMPLETED' | 'EXPIRED';
  createdAt: Date;
  expiresAt: Date;
  senderName: string;
  senderEmail: string;
}

const mockDocument: Document = {
  id: 'doc-1',
  name: 'Sale Agreement - Serene Valley Villa',
  description: 'This agreement outlines the terms and conditions for the sale of property located at 123 Green Valley Road, Bangalore.',
  totalPages: 5,
  status: 'PENDING',
  createdAt: new Date('2024-01-20'),
  expiresAt: new Date('2024-02-20'),
  senderName: 'Priya Sharma',
  senderEmail: 'priya.sharma@dharma-realty.com',
  fields: [
    { id: '1', type: 'SIGNATURE', label: 'Buyer Signature', page: 1, x: 100, y: 600, width: 200, height: 60, required: true },
    { id: '2', type: 'DATE', label: 'Date', page: 1, x: 350, y: 610, width: 120, height: 40, required: true },
    { id: '3', type: 'INITIAL', label: 'Buyer Initials', page: 2, x: 450, y: 700, width: 80, height: 40, required: true },
    { id: '4', type: 'CHECKBOX', label: 'I agree to the terms', page: 3, x: 100, y: 500, width: 20, height: 20, required: true },
    { id: '5', type: 'TEXT', label: 'Full Legal Name', page: 4, x: 100, y: 400, width: 300, height: 40, required: true },
    { id: '6', type: 'SIGNATURE', label: 'Final Signature', page: 5, x: 100, y: 600, width: 200, height: 60, required: true },
  ],
};

export default function SigningPage() {
  const searchParams = useSearchParams();
  const [loading, setLoading] = useState(true);
  const [document, setDocument] = useState<Document | null>(null);
  const [currentPage, setCurrentPage] = useState(1);
  const [signedFields, setSignedFields] = useState<Record<string, string>>({});
  const [showSignatureModal, setShowSignatureModal] = useState(false);
  const [activeField, setActiveField] = useState<SignatureField | null>(null);
  const [signatureType, setSignatureType] = useState<'DRAW' | 'TYPE' | 'UPLOAD'>('TYPE');
  const [typedSignature, setTypedSignature] = useState('');
  const [signatureFont, setSignatureFont] = useState('dancing-script');
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [isCompleted, setIsCompleted] = useState(false);
  const [showDeclineModal, setShowDeclineModal] = useState(false);
  const [declineReason, setDeclineReason] = useState('');
  const [zoom, setZoom] = useState(100);

  useEffect(() => {
    const loadDocument = async () => {
      await new Promise(resolve => setTimeout(resolve, 800));
      setDocument(mockDocument);
      setLoading(false);
    };
    loadDocument();
  }, []);

  const getFieldsForPage = (page: number) => {
    return document?.fields.filter(f => f.page === page) || [];
  };

  const getCompletedFieldsCount = () => {
    return Object.keys(signedFields).length;
  };

  const getTotalRequiredFields = () => {
    return document?.fields.filter(f => f.required).length || 0;
  };

  const isFieldComplete = (fieldId: string) => {
    return signedFields[fieldId] !== undefined;
  };

  const openSignatureModal = (field: SignatureField) => {
    setActiveField(field);
    setShowSignatureModal(true);
  };

  const applySignature = () => {
    if (!activeField) return;
    
    let value = '';
    if (activeField.type === 'SIGNATURE' || activeField.type === 'INITIAL') {
      if (signatureType === 'TYPE') {
        value = typedSignature;
      } else {
        value = 'signed';
      }
    } else if (activeField.type === 'DATE') {
      value = new Date().toLocaleDateString();
    } else if (activeField.type === 'CHECKBOX') {
      value = 'checked';
    } else {
      value = typedSignature;
    }
    
    setSignedFields(prev => ({ ...prev, [activeField.id]: value }));
    setShowSignatureModal(false);
    setTypedSignature('');
    setActiveField(null);

    // Auto-navigate to next unsigned field
    const currentIndex = document?.fields.findIndex(f => f.id === activeField.id) || 0;
    const nextUnsignedField = document?.fields.slice(currentIndex + 1).find(f => !signedFields[f.id] && f.required);
    if (nextUnsignedField) {
      setCurrentPage(nextUnsignedField.page);
    }
  };

  const handleSubmit = async () => {
    setIsSubmitting(true);
    await new Promise(resolve => setTimeout(resolve, 2000));
    setIsSubmitting(false);
    setIsCompleted(true);
  };

  const handleDecline = async () => {
    setIsSubmitting(true);
    await new Promise(resolve => setTimeout(resolve, 1000));
    // Redirect to dashboard
    window.location.href = '/dashboard/documents';
  };

  const canSubmit = getCompletedFieldsCount() === getTotalRequiredFields();

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-100 flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4" />
          <p className="text-gray-600">Loading document...</p>
        </div>
      </div>
    );
  }

  if (isCompleted) {
    return (
      <div className="min-h-screen bg-gray-100 flex items-center justify-center p-4">
        <motion.div
          initial={{ scale: 0.9, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center"
        >
          <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <motion.svg
              initial={{ scale: 0 }}
              animate={{ scale: 1 }}
              transition={{ delay: 0.2, type: 'spring' }}
              className="w-10 h-10 text-green-500"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" />
            </motion.svg>
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Document Signed!</h1>
          <p className="text-gray-600 mb-6">
            Your signed document has been submitted successfully. All parties will receive a copy via email.
          </p>
          <div className="bg-gray-50 rounded-lg p-4 mb-6 text-left">
            <p className="text-sm text-gray-500 mb-1">Document</p>
            <p className="font-medium text-gray-900">{document?.name}</p>
            <p className="text-sm text-gray-500 mt-3 mb-1">Signed on</p>
            <p className="font-medium text-gray-900">{new Date().toLocaleString()}</p>
          </div>
          <div className="space-y-3">
            <button className="w-full py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2">
              <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
              </svg>
              Download Signed Copy
            </button>
            <Link
              href="/dashboard/documents"
              className="block w-full py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
            >
              Back to Documents
            </Link>
          </div>
        </motion.div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-100 flex flex-col">
      {/* Header */}
      <div className="bg-white border-b sticky top-0 z-40">
        <div className="max-w-7xl mx-auto px-4 py-3">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <Link href="/dashboard/documents" className="text-gray-600 hover:text-gray-900">
                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                </svg>
              </Link>
              <div>
                <h1 className="font-semibold text-gray-900 truncate max-w-md">{document?.name}</h1>
                <p className="text-sm text-gray-500">From: {document?.senderName}</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <button
                onClick={() => setShowDeclineModal(true)}
                className="px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors"
              >
                Decline
              </button>
              <button
                onClick={handleSubmit}
                disabled={!canSubmit || isSubmitting}
                className="px-6 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
              >
                {isSubmitting ? (
                  <>
                    <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" />
                    Submitting...
                  </>
                ) : (
                  <>
                    <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                    </svg>
                    Finish
                  </>
                )}
              </button>
            </div>
          </div>
        </div>
      </div>

      <div className="flex-1 flex">
        {/* Sidebar - Fields List */}
        <div className="w-72 bg-white border-r hidden lg:block">
          <div className="p-4 border-b">
            <div className="flex items-center justify-between mb-2">
              <h2 className="font-medium text-gray-900">Required Fields</h2>
              <span className="text-sm text-gray-500">
                {getCompletedFieldsCount()}/{getTotalRequiredFields()}
              </span>
            </div>
            <div className="w-full h-2 bg-gray-200 rounded-full overflow-hidden">
              <div
                className="h-full bg-gradient-to-r from-orange-500 to-amber-500 transition-all"
                style={{ width: `${(getCompletedFieldsCount() / getTotalRequiredFields()) * 100}%` }}
              />
            </div>
          </div>
          <div className="p-2 max-h-[calc(100vh-200px)] overflow-y-auto">
            {document?.fields.filter(f => f.required).map((field, index) => (
              <button
                key={field.id}
                onClick={() => {
                  setCurrentPage(field.page);
                  if (!isFieldComplete(field.id)) {
                    openSignatureModal(field);
                  }
                }}
                className={`w-full p-3 rounded-lg text-left mb-2 transition-colors ${
                  isFieldComplete(field.id)
                    ? 'bg-green-50 border border-green-200'
                    : 'bg-gray-50 border border-gray-200 hover:bg-gray-100'
                }`}
              >
                <div className="flex items-center gap-3">
                  <div className={`w-6 h-6 rounded-full flex items-center justify-center ${
                    isFieldComplete(field.id)
                      ? 'bg-green-500 text-white'
                      : 'bg-gray-300 text-white'
                  }`}>
                    {isFieldComplete(field.id) ? (
                      <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                      </svg>
                    ) : (
                      <span className="text-xs">{index + 1}</span>
                    )}
                  </div>
                  <div className="flex-1 min-w-0">
                    <p className={`text-sm font-medium truncate ${
                      isFieldComplete(field.id) ? 'text-green-700' : 'text-gray-900'
                    }`}>
                      {field.label}
                    </p>
                    <p className="text-xs text-gray-500">Page {field.page}</p>
                  </div>
                  {field.type === 'SIGNATURE' && (
                    <svg className="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                    </svg>
                  )}
                </div>
              </button>
            ))}
          </div>
        </div>

        {/* Document Viewer */}
        <div className="flex-1 flex flex-col">
          {/* Toolbar */}
          <div className="bg-white border-b px-4 py-2 flex items-center justify-between">
            <div className="flex items-center gap-2">
              <button
                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}
                disabled={currentPage === 1}
                className="p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                </svg>
              </button>
              <span className="text-sm text-gray-600">
                Page {currentPage} of {document?.totalPages}
              </span>
              <button
                onClick={() => setCurrentPage(Math.min(document?.totalPages || 1, currentPage + 1))}
                disabled={currentPage === document?.totalPages}
                className="p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                </svg>
              </button>
            </div>
            <div className="flex items-center gap-2">
              <button
                onClick={() => setZoom(Math.max(50, zoom - 25))}
                className="p-2 rounded hover:bg-gray-100"
              >
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7" />
                </svg>
              </button>
              <span className="text-sm text-gray-600 w-12 text-center">{zoom}%</span>
              <button
                onClick={() => setZoom(Math.min(200, zoom + 25))}
                className="p-2 rounded hover:bg-gray-100"
              >
                <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7" />
                </svg>
              </button>
            </div>
          </div>

          {/* Document */}
          <div className="flex-1 overflow-auto p-8 bg-gray-200">
            <div className="flex justify-center">
              <div
                className="bg-white shadow-lg relative"
                style={{
                  width: `${(8.5 * 96 * zoom) / 100}px`,
                  height: `${(11 * 96 * zoom) / 100}px`,
                }}
              >
                {/* Document Content Placeholder */}
                <div className="absolute inset-0 p-8" style={{ transform: `scale(${zoom / 100})`, transformOrigin: 'top left' }}>
                  <div className="text-center mb-8">
                    <h2 className="text-xl font-bold text-gray-900">PROPERTY SALE AGREEMENT</h2>
                    <p className="text-sm text-gray-500 mt-2">Page {currentPage} of {document?.totalPages}</p>
                  </div>
                  
                  {currentPage === 1 && (
                    <div className="space-y-4 text-sm text-gray-600">
                      <p>This Property Sale Agreement ("Agreement") is entered into as of the date of execution by and between:</p>
                      <p><strong>SELLER:</strong> Dharma Realty Pvt. Ltd., represented by Priya Sharma</p>
                      <p><strong>BUYER:</strong> [Your Name]</p>
                      <p><strong>PROPERTY:</strong> Serene Valley Villa, 123 Green Valley Road, Bangalore, Karnataka 560001</p>
                      <p className="mt-4">The parties hereby agree to the following terms and conditions:</p>
                      <p>1. The Seller agrees to sell and the Buyer agrees to purchase the above-described property for the total consideration of ₹1,50,00,000 (Rupees One Crore Fifty Lakhs Only).</p>
                      <p>2. The Buyer shall pay a token amount of ₹5,00,000 upon signing this agreement.</p>
                    </div>
                  )}

                  {currentPage === 2 && (
                    <div className="space-y-4 text-sm text-gray-600">
                      <p>3. The balance amount shall be paid as per the following schedule:</p>
                      <p className="ml-4">a) 20% within 30 days of signing</p>
                      <p className="ml-4">b) 30% upon completion of due diligence</p>
                      <p className="ml-4">c) Remaining 50% on possession date</p>
                      <p>4. The property is sold in "as-is" condition with all existing fixtures and fittings.</p>
                      <p>5. The Seller warrants that the property is free from any encumbrances, liens, or legal disputes.</p>
                    </div>
                  )}

                  {currentPage === 3 && (
                    <div className="space-y-4 text-sm text-gray-600">
                      <p>6. <strong>Vastu Compliance:</strong> The property has been verified for Vastu compliance with an overall score of 92%.</p>
                      <p>7. <strong>Possession:</strong> Physical possession shall be handed over within 60 days of full payment.</p>
                      <p>8. <strong>Registration:</strong> All registration charges and stamp duty shall be borne by the Buyer.</p>
                      <p className="mt-8 font-medium">ACKNOWLEDGMENT OF TERMS</p>
                      <p>By checking below, you acknowledge that you have read, understood, and agree to all terms and conditions stated in this agreement.</p>
                    </div>
                  )}

                  {currentPage === 4 && (
                    <div className="space-y-4 text-sm text-gray-600">
                      <p>9. <strong>Dispute Resolution:</strong> Any disputes arising from this agreement shall be resolved through arbitration in Bangalore.</p>
                      <p>10. <strong>Governing Law:</strong> This agreement shall be governed by the laws of India.</p>
                      <p className="mt-8 font-medium">BUYER INFORMATION</p>
                      <p>Please provide your full legal name as it appears on your government-issued ID:</p>
                    </div>
                  )}

                  {currentPage === 5 && (
                    <div className="space-y-4 text-sm text-gray-600">
                      <p className="font-medium">EXECUTION</p>
                      <p>IN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.</p>
                      <div className="mt-8 grid grid-cols-2 gap-8">
                        <div>
                          <p className="font-medium mb-2">SELLER</p>
                          <p className="text-xs text-gray-500">Dharma Realty Pvt. Ltd.</p>
                          <div className="mt-4 border-b border-gray-300 pb-1">
                            <p className="text-sm italic text-gray-400">Priya Sharma</p>
                          </div>
                          <p className="text-xs text-gray-500 mt-1">Authorized Signatory</p>
                        </div>
                        <div>
                          <p className="font-medium mb-2">BUYER</p>
                          <p className="text-xs text-gray-500">[Buyer Name]</p>
                        </div>
                      </div>
                    </div>
                  )}
                </div>

                {/* Signature Fields */}
                {getFieldsForPage(currentPage).map((field) => (
                  <button
                    key={field.id}
                    onClick={() => openSignatureModal(field)}
                    className={`absolute border-2 rounded transition-all ${
                      isFieldComplete(field.id)
                        ? 'border-green-500 bg-green-50'
                        : 'border-orange-500 bg-orange-50 hover:bg-orange-100 animate-pulse'
                    }`}
                    style={{
                      left: `${(field.x * zoom) / 100}px`,
                      top: `${(field.y * zoom) / 100}px`,
                      width: `${(field.width * zoom) / 100}px`,
                      height: `${(field.height * zoom) / 100}px`,
                    }}
                  >
                    {isFieldComplete(field.id) ? (
                      <div className="w-full h-full flex items-center justify-center">
                        {field.type === 'SIGNATURE' || field.type === 'INITIAL' ? (
                          <span
                            className="text-2xl text-blue-700"
                            style={{ fontFamily: signatureFont === 'dancing-script' ? 'cursive' : 'serif' }}
                          >
                            {signedFields[field.id]}
                          </span>
                        ) : field.type === 'CHECKBOX' ? (
                          <svg className="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" />
                          </svg>
                        ) : (
                          <span className="text-sm text-gray-700">{signedFields[field.id]}</span>
                        )}
                      </div>
                    ) : (
                      <div className="w-full h-full flex flex-col items-center justify-center text-orange-600">
                        {field.type === 'SIGNATURE' && (
                          <>
                            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                            </svg>
                            <span className="text-xs mt-1">Sign here</span>
                          </>
                        )}
                        {field.type === 'INITIAL' && (
                          <>
                            <span className="text-sm font-medium">AB</span>
                            <span className="text-xs">Initial here</span>
                          </>
                        )}
                        {field.type === 'DATE' && (
                          <>
                            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            <span className="text-xs mt-1">Date</span>
                          </>
                        )}
                        {field.type === 'CHECKBOX' && (
                          <div className="w-5 h-5 border-2 border-orange-500 rounded" />
                        )}
                        {field.type === 'TEXT' && (
                          <span className="text-xs">{field.label}</span>
                        )}
                      </div>
                    )}
                  </button>
                ))}
              </div>
            </div>
          </div>

          {/* Page Thumbnails */}
          <div className="bg-white border-t p-2 flex gap-2 overflow-x-auto">
            {Array.from({ length: document?.totalPages || 0 }, (_, i) => i + 1).map((page) => {
              const pageFields = getFieldsForPage(page);
              const hasUnsignedFields = pageFields.some(f => f.required && !isFieldComplete(f.id));
              
              return (
                <button
                  key={page}
                  onClick={() => setCurrentPage(page)}
                  className={`flex-shrink-0 w-16 h-20 rounded border-2 relative ${
                    currentPage === page
                      ? 'border-orange-500'
                      : 'border-gray-200 hover:border-gray-300'
                  }`}
                >
                  <div className="w-full h-full bg-gray-100 flex items-center justify-center text-xs text-gray-500">
                    {page}
                  </div>
                  {hasUnsignedFields && (
                    <div className="absolute -top-1 -right-1 w-4 h-4 bg-orange-500 rounded-full flex items-center justify-center">
                      <span className="text-white text-xs">{pageFields.filter(f => f.required && !isFieldComplete(f.id)).length}</span>
                    </div>
                  )}
                </button>
              );
            })}
          </div>
        </div>
      </div>

      {/* Signature Modal */}
      <AnimatePresence>
        {showSignatureModal && activeField && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowSignatureModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              className="bg-white rounded-xl max-w-lg w-full overflow-hidden"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="p-6 border-b">
                <div className="flex items-center justify-between">
                  <h2 className="text-xl font-semibold text-gray-900">{activeField.label}</h2>
                  <button onClick={() => setShowSignatureModal(false)} className="text-gray-400 hover:text-gray-600">
                    <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </div>

              <div className="p-6">
                {(activeField.type === 'SIGNATURE' || activeField.type === 'INITIAL') && (
                  <>
                    {/* Signature Type Tabs */}
                    <div className="flex gap-2 mb-6">
                      {(['TYPE', 'DRAW', 'UPLOAD'] as const).map((type) => (
                        <button
                          key={type}
                          onClick={() => setSignatureType(type)}
                          className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${
                            signatureType === type
                              ? 'bg-orange-500 text-white'
                              : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                          }`}
                        >
                          {type === 'TYPE' && 'Type'}
                          {type === 'DRAW' && 'Draw'}
                          {type === 'UPLOAD' && 'Upload'}
                        </button>
                      ))}
                    </div>

                    {signatureType === 'TYPE' && (
                      <div className="space-y-4">
                        <input
                          type="text"
                          value={typedSignature}
                          onChange={(e) => setTypedSignature(e.target.value)}
                          placeholder={activeField.type === 'SIGNATURE' ? 'Type your full name' : 'Type your initials'}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-xl"
                          style={{ fontFamily: signatureFont === 'dancing-script' ? 'cursive' : 'serif' }}
                        />
                        <div className="flex gap-2">
                          <button
                            onClick={() => setSignatureFont('dancing-script')}
                            className={`flex-1 py-3 border rounded-lg ${
                              signatureFont === 'dancing-script' ? 'border-orange-500 bg-orange-50' : 'border-gray-200'
                            }`}
                            style={{ fontFamily: 'cursive' }}
                          >
                            Script
                          </button>
                          <button
                            onClick={() => setSignatureFont('serif')}
                            className={`flex-1 py-3 border rounded-lg ${
                              signatureFont === 'serif' ? 'border-orange-500 bg-orange-50' : 'border-gray-200'
                            }`}
                            style={{ fontFamily: 'serif' }}
                          >
                            Formal
                          </button>
                        </div>
                        {typedSignature && (
                          <div className="p-4 bg-gray-50 rounded-lg text-center">
                            <p className="text-sm text-gray-500 mb-2">Preview</p>
                            <p
                              className="text-3xl text-blue-700"
                              style={{ fontFamily: signatureFont === 'dancing-script' ? 'cursive' : 'serif' }}
                            >
                              {typedSignature}
                            </p>
                          </div>
                        )}
                      </div>
                    )}

                    {signatureType === 'DRAW' && (
                      <div className="border-2 border-dashed border-gray-300 rounded-lg h-40 flex items-center justify-center text-gray-400">
                        <p className="text-center">
                          <svg className="w-8 h-8 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                          </svg>
                          Draw your signature here
                        </p>
                      </div>
                    )}

                    {signatureType === 'UPLOAD' && (
                      <div className="border-2 border-dashed border-gray-300 rounded-lg h-40 flex items-center justify-center text-gray-400">
                        <div className="text-center">
                          <svg className="w-8 h-8 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                          </svg>
                          <p>Click to upload or drag and drop</p>
                          <p className="text-xs mt-1">PNG, JPG up to 2MB</p>
                        </div>
                      </div>
                    )}
                  </>
                )}

                {activeField.type === 'DATE' && (
                  <div className="text-center py-4">
                    <p className="text-gray-600 mb-4">The current date will be applied:</p>
                    <p className="text-2xl font-medium text-gray-900">
                      {new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' })}
                    </p>
                  </div>
                )}

                {activeField.type === 'CHECKBOX' && (
                  <div className="text-center py-4">
                    <p className="text-gray-600 mb-4">{activeField.label}</p>
                    <label className="inline-flex items-center gap-3 cursor-pointer">
                      <input
                        type="checkbox"
                        checked={signedFields[activeField.id] === 'checked'}
                        onChange={(e) => {
                          if (e.target.checked) {
                            setSignedFields(prev => ({ ...prev, [activeField.id]: 'checked' }));
                          } else {
                            const newFields = { ...signedFields };
                            delete newFields[activeField.id];
                            setSignedFields(newFields);
                          }
                        }}
                        className="w-6 h-6 rounded text-orange-500 focus:ring-orange-500"
                      />
                      <span className="text-gray-900">I agree</span>
                    </label>
                  </div>
                )}

                {activeField.type === 'TEXT' && (
                  <div>
                    <input
                      type="text"
                      value={typedSignature}
                      onChange={(e) => setTypedSignature(e.target.value)}
                      placeholder={activeField.label}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                    />
                  </div>
                )}
              </div>

              <div className="p-6 bg-gray-50 border-t flex gap-3">
                <button
                  onClick={() => setShowSignatureModal(false)}
                  className="flex-1 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={applySignature}
                  disabled={
                    (activeField.type === 'SIGNATURE' || activeField.type === 'INITIAL' || activeField.type === 'TEXT') &&
                    !typedSignature
                  }
                  className="flex-1 py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  Apply
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Decline Modal */}
      <AnimatePresence>
        {showDeclineModal && (
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
            onClick={() => setShowDeclineModal(false)}
          >
            <motion.div
              initial={{ scale: 0.95, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              exit={{ scale: 0.95, opacity: 0 }}
              className="bg-white rounded-xl max-w-md w-full p-6"
              onClick={(e) => e.stopPropagation()}
            >
              <div className="text-center mb-6">
                <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <svg className="w-8 h-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                  </svg>
                </div>
                <h2 className="text-xl font-semibold text-gray-900 mb-2">Decline to Sign?</h2>
                <p className="text-gray-600">
                  Are you sure you want to decline this document? The sender will be notified.
                </p>
              </div>

              <div className="mb-6">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Reason (optional)
                </label>
                <textarea
                  value={declineReason}
                  onChange={(e) => setDeclineReason(e.target.value)}
                  placeholder="Please provide a reason for declining..."
                  rows={3}
                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                />
              </div>

              <div className="flex gap-3">
                <button
                  onClick={() => setShowDeclineModal(false)}
                  className="flex-1 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors"
                >
                  Cancel
                </button>
                <button
                  onClick={handleDecline}
                  disabled={isSubmitting}
                  className="flex-1 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50"
                >
                  {isSubmitting ? 'Declining...' : 'Decline'}
                </button>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}










Page · TSX
'use client';

import { motion } from 'framer-motion';
import Link from 'next/link';

const teamMembers = [
  {
    name: 'Arjun Sharma',
    role: 'Founder & CEO',
    image: '/team/arjun.jpg',
    bio: 'Former IIT Delhi professor with 20+ years in real estate and Vastu consultancy.',
    linkedin: '#',
  },
  {
    name: 'Priya Patel',
    role: 'Chief Technology Officer',
    image: '/team/priya.jpg',
    bio: 'Ex-Google engineer passionate about bringing technology to traditional practices.',
    linkedin: '#',
  },
  {
    name: 'Rajesh Kumar',
    role: 'Head of Vastu Research',
    image: '/team/rajesh.jpg',
    bio: 'Renowned Vastu expert with clientele across 15 countries.',
    linkedin: '#',
  },
  {
    name: 'Meera Reddy',
    role: 'Head of Customer Success',
    image: '/team/meera.jpg',
    bio: '15 years of real estate experience, dedicated to exceptional client experiences.',
    linkedin: '#',
  },
  {
    name: 'Vikram Singh',
    role: 'Chief Marketing Officer',
    image: '/team/vikram.jpg',
    bio: 'Brand strategist who has helped scale multiple proptech startups.',
    linkedin: '#',
  },
  {
    name: 'Ananya Desai',
    role: 'Head of Astrology Services',
    image: '/team/ananya.jpg',
    bio: 'Third-generation astrologer combining Vedic wisdom with modern analytics.',
    linkedin: '#',
  },
];

const values = [
  {
    icon: (
      <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
      </svg>
    ),
    title: 'Trust & Transparency',
    description: 'We believe in complete honesty. Every property listing, every Vastu report, every transaction - transparency is our foundation.',
  },
  {
    icon: (
      <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
      </svg>
    ),
    title: 'Ancient Wisdom',
    description: 'We honor the 5,000-year-old traditions of Vastu Shastra and Jyotish, integrating them with modern real estate practices.',
  },
  {
    icon: (
      <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M13 10V3L4 14h7v7l9-11h-7z" />
      </svg>
    ),
    title: 'Innovation',
    description: 'From blockchain transactions to AI-powered property matching, we leverage cutting-edge technology to enhance your experience.',
  },
  {
    icon: (
      <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg>
    ),
    title: 'Community',
    description: 'We\'re building more than a platform - we\'re creating a community of conscious homeowners and ethical real estate professionals.',
  },
];

const milestones = [
  { year: '2019', event: 'Founded with a vision to merge ancient wisdom with modern real estate' },
  { year: '2020', event: 'Launched beta platform with 100+ properties in Mumbai' },
  { year: '2021', event: 'Expanded to 10 major cities, crossed 10,000 users' },
  { year: '2022', event: 'Introduced blockchain-based property transactions' },
  { year: '2023', event: 'Launched AI-powered Vastu analysis and astrology matching' },
  { year: '2024', event: 'Reached 100,000+ users and 50,000+ property listings' },
];

const stats = [
  { value: '100K+', label: 'Happy Users' },
  { value: '50K+', label: 'Properties Listed' },
  { value: '25+', label: 'Cities Covered' },
  { value: '₹5000Cr+', label: 'Transaction Value' },
];

export default function AboutPage() {
  return (
    <div className="min-h-screen bg-gray-50">
      {/* Hero Section */}
      <section className="relative bg-gradient-to-br from-orange-600 via-orange-500 to-amber-500 text-white py-24">
        <div className="absolute inset-0 bg-black/10" />
        <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="text-center max-w-4xl mx-auto"
          >
            <h1 className="text-4xl md:text-5xl font-bold mb-6">
              Where Ancient Wisdom Meets Modern Real Estate
            </h1>
            <p className="text-xl text-white/90">
              Dharma Realty is India's first property platform that combines the sacred principles 
              of Vastu Shastra and Vedic Astrology with cutting-edge technology to help you find 
              not just a house, but a home that nurtures your soul.
            </p>
          </motion.div>
        </div>
        
        {/* Decorative elements */}
        <div className="absolute bottom-0 left-0 right-0 h-16 bg-gray-50" style={{ clipPath: 'polygon(0 100%, 100% 100%, 100% 0, 0 100%)' }} />
      </section>

      {/* Stats */}
      <section className="py-12 bg-white border-b">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid grid-cols-2 md:grid-cols-4 gap-8">
            {stats.map((stat, index) => (
              <motion.div
                key={stat.label}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.1 }}
                className="text-center"
              >
                <div className="text-3xl md:text-4xl font-bold text-orange-500">{stat.value}</div>
                <div className="text-gray-600 mt-1">{stat.label}</div>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* Our Story */}
      <section className="py-20">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid lg:grid-cols-2 gap-12 items-center">
            <motion.div
              initial={{ opacity: 0, x: -20 }}
              whileInView={{ opacity: 1, x: 0 }}
              viewport={{ once: true }}
            >
              <h2 className="text-3xl font-bold text-gray-900 mb-6">Our Story</h2>
              <div className="space-y-4 text-gray-600">
                <p>
                  It all began with a simple question: Why do some homes feel instantly welcoming 
                  while others never quite feel like home? Our founder, Arjun Sharma, spent years 
                  studying both modern real estate practices and ancient Indian sciences to find 
                  the answer.
                </p>
                <p>
                  The result was Dharma Realty - a platform built on the understanding that a 
                  home is more than brick and mortar. It's an extension of your energy, your 
                  aspirations, and your destiny. By analyzing properties through the lens of 
                  Vastu Shastra and matching them with your astrological profile, we help you 
                  find spaces that truly resonate with your being.
                </p>
                <p>
                  Today, we've helped over 100,000 families find homes that not only meet their 
                  practical needs but also support their spiritual and emotional well-being. 
                  We've proven that ancient wisdom and modern technology aren't opposites - 
                  they're powerful allies.
                </p>
              </div>
            </motion.div>
            
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              whileInView={{ opacity: 1, x: 0 }}
              viewport={{ once: true }}
              className="relative"
            >
              <div className="aspect-video bg-gradient-to-br from-orange-100 to-amber-100 rounded-2xl flex items-center justify-center">
                <div className="text-center p-8">
                  <div className="w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg className="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M8 5v14l11-7z" />
                    </svg>
                  </div>
                  <p className="text-gray-600">Watch Our Story</p>
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Mission & Vision */}
      <section className="py-20 bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid md:grid-cols-2 gap-12">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true }}
              className="bg-gradient-to-br from-orange-50 to-amber-50 p-8 rounded-2xl"
            >
              <div className="w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center mb-6">
                <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
              </div>
              <h3 className="text-2xl font-bold text-gray-900 mb-4">Our Mission</h3>
              <p className="text-gray-600">
                To democratize access to Vastu-compliant and astrologically harmonious properties, 
                making ancient wisdom accessible to every home seeker in India and beyond. We aim 
                to transform real estate from a mere transaction into a journey of finding spaces 
                that nurture prosperity, health, and happiness.
              </p>
            </motion.div>
            
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true }}
              transition={{ delay: 0.1 }}
              className="bg-gradient-to-br from-amber-50 to-orange-50 p-8 rounded-2xl"
            >
              <div className="w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center mb-6">
                <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
              </div>
              <h3 className="text-2xl font-bold text-gray-900 mb-4">Our Vision</h3>
              <p className="text-gray-600">
                To become the world's leading platform for conscious real estate, where every 
                property transaction honors both modern standards and timeless principles. We 
                envision a future where technology amplifies ancient wisdom, creating homes 
                that are not just smart, but also spiritually aligned.
              </p>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Our Values */}
      <section className="py-20">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            className="text-center mb-12"
          >
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Our Values</h2>
            <p className="text-gray-600 max-w-2xl mx-auto">
              These core principles guide everything we do at Dharma Realty
            </p>
          </motion.div>
          
          <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
            {values.map((value, index) => (
              <motion.div
                key={value.title}
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                transition={{ delay: index * 0.1 }}
                className="bg-white p-6 rounded-xl shadow-sm hover:shadow-md transition-shadow"
              >
                <div className="w-14 h-14 bg-orange-100 rounded-xl flex items-center justify-center text-orange-500 mb-4">
                  {value.icon}
                </div>
                <h3 className="text-lg font-semibold text-gray-900 mb-2">{value.title}</h3>
                <p className="text-gray-600 text-sm">{value.description}</p>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* Timeline */}
      <section className="py-20 bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            className="text-center mb-12"
          >
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Our Journey</h2>
            <p className="text-gray-600">Key milestones in our growth story</p>
          </motion.div>
          
          <div className="relative">
            {/* Timeline line */}
            <div className="absolute left-1/2 transform -translate-x-1/2 h-full w-0.5 bg-orange-200 hidden md:block" />
            
            <div className="space-y-8">
              {milestones.map((milestone, index) => (
                <motion.div
                  key={milestone.year}
                  initial={{ opacity: 0, x: index % 2 === 0 ? -20 : 20 }}
                  whileInView={{ opacity: 1, x: 0 }}
                  viewport={{ once: true }}
                  className={`flex items-center ${index % 2 === 0 ? 'md:flex-row' : 'md:flex-row-reverse'}`}
                >
                  <div className={`w-full md:w-1/2 ${index % 2 === 0 ? 'md:pr-12 md:text-right' : 'md:pl-12'}`}>
                    <div className="bg-gray-50 p-6 rounded-xl">
                      <span className="text-orange-500 font-bold text-lg">{milestone.year}</span>
                      <p className="text-gray-600 mt-2">{milestone.event}</p>
                    </div>
                  </div>
                  <div className="hidden md:flex w-4 h-4 bg-orange-500 rounded-full absolute left-1/2 transform -translate-x-1/2" />
                </motion.div>
              ))}
            </div>
          </div>
        </div>
      </section>

      {/* Team */}
      <section className="py-20">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            className="text-center mb-12"
          >
            <h2 className="text-3xl font-bold text-gray-900 mb-4">Meet Our Team</h2>
            <p className="text-gray-600 max-w-2xl mx-auto">
              A diverse group of experts united by a shared passion for transforming real estate
            </p>
          </motion.div>
          
          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            {teamMembers.map((member, index) => (
              <motion.div
                key={member.name}
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                transition={{ delay: index * 0.1 }}
                className="bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow"
              >
                <div className="h-48 bg-gradient-to-br from-orange-100 to-amber-100 flex items-center justify-center">
                  <div className="w-24 h-24 bg-orange-200 rounded-full flex items-center justify-center">
                    <span className="text-3xl font-bold text-orange-500">
                      {member.name.split(' ').map(n => n[0]).join('')}
                    </span>
                  </div>
                </div>
                <div className="p-6">
                  <h3 className="text-lg font-semibold text-gray-900">{member.name}</h3>
                  <p className="text-orange-500 text-sm mb-3">{member.role}</p>
                  <p className="text-gray-600 text-sm mb-4">{member.bio}</p>
                  <a
                    href={member.linkedin}
                    className="inline-flex items-center text-sm text-gray-500 hover:text-orange-500 transition-colors"
                  >
                    <svg className="w-5 h-5 mr-1" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                    </svg>
                    LinkedIn
                  </a>
                </div>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* CTA */}
      <section className="py-20 bg-gradient-to-br from-orange-600 via-orange-500 to-amber-500">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
          >
            <h2 className="text-3xl font-bold text-white mb-4">
              Ready to Find Your Dharma Home?
            </h2>
            <p className="text-white/90 mb-8 max-w-2xl mx-auto">
              Join thousands of conscious home seekers who have found properties aligned 
              with their energy and aspirations.
            </p>
            <div className="flex flex-col sm:flex-row gap-4 justify-center">
              <Link
                href="/search"
                className="px-8 py-3 bg-white text-orange-500 rounded-lg font-semibold hover:bg-gray-100 transition-colors"
              >
                Explore Properties
              </Link>
              <Link
                href="/contact"
                className="px-8 py-3 border-2 border-white text-white rounded-lg font-semibold hover:bg-white/10 transition-colors"
              >
                Contact Us
              </Link>
            </div>
          </motion.div>
        </div>
      </section>
    </div>
  );
}
Page · TSX
'use client';

import { useState } from 'react';
import { motion } from 'framer-motion';
import Link from 'next/link';

const offices = [
  {
    city: 'Mumbai',
    address: 'Floor 15, One BKC, Bandra Kurla Complex',
    phone: '+91 22 4567 8900',
    email: 'mumbai@dharmarealty.in',
    hours: 'Mon-Sat: 9:00 AM - 7:00 PM',
  },
  {
    city: 'Delhi NCR',
    address: 'Tower B, DLF Cyber City, Gurugram',
    phone: '+91 124 456 7890',
    email: 'delhi@dharmarealty.in',
    hours: 'Mon-Sat: 9:00 AM - 7:00 PM',
  },
  {
    city: 'Bangalore',
    address: 'Embassy Tech Village, Outer Ring Road',
    phone: '+91 80 4567 8900',
    email: 'bangalore@dharmarealty.in',
    hours: 'Mon-Sat: 9:00 AM - 7:00 PM',
  },
  {
    city: 'Hyderabad',
    address: 'Raheja Mindspace, HITEC City',
    phone: '+91 40 4567 8900',
    email: 'hyderabad@dharmarealty.in',
    hours: 'Mon-Sat: 9:00 AM - 7:00 PM',
  },
];

const supportOptions = [
  {
    icon: (
      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
      </svg>
    ),
    title: 'Live Chat',
    description: 'Chat with our support team in real-time',
    action: 'Start Chat',
    available: true,
  },
  {
    icon: (
      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
      </svg>
    ),
    title: 'Email Support',
    description: 'Get a response within 24 hours',
    action: 'Send Email',
    available: true,
  },
  {
    icon: (
      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
      </svg>
    ),
    title: 'Phone Support',
    description: 'Talk to our experts directly',
    action: 'Call Now',
    available: true,
  },
  {
    icon: (
      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
      </svg>
    ),
    title: 'Help Center',
    description: 'Browse FAQs and guides',
    action: 'Visit Help Center',
    available: true,
  },
];

const inquiryTypes = [
  'General Inquiry',
  'Property Listing',
  'Vastu Consultation',
  'Astrology Services',
  'Agent Partnership',
  'Technical Support',
  'Billing & Subscription',
  'Feedback & Suggestions',
];

export default function ContactPage() {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    phone: '',
    inquiryType: '',
    message: '',
  });
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [isSubmitted, setIsSubmitted] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsSubmitting(true);
    
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    setIsSubmitting(false);
    setIsSubmitted(true);
  };

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
    setFormData(prev => ({
      ...prev,
      [e.target.name]: e.target.value,
    }));
  };

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Hero */}
      <section className="bg-gradient-to-br from-orange-600 via-orange-500 to-amber-500 text-white py-16">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="text-center"
          >
            <h1 className="text-4xl font-bold mb-4">Get in Touch</h1>
            <p className="text-white/90 max-w-2xl mx-auto">
              Have questions about properties, Vastu analysis, or our services? 
              We're here to help you on your journey to finding the perfect home.
            </p>
          </motion.div>
        </div>
      </section>

      {/* Support Options */}
      <section className="py-12 -mt-8">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
            {supportOptions.map((option, index) => (
              <motion.div
                key={option.title}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.1 }}
                className="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow"
              >
                <div className="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center text-orange-500 mb-4">
                  {option.icon}
                </div>
                <h3 className="font-semibold text-gray-900 mb-1">{option.title}</h3>
                <p className="text-sm text-gray-600 mb-4">{option.description}</p>
                <button className="text-orange-500 text-sm font-medium hover:text-orange-600 transition-colors">
                  {option.action} →
                </button>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* Contact Form & Map */}
      <section className="py-12">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid lg:grid-cols-2 gap-12">
            {/* Form */}
            <motion.div
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              className="bg-white rounded-2xl p-8 shadow-sm"
            >
              {isSubmitted ? (
                <div className="text-center py-12">
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"
                  >
                    <svg className="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                    </svg>
                  </motion.div>
                  <h3 className="text-2xl font-bold text-gray-900 mb-2">Message Sent!</h3>
                  <p className="text-gray-600 mb-6">
                    Thank you for reaching out. Our team will get back to you within 24 hours.
                  </p>
                  <button
                    onClick={() => {
                      setIsSubmitted(false);
                      setFormData({ name: '', email: '', phone: '', inquiryType: '', message: '' });
                    }}
                    className="text-orange-500 font-medium hover:text-orange-600 transition-colors"
                  >
                    Send Another Message
                  </button>
                </div>
              ) : (
                <>
                  <h2 className="text-2xl font-bold text-gray-900 mb-6">Send Us a Message</h2>
                  <form onSubmit={handleSubmit} className="space-y-6">
                    <div className="grid md:grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Full Name *
                        </label>
                        <input
                          type="text"
                          name="name"
                          value={formData.name}
                          onChange={handleChange}
                          required
                          className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          placeholder="Your full name"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Email Address *
                        </label>
                        <input
                          type="email"
                          name="email"
                          value={formData.email}
                          onChange={handleChange}
                          required
                          className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          placeholder="your@email.com"
                        />
                      </div>
                    </div>

                    <div className="grid md:grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Phone Number
                        </label>
                        <input
                          type="tel"
                          name="phone"
                          value={formData.phone}
                          onChange={handleChange}
                          className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          placeholder="+91 98765 43210"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Inquiry Type *
                        </label>
                        <select
                          name="inquiryType"
                          value={formData.inquiryType}
                          onChange={handleChange}
                          required
                          className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent bg-white"
                        >
                          <option value="">Select inquiry type</option>
                          {inquiryTypes.map(type => (
                            <option key={type} value={type}>{type}</option>
                          ))}
                        </select>
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Message *
                      </label>
                      <textarea
                        name="message"
                        value={formData.message}
                        onChange={handleChange}
                        required
                        rows={5}
                        className="w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none"
                        placeholder="How can we help you?"
                      />
                    </div>

                    <button
                      type="submit"
                      disabled={isSubmitting}
                      className="w-full py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
                    >
                      {isSubmitting ? (
                        <>
                          <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
                          </svg>
                          Sending...
                        </>
                      ) : (
                        'Send Message'
                      )}
                    </button>
                  </form>
                </>
              )}
            </motion.div>

            {/* Map Placeholder */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              className="space-y-6"
            >
              <div className="bg-gradient-to-br from-orange-100 to-amber-100 rounded-2xl h-64 lg:h-80 flex items-center justify-center">
                <div className="text-center">
                  <svg className="w-16 h-16 text-orange-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                  <p className="text-gray-600">Interactive Map</p>
                  <p className="text-sm text-gray-500">View our office locations</p>
                </div>
              </div>

              {/* Quick Contact Info */}
              <div className="bg-white rounded-xl p-6 shadow-sm">
                <h3 className="font-semibold text-gray-900 mb-4">Quick Contact</h3>
                <div className="space-y-4">
                  <div className="flex items-start">
                    <svg className="w-5 h-5 text-orange-500 mt-1 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    <div>
                      <p className="text-gray-600 text-sm">Toll-free (India)</p>
                      <p className="font-medium text-gray-900">1800-123-DHARMA</p>
                    </div>
                  </div>
                  <div className="flex items-start">
                    <svg className="w-5 h-5 text-orange-500 mt-1 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    <div>
                      <p className="text-gray-600 text-sm">Email</p>
                      <p className="font-medium text-gray-900">hello@dharmarealty.in</p>
                    </div>
                  </div>
                  <div className="flex items-start">
                    <svg className="w-5 h-5 text-orange-500 mt-1 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <div>
                      <p className="text-gray-600 text-sm">Support Hours</p>
                      <p className="font-medium text-gray-900">Mon-Sat: 9AM - 8PM IST</p>
                    </div>
                  </div>
                </div>
              </div>

              {/* Social Links */}
              <div className="bg-white rounded-xl p-6 shadow-sm">
                <h3 className="font-semibold text-gray-900 mb-4">Follow Us</h3>
                <div className="flex space-x-4">
                  {[
                    { name: 'Facebook', icon: 'M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z' },
                    { name: 'Twitter', icon: 'M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z' },
                    { name: 'Instagram', icon: 'M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37zm1.5-4.87h.01M6.5 19.5h11a3 3 0 003-3v-11a3 3 0 00-3-3h-11a3 3 0 00-3 3v11a3 3 0 003 3z' },
                    { name: 'LinkedIn', icon: 'M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2zM4 2a2 2 0 110 4 2 2 0 010-4z' },
                    { name: 'YouTube', icon: 'M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78 0 003.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33zM9.75 15.02V8.48l5.75 3.27-5.75 3.27z' },
                  ].map(social => (
                    <a
                      key={social.name}
                      href="#"
                      className="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 hover:bg-orange-100 hover:text-orange-500 transition-colors"
                      title={social.name}
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d={social.icon} />
                      </svg>
                    </a>
                  ))}
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Office Locations */}
      <section className="py-12 bg-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            className="text-center mb-12"
          >
            <h2 className="text-2xl font-bold text-gray-900 mb-2">Our Offices</h2>
            <p className="text-gray-600">Visit us at any of our locations across India</p>
          </motion.div>

          <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
            {offices.map((office, index) => (
              <motion.div
                key={office.city}
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                transition={{ delay: index * 0.1 }}
                className="bg-gray-50 rounded-xl p-6 hover:shadow-md transition-shadow"
              >
                <h3 className="font-semibold text-gray-900 mb-3">{office.city}</h3>
                <div className="space-y-2 text-sm">
                  <p className="text-gray-600">{office.address}</p>
                  <p className="text-gray-600">{office.phone}</p>
                  <p className="text-orange-500">{office.email}</p>
                  <p className="text-gray-500 text-xs">{office.hours}</p>
                </div>
                <button className="mt-4 text-sm text-orange-500 font-medium hover:text-orange-600 transition-colors">
                  Get Directions →
                </button>
              </motion.div>
            ))}
          </div>
        </div>
      </section>

      {/* FAQ CTA */}
      <section className="py-16 bg-gradient-to-br from-gray-900 to-gray-800 text-white">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
          >
            <h2 className="text-2xl font-bold mb-4">Have More Questions?</h2>
            <p className="text-gray-300 mb-6 max-w-xl mx-auto">
              Check out our comprehensive FAQ section for instant answers to common questions
            </p>
            <Link
              href="/faq"
              className="inline-flex items-center px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-500 rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all"
            >
              Browse FAQs
              <svg className="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
              </svg>
            </Link>
          </motion.div>
        </div>
      </section>
    </div>
  );
}
Page · TSX
'use client';

import { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface FAQ {
  question: string;
  answer: string;
}

interface FAQCategory {
  name: string;
  icon: React.ReactNode;
  faqs: FAQ[];
}

const faqCategories: FAQCategory[] = [
  {
    name: 'General',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
    ),
    faqs: [
      {
        question: 'What is Dharma Realty?',
        answer: 'Dharma Realty is India\'s first property platform that combines traditional Vastu Shastra and Vedic Astrology with modern real estate technology. We help you find homes that are not just practically suitable but also spiritually aligned with your energy and aspirations.',
      },
      {
        question: 'How is Dharma Realty different from other property platforms?',
        answer: 'Unlike traditional platforms that focus only on location, price, and amenities, we provide comprehensive Vastu analysis for every property, personalized astrology-based property matching, blockchain-secured transactions, and AI-powered recommendations based on your birth chart and preferences.',
      },
      {
        question: 'Is Dharma Realty available in my city?',
        answer: 'We currently operate in 25+ major cities across India including Mumbai, Delhi NCR, Bangalore, Chennai, Hyderabad, Pune, Kolkata, and Ahmedabad. We\'re rapidly expanding and adding new cities every month. Check our search page to see if properties are available in your area.',
      },
      {
        question: 'Do I need to believe in Vastu or astrology to use Dharma Realty?',
        answer: 'Not at all! Our platform provides all the standard property search features you\'d expect. Vastu scores and astrology compatibility are additional insights that you can choose to consider or ignore. Many users find these insights helpful even without strong beliefs in these sciences.',
      },
    ],
  },
  {
    name: 'Vastu & Astrology',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
      </svg>
    ),
    faqs: [
      {
        question: 'How is the Vastu score calculated?',
        answer: 'Our Vastu score is calculated by analyzing 50+ parameters including entrance direction, room placements (kitchen, bedroom, bathroom), staircase position, water element placement, ventilation, and natural light flow. Each parameter is weighted based on its importance in traditional Vastu Shastra texts, and the final score reflects overall compliance.',
      },
      {
        question: 'Can I get a detailed Vastu report for a property?',
        answer: 'Yes! Every property listing includes a basic Vastu score. Premium and Agent Pro subscribers can access detailed Vastu reports with room-by-room analysis, specific defects identification, and remedial suggestions. You can also request a custom Vastu consultation with our certified experts.',
      },
      {
        question: 'How does astrology-based property matching work?',
        answer: 'When you provide your birth details (date, time, and place), our system generates your Vedic birth chart. We then analyze factors like your Moon sign, Lagna (ascendant), planetary periods (Dasha), and favorable directions based on Ashtakvarga to match you with properties that align with your cosmic energies.',
      },
      {
        question: 'What if a property has Vastu defects? Can they be corrected?',
        answer: 'Many Vastu defects can be mitigated through remedies without structural changes. Our detailed reports include specific remedial measures like placement of mirrors, colors, plants, or yantras. For major structural defects, we recommend consulting with our Vastu experts before making a decision.',
      },
      {
        question: 'Do you provide astrology consultations?',
        answer: 'Yes, we offer one-on-one consultations with certified Vedic astrologers who specialize in property-related matters. They can analyze your chart, recommend auspicious times (Muhurta) for property registration or moving in, and provide personalized guidance.',
      },
    ],
  },
  {
    name: 'Buying & Renting',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
      </svg>
    ),
    faqs: [
      {
        question: 'How do I schedule a property visit?',
        answer: 'You can schedule visits directly through the property listing page by clicking "Schedule Visit". Choose between in-person visits or virtual tours via video call. The property agent will confirm the slot, and you\'ll receive calendar invites and reminders.',
      },
      {
        question: 'What is the process for making an offer?',
        answer: 'Once you\'ve found a property you like, click "Make Offer" on the listing. You\'ll specify your offered price, financing terms, and any conditions. The offer is sent to the seller/agent who can accept, counter, or decline. All negotiations happen securely within our platform.',
      },
      {
        question: 'Does Dharma Realty help with home loans?',
        answer: 'We have partnerships with major banks and NBFCs to help you get pre-approved home loans at competitive rates. Our team can guide you through the documentation process and help you compare offers from multiple lenders.',
      },
      {
        question: 'What documents are required for property registration?',
        answer: 'Required documents typically include ID proof (Aadhaar/PAN), address proof, income proof, property documents, NOC from society/builder, and bank statements. Our document management system helps you organize and securely share these with relevant parties.',
      },
      {
        question: 'Can I rent a property through Dharma Realty?',
        answer: 'Absolutely! We have extensive rental listings with the same Vastu analysis and features. You can search for rentals, schedule visits, sign rental agreements digitally, and even pay rent through our platform.',
      },
    ],
  },
  {
    name: 'For Property Owners',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
      </svg>
    ),
    faqs: [
      {
        question: 'How do I list my property on Dharma Realty?',
        answer: 'Create an account, go to Dashboard > Listings > Add New Property. Fill in property details, upload photos, and submit for review. Our team verifies listings within 24-48 hours. For premium visibility, consider our featured listing options.',
      },
      {
        question: 'What does the Vastu certification process involve?',
        answer: 'When you list a property, our certified Vastu experts analyze it based on floor plans and photos. They generate a detailed Vastu report and score that\'s displayed on your listing. This adds credibility and attracts buyers who value Vastu-compliant homes.',
      },
      {
        question: 'How much does it cost to list a property?',
        answer: 'Basic listings are free for property owners. For enhanced visibility, we offer featured listings, spotlight placements, and premium packages. Agent accounts have different pricing based on subscription tiers. View our pricing page for current rates.',
      },
      {
        question: 'How do I manage inquiries and showings?',
        answer: 'Your dashboard provides a central hub for all inquiries and showing requests. You can accept/decline requests, communicate with interested buyers through our messaging system, and track the status of each lead.',
      },
    ],
  },
  {
    name: 'For Agents',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
      </svg>
    ),
    faqs: [
      {
        question: 'How do I become a verified agent on Dharma Realty?',
        answer: 'Register for an Agent account and complete our verification process. This includes submitting RERA registration (if applicable), ID proof, business documents, and passing our brief online assessment on Vastu basics. Verified agents get a trust badge on their profile.',
      },
      {
        question: 'What tools are available for agents?',
        answer: 'Agent Pro subscribers get CRM tools, lead management, automated follow-ups, analytics dashboard, bulk listing uploads, virtual tour hosting, document signing, client matching based on astrology, and priority customer support.',
      },
      {
        question: 'How does the commission structure work?',
        answer: 'Dharma Realty charges a platform fee on successful transactions facilitated through our platform. The fee varies based on transaction type (sale/rent) and your subscription tier. Detailed fee structures are available in your agent dashboard.',
      },
      {
        question: 'Can I import listings from other platforms?',
        answer: 'Yes, Agent Pro subscribers can bulk import listings via CSV upload or direct integration with other platforms. Our team can assist with data migration to ensure your listings are properly formatted and Vastu-analyzed.',
      },
    ],
  },
  {
    name: 'Blockchain & Security',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
      </svg>
    ),
    faqs: [
      {
        question: 'What is blockchain property registration?',
        answer: 'We use blockchain technology to create immutable records of property ownership and transactions. This provides a tamper-proof history, reduces fraud, and can speed up verification processes. It works alongside traditional government registration, not as a replacement.',
      },
      {
        question: 'Is my personal data secure?',
        answer: 'Absolutely. We use bank-grade encryption for all data, comply with data protection regulations, and never share your information without consent. Birth details used for astrology are particularly sensitive and are encrypted with additional security layers.',
      },
      {
        question: 'How do smart contracts work for property transactions?',
        answer: 'Smart contracts automate parts of the transaction process - like releasing escrow funds when conditions are met or triggering document transfers. They reduce the need for intermediaries and provide transparency to all parties involved.',
      },
      {
        question: 'Do I need a crypto wallet to use blockchain features?',
        answer: 'For basic platform use, no wallet is needed. If you want to participate in blockchain-based transactions or view your property NFT certificates, we guide you through setting up a wallet and provide a simplified interface.',
      },
    ],
  },
  {
    name: 'Payments & Subscriptions',
    icon: (
      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
      </svg>
    ),
    faqs: [
      {
        question: 'What payment methods are accepted?',
        answer: 'We accept all major credit/debit cards, UPI (Google Pay, PhonePe, Paytm), net banking from all major banks, and wallet payments. For property transactions, we support NEFT/RTGS and escrow payments.',
      },
      {
        question: 'Can I cancel my subscription?',
        answer: 'Yes, you can cancel anytime from your account settings. Your subscription benefits continue until the end of the billing period. We also offer a 7-day money-back guarantee for new subscriptions.',
      },
      {
        question: 'Are there any hidden charges?',
        answer: 'No hidden charges. Subscription prices are clearly displayed, and any transaction fees are disclosed upfront before you proceed. We believe in complete transparency.',
      },
      {
        question: 'Do you offer refunds?',
        answer: 'New subscribers can request a full refund within 7 days. For specific services like Vastu consultations, refunds are considered on a case-by-case basis. Contact support for assistance.',
      },
    ],
  },
];

function FAQAccordion({ faq, isOpen, onToggle }: { faq: FAQ; isOpen: boolean; onToggle: () => void }) {
  return (
    <div className="border-b border-gray-100 last:border-0">
      <button
        onClick={onToggle}
        className="w-full py-4 flex items-center justify-between text-left hover:text-orange-500 transition-colors"
      >
        <span className="font-medium text-gray-900 pr-8">{faq.question}</span>
        <motion.svg
          animate={{ rotate: isOpen ? 180 : 0 }}
          transition={{ duration: 0.2 }}
          className="w-5 h-5 text-gray-400 flex-shrink-0"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
        </motion.svg>
      </button>
      <AnimatePresence>
        {isOpen && (
          <motion.div
            initial={{ height: 0, opacity: 0 }}
            animate={{ height: 'auto', opacity: 1 }}
            exit={{ height: 0, opacity: 0 }}
            transition={{ duration: 0.2 }}
            className="overflow-hidden"
          >
            <p className="pb-4 text-gray-600 leading-relaxed">{faq.answer}</p>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}

export default function FAQPage() {
  const [activeCategory, setActiveCategory] = useState('General');
  const [openQuestions, setOpenQuestions] = useState<Record<string, boolean>>({});
  const [searchQuery, setSearchQuery] = useState('');

  const toggleQuestion = (question: string) => {
    setOpenQuestions(prev => ({
      ...prev,
      [question]: !prev[question],
    }));
  };

  const filteredCategories = searchQuery
    ? faqCategories.map(cat => ({
        ...cat,
        faqs: cat.faqs.filter(
          faq =>
            faq.question.toLowerCase().includes(searchQuery.toLowerCase()) ||
            faq.answer.toLowerCase().includes(searchQuery.toLowerCase())
        ),
      })).filter(cat => cat.faqs.length > 0)
    : faqCategories;

  const currentCategory = filteredCategories.find(cat => cat.name === activeCategory) || filteredCategories[0];

  return (
    <div className="min-h-screen bg-gray-50">
      {/* Hero */}
      <section className="bg-gradient-to-br from-orange-600 via-orange-500 to-amber-500 text-white py-16">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="text-center max-w-3xl mx-auto"
          >
            <h1 className="text-4xl font-bold mb-4">Frequently Asked Questions</h1>
            <p className="text-white/90 mb-8">
              Find answers to common questions about Dharma Realty, Vastu analysis, 
              property transactions, and more.
            </p>
            
            {/* Search */}
            <div className="relative max-w-xl mx-auto">
              <svg
                className="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <input
                type="text"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                placeholder="Search for answers..."
                className="w-full pl-12 pr-4 py-3 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-white/50"
              />
            </div>
          </motion.div>
        </div>
      </section>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div className="flex flex-col lg:flex-row gap-8">
          {/* Category Sidebar */}
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            className="lg:w-64 flex-shrink-0"
          >
            <div className="bg-white rounded-xl p-4 shadow-sm sticky top-4">
              <h3 className="font-semibold text-gray-900 mb-4 px-2">Categories</h3>
              <nav className="space-y-1">
                {faqCategories.map(category => {
                  const filteredCat = filteredCategories.find(c => c.name === category.name);
                  const count = filteredCat?.faqs.length || 0;
                  
                  return (
                    <button
                      key={category.name}
                      onClick={() => setActiveCategory(category.name)}
                      className={`w-full flex items-center justify-between px-3 py-2 rounded-lg text-left transition-colors ${
                        activeCategory === category.name
                          ? 'bg-orange-50 text-orange-600'
                          : 'text-gray-600 hover:bg-gray-50'
                      } ${count === 0 && searchQuery ? 'opacity-50' : ''}`}
                      disabled={count === 0 && !!searchQuery}
                    >
                      <span className="flex items-center">
                        <span className={activeCategory === category.name ? 'text-orange-500' : 'text-gray-400'}>
                          {category.icon}
                        </span>
                        <span className="ml-3 text-sm font-medium">{category.name}</span>
                      </span>
                      {searchQuery && (
                        <span className={`text-xs px-2 py-0.5 rounded-full ${
                          activeCategory === category.name ? 'bg-orange-100' : 'bg-gray-100'
                        }`}>
                          {count}
                        </span>
                      )}
                    </button>
                  );
                })}
              </nav>
            </div>
          </motion.div>

          {/* FAQ Content */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="flex-1"
          >
            {searchQuery && filteredCategories.length === 0 ? (
              <div className="bg-white rounded-xl p-12 shadow-sm text-center">
                <svg className="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h3 className="text-lg font-semibold text-gray-900 mb-2">No results found</h3>
                <p className="text-gray-600 mb-4">
                  We couldn't find any FAQs matching "{searchQuery}"
                </p>
                <button
                  onClick={() => setSearchQuery('')}
                  className="text-orange-500 font-medium hover:text-orange-600"
                >
                  Clear search
                </button>
              </div>
            ) : currentCategory ? (
              <div className="bg-white rounded-xl p-6 shadow-sm">
                <div className="flex items-center mb-6">
                  <span className="text-orange-500 mr-3">{currentCategory.icon}</span>
                  <h2 className="text-xl font-bold text-gray-900">{currentCategory.name}</h2>
                </div>
                <div className="divide-y divide-gray-100">
                  {currentCategory.faqs.map(faq => (
                    <FAQAccordion
                      key={faq.question}
                      faq={faq}
                      isOpen={openQuestions[faq.question] || false}
                      onToggle={() => toggleQuestion(faq.question)}
                    />
                  ))}
                </div>
              </div>
            ) : null}

            {/* Still have questions */}
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.2 }}
              className="mt-8 bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-8 text-center"
            >
              <h3 className="text-xl font-bold text-gray-900 mb-2">Still have questions?</h3>
              <p className="text-gray-600 mb-6">
                Can't find the answer you're looking for? Our support team is here to help.
              </p>
              <div className="flex flex-col sm:flex-row gap-4 justify-center">
                <Link
                  href="/contact"
                  className="px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all"
                >
                  Contact Support
                </Link>
                <button className="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-white transition-colors">
                  Start Live Chat
                </button>
              </div>
            </motion.div>
          </motion.div>
        </div>
      </div>
    </div>
  );
}
Not found · TSX
'use client';

import { motion } from 'framer-motion';
import Link from 'next/link';

export default function NotFound() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-orange-50 flex items-center justify-center px-4">
      <div className="max-w-2xl mx-auto text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.9 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
        >
          {/* 404 Illustration */}
          <div className="relative mb-8">
            <motion.div
              animate={{ y: [0, -10, 0] }}
              transition={{ duration: 3, repeat: Infinity, ease: 'easeInOut' }}
              className="text-9xl font-bold text-orange-500/20"
            >
              404
            </motion.div>
            <div className="absolute inset-0 flex items-center justify-center">
              <motion.div
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.2 }}
                className="bg-white rounded-2xl p-6 shadow-lg"
              >
                <svg
                  className="w-20 h-20 text-orange-500 mx-auto"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={1.5}
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                  />
                </svg>
              </motion.div>
            </div>
          </div>

          <motion.h1
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.3 }}
            className="text-3xl md:text-4xl font-bold text-gray-900 mb-4"
          >
            Oops! This property doesn't exist
          </motion.h1>

          <motion.p
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4 }}
            className="text-gray-600 mb-8 max-w-md mx-auto"
          >
            The page you're looking for seems to have moved to a different location, 
            much like properties do. Let us help you find your way.
          </motion.p>

          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.5 }}
            className="flex flex-col sm:flex-row gap-4 justify-center"
          >
            <Link
              href="/"
              className="px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all inline-flex items-center justify-center"
            >
              <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
              </svg>
              Go Home
            </Link>
            <Link
              href="/search"
              className="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-white transition-colors inline-flex items-center justify-center"
            >
              <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              Search Properties
            </Link>
          </motion.div>

          {/* Quick Links */}
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.6 }}
            className="mt-12 pt-8 border-t border-gray-200"
          >
            <p className="text-sm text-gray-500 mb-4">Or try these popular pages:</p>
            <div className="flex flex-wrap justify-center gap-4">
              {[
                { label: 'Browse Listings', href: '/search' },
                { label: 'Find Agents', href: '/agents' },
                { label: 'Vastu Guide', href: '/faq' },
                { label: 'Contact Us', href: '/contact' },
              ].map(link => (
                <Link
                  key={link.label}
                  href={link.href}
                  className="text-sm text-orange-500 hover:text-orange-600 hover:underline"
                >
                  {link.label}
                </Link>
              ))}
            </div>
          </motion.div>
        </motion.div>
      </div>
    </div>
  );
}
Error · TSX
'use client';

import { useEffect } from 'react';
import { motion } from 'framer-motion';

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    // Log the error to an error reporting service
    console.error('Application error:', error);
  }, [error]);

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-red-50 flex items-center justify-center px-4">
      <div className="max-w-2xl mx-auto text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.9 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
        >
          {/* Error Illustration */}
          <motion.div
            animate={{ 
              rotate: [0, -5, 5, -5, 0],
            }}
            transition={{ duration: 0.5, delay: 0.2 }}
            className="mb-8"
          >
            <div className="relative inline-block">
              <div className="w-32 h-32 bg-red-100 rounded-full flex items-center justify-center mx-auto">
                <svg
                  className="w-16 h-16 text-red-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={1.5}
                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                  />
                </svg>
              </div>
              {/* Decorative elements */}
              <motion.div
                animate={{ scale: [1, 1.2, 1], opacity: [0.5, 1, 0.5] }}
                transition={{ duration: 2, repeat: Infinity }}
                className="absolute -top-2 -right-2 w-6 h-6 bg-red-200 rounded-full"
              />
              <motion.div
                animate={{ scale: [1, 1.3, 1], opacity: [0.5, 1, 0.5] }}
                transition={{ duration: 2, repeat: Infinity, delay: 0.5 }}
                className="absolute -bottom-1 -left-3 w-4 h-4 bg-orange-200 rounded-full"
              />
            </div>
          </motion.div>

          <motion.h1
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.3 }}
            className="text-3xl md:text-4xl font-bold text-gray-900 mb-4"
          >
            Something went wrong
          </motion.h1>

          <motion.p
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4 }}
            className="text-gray-600 mb-4 max-w-md mx-auto"
          >
            We apologize for the inconvenience. Our team has been notified and is 
            working to fix this issue.
          </motion.p>

          {error.digest && (
            <motion.p
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.45 }}
              className="text-sm text-gray-400 mb-6"
            >
              Error ID: {error.digest}
            </motion.p>
          )}

          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.5 }}
            className="flex flex-col sm:flex-row gap-4 justify-center"
          >
            <button
              onClick={reset}
              className="px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all inline-flex items-center justify-center"
            >
              <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
              Try Again
            </button>
            <a
              href="/"
              className="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-white transition-colors inline-flex items-center justify-center"
            >
              <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
              </svg>
              Go Home
            </a>
          </motion.div>

          {/* Help Section */}
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.6 }}
            className="mt-12 pt-8 border-t border-gray-200"
          >
            <p className="text-sm text-gray-500 mb-4">Need help? Here are some options:</p>
            <div className="flex flex-wrap justify-center gap-6">
              <a
                href="/contact"
                className="text-sm text-gray-600 hover:text-orange-500 inline-flex items-center"
              >
                <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                Contact Support
              </a>
              <a
                href="/faq"
                className="text-sm text-gray-600 hover:text-orange-500 inline-flex items-center"
              >
                <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Browse FAQs
              </a>
              <button
                onClick={() => window.location.reload()}
                className="text-sm text-gray-600 hover:text-orange-500 inline-flex items-center"
              >
                <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                Refresh Page
              </button>
            </div>
          </motion.div>
        </motion.div>
      </div>
    </div>
  );
}
Propertycard · TSX
'use client';

import { useState } from 'react';
import { motion } from 'framer-motion';
import Link from 'next/link';

export interface Property {
  id: string;
  title: string;
  address: string;
  city: string;
  price: number;
  priceType: 'sale' | 'rent';
  propertyType: 'apartment' | 'house' | 'villa' | 'plot' | 'commercial';
  bedrooms: number;
  bathrooms: number;
  area: number;
  areaUnit: 'sqft' | 'sqm';
  images: string[];
  vastu: {
    score: number;
    status: 'excellent' | 'good' | 'average' | 'poor';
  };
  astrology?: {
    compatibility: number;
  };
  features: string[];
  isNew?: boolean;
  isFeatured?: boolean;
  isVerified?: boolean;
  agent?: {
    id: string;
    name: string;
    image?: string;
  };
  listedAt: string;
}

interface PropertyCardProps {
  property: Property;
  variant?: 'default' | 'compact' | 'horizontal';
  showVastu?: boolean;
  showAgent?: boolean;
  onFavorite?: (id: string) => void;
  onCompare?: (id: string) => void;
  isFavorited?: boolean;
  isComparing?: boolean;
}

const formatPrice = (price: number, type: 'sale' | 'rent') => {
  if (price >= 10000000) {
    return `₹${(price / 10000000).toFixed(2)} Cr`;
  } else if (price >= 100000) {
    return `₹${(price / 100000).toFixed(2)} L`;
  }
  return `₹${price.toLocaleString('en-IN')}${type === 'rent' ? '/mo' : ''}`;
};

const getVastuColor = (status: string) => {
  switch (status) {
    case 'excellent': return 'text-green-600 bg-green-100';
    case 'good': return 'text-blue-600 bg-blue-100';
    case 'average': return 'text-yellow-600 bg-yellow-100';
    case 'poor': return 'text-red-600 bg-red-100';
    default: return 'text-gray-600 bg-gray-100';
  }
};

const propertyTypeLabels = {
  apartment: 'Apartment',
  house: 'House',
  villa: 'Villa',
  plot: 'Plot',
  commercial: 'Commercial',
};

export function PropertyCard({
  property,
  variant = 'default',
  showVastu = true,
  showAgent = false,
  onFavorite,
  onCompare,
  isFavorited = false,
  isComparing = false,
}: PropertyCardProps) {
  const [imageError, setImageError] = useState(false);
  const [isHovered, setIsHovered] = useState(false);

  if (variant === 'horizontal') {
    return (
      <motion.div
        initial={{ opacity: 0, y: 10 }}
        animate={{ opacity: 1, y: 0 }}
        className="bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow"
      >
        <div className="flex flex-col md:flex-row">
          {/* Image */}
          <div className="relative w-full md:w-72 h-48 md:h-auto flex-shrink-0">
            <div className="absolute inset-0 bg-gradient-to-br from-orange-100 to-amber-100 flex items-center justify-center">
              {imageError || !property.images[0] ? (
                <svg className="w-12 h-12 text-orange-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
              ) : (
                <img
                  src={property.images[0]}
                  alt={property.title}
                  className="w-full h-full object-cover"
                  onError={() => setImageError(true)}
                />
              )}
            </div>
            
            {/* Badges */}
            <div className="absolute top-3 left-3 flex flex-col gap-2">
              {property.isNew && (
                <span className="px-2 py-1 bg-green-500 text-white text-xs font-medium rounded">NEW</span>
              )}
              {property.isFeatured && (
                <span className="px-2 py-1 bg-orange-500 text-white text-xs font-medium rounded">FEATURED</span>
              )}
            </div>

            {/* Actions */}
            <div className="absolute top-3 right-3 flex gap-2">
              {onFavorite && (
                <button
                  onClick={(e) => { e.preventDefault(); onFavorite(property.id); }}
                  className={`p-2 rounded-full backdrop-blur-sm transition-colors ${
                    isFavorited ? 'bg-red-500 text-white' : 'bg-white/80 text-gray-600 hover:text-red-500'
                  }`}
                >
                  <svg className="w-5 h-5" fill={isFavorited ? 'currentColor' : 'none'} stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                  </svg>
                </button>
              )}
            </div>
          </div>

          {/* Content */}
          <div className="flex-1 p-5">
            <div className="flex items-start justify-between mb-2">
              <div>
                <span className="text-xs text-gray-500 uppercase">{propertyTypeLabels[property.propertyType]}</span>
                <Link href={`/property/${property.id}`}>
                  <h3 className="text-lg font-semibold text-gray-900 hover:text-orange-500 transition-colors">
                    {property.title}
                  </h3>
                </Link>
              </div>
              <div className="text-right">
                <p className="text-xl font-bold text-orange-500">
                  {formatPrice(property.price, property.priceType)}
                </p>
                {property.priceType === 'rent' && (
                  <span className="text-xs text-gray-500">per month</span>
                )}
              </div>
            </div>

            <p className="text-gray-500 text-sm mb-3 flex items-center">
              <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              {property.address}, {property.city}
            </p>

            <div className="flex items-center gap-4 text-sm text-gray-600 mb-4">
              <span className="flex items-center">
                <svg className="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                </svg>
                {property.bedrooms} BHK
              </span>
              <span className="flex items-center">
                <svg className="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                </svg>
                {property.bathrooms} Bath
              </span>
              <span className="flex items-center">
                <svg className="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
                </svg>
                {property.area.toLocaleString()} {property.areaUnit}
              </span>
            </div>

            <div className="flex items-center justify-between">
              {showVastu && (
                <div className="flex items-center gap-2">
                  <span className={`px-2 py-1 text-xs font-medium rounded-full ${getVastuColor(property.vastu.status)}`}>
                    Vastu {property.vastu.score}%
                  </span>
                  {property.isVerified && (
                    <span className="flex items-center text-xs text-green-600">
                      <svg className="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                      </svg>
                      Verified
                    </span>
                  )}
                </div>
              )}

              <Link
                href={`/property/${property.id}`}
                className="text-sm font-medium text-orange-500 hover:text-orange-600"
              >
                View Details →
              </Link>
            </div>
          </div>
        </div>
      </motion.div>
    );
  }

  if (variant === 'compact') {
    return (
      <motion.div
        initial={{ opacity: 0, y: 10 }}
        animate={{ opacity: 1, y: 0 }}
        className="bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow"
      >
        <Link href={`/property/${property.id}`} className="flex items-center p-3 gap-3">
          <div className="w-20 h-20 flex-shrink-0 bg-gradient-to-br from-orange-100 to-amber-100 rounded-lg overflow-hidden">
            {imageError || !property.images[0] ? (
              <div className="w-full h-full flex items-center justify-center">
                <svg className="w-8 h-8 text-orange-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
              </div>
            ) : (
              <img
                src={property.images[0]}
                alt={property.title}
                className="w-full h-full object-cover"
                onError={() => setImageError(true)}
              />
            )}
          </div>
          <div className="flex-1 min-w-0">
            <h4 className="font-medium text-gray-900 truncate">{property.title}</h4>
            <p className="text-sm text-gray-500 truncate">{property.city}</p>
            <div className="flex items-center justify-between mt-1">
              <span className="text-orange-500 font-semibold">
                {formatPrice(property.price, property.priceType)}
              </span>
              <span className="text-xs text-gray-500">
                {property.bedrooms} BHK • {property.area} {property.areaUnit}
              </span>
            </div>
          </div>
        </Link>
      </motion.div>
    );
  }

  // Default card variant
  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      onHoverStart={() => setIsHovered(true)}
      onHoverEnd={() => setIsHovered(false)}
      className="bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition-all duration-300"
    >
      {/* Image Container */}
      <div className="relative aspect-[4/3] overflow-hidden">
        <div className="absolute inset-0 bg-gradient-to-br from-orange-100 to-amber-100">
          {imageError || !property.images[0] ? (
            <div className="w-full h-full flex items-center justify-center">
              <svg className="w-16 h-16 text-orange-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
              </svg>
            </div>
          ) : (
            <motion.img
              animate={{ scale: isHovered ? 1.05 : 1 }}
              transition={{ duration: 0.3 }}
              src={property.images[0]}
              alt={property.title}
              className="w-full h-full object-cover"
              onError={() => setImageError(true)}
            />
          )}
        </div>

        {/* Gradient Overlay */}
        <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent" />

        {/* Badges */}
        <div className="absolute top-3 left-3 flex flex-col gap-2">
          {property.isNew && (
            <span className="px-2 py-1 bg-green-500 text-white text-xs font-medium rounded">NEW</span>
          )}
          {property.isFeatured && (
            <span className="px-2 py-1 bg-orange-500 text-white text-xs font-medium rounded">FEATURED</span>
          )}
          <span className="px-2 py-1 bg-gray-900/70 text-white text-xs font-medium rounded backdrop-blur-sm">
            {propertyTypeLabels[property.propertyType]}
          </span>
        </div>

        {/* Action Buttons */}
        <div className="absolute top-3 right-3 flex flex-col gap-2">
          {onFavorite && (
            <motion.button
              whileHover={{ scale: 1.1 }}
              whileTap={{ scale: 0.9 }}
              onClick={(e) => { e.preventDefault(); onFavorite(property.id); }}
              className={`p-2 rounded-full backdrop-blur-sm transition-colors ${
                isFavorited ? 'bg-red-500 text-white' : 'bg-white/80 text-gray-600 hover:text-red-500'
              }`}
            >
              <svg className="w-5 h-5" fill={isFavorited ? 'currentColor' : 'none'} stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
              </svg>
            </motion.button>
          )}
          {onCompare && (
            <motion.button
              whileHover={{ scale: 1.1 }}
              whileTap={{ scale: 0.9 }}
              onClick={(e) => { e.preventDefault(); onCompare(property.id); }}
              className={`p-2 rounded-full backdrop-blur-sm transition-colors ${
                isComparing ? 'bg-blue-500 text-white' : 'bg-white/80 text-gray-600 hover:text-blue-500'
              }`}
            >
              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
              </svg>
            </motion.button>
          )}
        </div>

        {/* Price Tag */}
        <div className="absolute bottom-3 left-3">
          <span className="px-3 py-1.5 bg-white rounded-lg font-bold text-gray-900 shadow-lg">
            {formatPrice(property.price, property.priceType)}
          </span>
        </div>

        {/* Vastu Badge */}
        {showVastu && (
          <div className="absolute bottom-3 right-3">
            <span className={`px-2 py-1 text-xs font-medium rounded-lg backdrop-blur-sm ${getVastuColor(property.vastu.status)}`}>
              Vastu {property.vastu.score}%
            </span>
          </div>
        )}
      </div>

      {/* Content */}
      <div className="p-4">
        <Link href={`/property/${property.id}`}>
          <h3 className="font-semibold text-gray-900 hover:text-orange-500 transition-colors line-clamp-1">
            {property.title}
          </h3>
        </Link>
        
        <p className="text-gray-500 text-sm mt-1 flex items-center line-clamp-1">
          <svg className="w-4 h-4 mr-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          {property.address}, {property.city}
        </p>

        {/* Property Details */}
        <div className="flex items-center justify-between mt-3 pt-3 border-t border-gray-100">
          <div className="flex items-center gap-3 text-sm text-gray-600">
            <span className="flex items-center">
              <svg className="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
              </svg>
              {property.bedrooms}
            </span>
            <span className="flex items-center">
              <svg className="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
              </svg>
              {property.bathrooms}
            </span>
            <span className="flex items-center">
              <svg className="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
              </svg>
              {property.area}
            </span>
          </div>

          {property.isVerified && (
            <span className="flex items-center text-xs text-green-600">
              <svg className="w-4 h-4 mr-0.5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
              Verified
            </span>
          )}
        </div>

        {/* Agent Info */}
        {showAgent && property.agent && (
          <Link
            href={`/agent/${property.agent.id}`}
            className="flex items-center gap-2 mt-3 pt-3 border-t border-gray-100 hover:text-orange-500 transition-colors"
          >
            <div className="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center">
              {property.agent.image ? (
                <img src={property.agent.image} alt={property.agent.name} className="w-full h-full object-cover rounded-full" />
              ) : (
                <span className="text-sm font-medium text-orange-500">
                  {property.agent.name[0]}
                </span>
              )}
            </div>
            <span className="text-sm text-gray-600">{property.agent.name}</span>
          </Link>
        )}
      </div>
    </motion.div>
  );
}

export default PropertyCard;
Searchfilters · TSX
'use client';

import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

export interface SearchFiltersState {
  location: string;
  propertyType: string[];
  priceRange: { min: number; max: number };
  bedrooms: string[];
  bathrooms: string[];
  areaRange: { min: number; max: number };
  vastuScore: number;
  amenities: string[];
  facing: string[];
  furnishing: string;
  possession: string;
  postedBy: string;
  sortBy: string;
}

interface SearchFiltersProps {
  filters: SearchFiltersState;
  onChange: (filters: SearchFiltersState) => void;
  onSearch: () => void;
  onReset: () => void;
  variant?: 'sidebar' | 'horizontal' | 'modal';
  isLoading?: boolean;
}

const propertyTypes = [
  { value: 'apartment', label: 'Apartment' },
  { value: 'house', label: 'House' },
  { value: 'villa', label: 'Villa' },
  { value: 'plot', label: 'Plot' },
  { value: 'commercial', label: 'Commercial' },
  { value: 'penthouse', label: 'Penthouse' },
];

const bedroomOptions = ['1', '2', '3', '4', '5+'];
const bathroomOptions = ['1', '2', '3', '4+'];

const amenitiesList = [
  'Parking', 'Swimming Pool', 'Gym', 'Garden', 'Security',
  'Power Backup', 'Lift', 'Club House', 'Children Play Area',
  'Sports Facility', 'Visitor Parking', 'Intercom', 'Gas Pipeline',
  'Rainwater Harvesting', 'Vaastu Compliant',
];

const facingOptions = ['North', 'South', 'East', 'West', 'North-East', 'North-West', 'South-East', 'South-West'];

const furnishingOptions = [
  { value: '', label: 'Any' },
  { value: 'furnished', label: 'Furnished' },
  { value: 'semi-furnished', label: 'Semi-Furnished' },
  { value: 'unfurnished', label: 'Unfurnished' },
];

const possessionOptions = [
  { value: '', label: 'Any' },
  { value: 'ready', label: 'Ready to Move' },
  { value: '3months', label: 'Within 3 Months' },
  { value: '6months', label: 'Within 6 Months' },
  { value: '1year', label: 'Within 1 Year' },
  { value: 'under-construction', label: 'Under Construction' },
];

const postedByOptions = [
  { value: '', label: 'Any' },
  { value: 'owner', label: 'Owner' },
  { value: 'agent', label: 'Agent' },
  { value: 'builder', label: 'Builder' },
];

const sortOptions = [
  { value: 'relevance', label: 'Relevance' },
  { value: 'price-low', label: 'Price: Low to High' },
  { value: 'price-high', label: 'Price: High to Low' },
  { value: 'newest', label: 'Newest First' },
  { value: 'vastu-high', label: 'Vastu Score: High' },
  { value: 'area-high', label: 'Area: Large to Small' },
];

const pricePresets = [
  { label: 'Under ₹50L', min: 0, max: 5000000 },
  { label: '₹50L - ₹1Cr', min: 5000000, max: 10000000 },
  { label: '₹1Cr - ₹2Cr', min: 10000000, max: 20000000 },
  { label: '₹2Cr - ₹5Cr', min: 20000000, max: 50000000 },
  { label: 'Above ₹5Cr', min: 50000000, max: 1000000000 },
];

const formatPrice = (value: number) => {
  if (value >= 10000000) return `₹${(value / 10000000).toFixed(1)}Cr`;
  if (value >= 100000) return `₹${(value / 100000).toFixed(0)}L`;
  return `₹${value.toLocaleString('en-IN')}`;
};

interface FilterSectionProps {
  title: string;
  children: React.ReactNode;
  defaultOpen?: boolean;
}

function FilterSection({ title, children, defaultOpen = true }: FilterSectionProps) {
  const [isOpen, setIsOpen] = useState(defaultOpen);

  return (
    <div className="border-b border-gray-100 pb-4 mb-4 last:border-0 last:pb-0 last:mb-0">
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="w-full flex items-center justify-between text-left mb-3"
      >
        <span className="font-medium text-gray-900">{title}</span>
        <motion.svg
          animate={{ rotate: isOpen ? 180 : 0 }}
          className="w-5 h-5 text-gray-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
        </motion.svg>
      </button>
      <AnimatePresence>
        {isOpen && (
          <motion.div
            initial={{ height: 0, opacity: 0 }}
            animate={{ height: 'auto', opacity: 1 }}
            exit={{ height: 0, opacity: 0 }}
            transition={{ duration: 0.2 }}
            className="overflow-hidden"
          >
            {children}
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}

export function SearchFilters({
  filters,
  onChange,
  onSearch,
  onReset,
  variant = 'sidebar',
  isLoading = false,
}: SearchFiltersProps) {
  const [localFilters, setLocalFilters] = useState(filters);
  const [showMoreAmenities, setShowMoreAmenities] = useState(false);

  useEffect(() => {
    setLocalFilters(filters);
  }, [filters]);

  const updateFilter = <K extends keyof SearchFiltersState>(
    key: K,
    value: SearchFiltersState[K]
  ) => {
    const newFilters = { ...localFilters, [key]: value };
    setLocalFilters(newFilters);
    onChange(newFilters);
  };

  const toggleArrayFilter = (key: 'propertyType' | 'bedrooms' | 'bathrooms' | 'amenities' | 'facing', value: string) => {
    const current = localFilters[key] as string[];
    const newValue = current.includes(value)
      ? current.filter(v => v !== value)
      : [...current, value];
    updateFilter(key, newValue);
  };

  const activeFilterCount = [
    localFilters.propertyType.length > 0,
    localFilters.priceRange.min > 0 || localFilters.priceRange.max < 1000000000,
    localFilters.bedrooms.length > 0,
    localFilters.bathrooms.length > 0,
    localFilters.vastuScore > 0,
    localFilters.amenities.length > 0,
    localFilters.facing.length > 0,
    localFilters.furnishing !== '',
    localFilters.possession !== '',
    localFilters.postedBy !== '',
  ].filter(Boolean).length;

  const displayedAmenities = showMoreAmenities ? amenitiesList : amenitiesList.slice(0, 8);

  if (variant === 'horizontal') {
    return (
      <div className="bg-white rounded-xl shadow-sm p-4">
        <div className="flex flex-wrap gap-4 items-center">
          {/* Location */}
          <div className="flex-1 min-w-[200px]">
            <div className="relative">
              <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              <input
                type="text"
                value={localFilters.location}
                onChange={(e) => updateFilter('location', e.target.value)}
                placeholder="Search location..."
                className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
              />
            </div>
          </div>

          {/* Property Type Dropdown */}
          <select
            value={localFilters.propertyType[0] || ''}
            onChange={(e) => updateFilter('propertyType', e.target.value ? [e.target.value] : [])}
            className="px-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white"
          >
            <option value="">Property Type</option>
            {propertyTypes.map(type => (
              <option key={type.value} value={type.value}>{type.label}</option>
            ))}
          </select>

          {/* Price Range Dropdown */}
          <select
            value={`${localFilters.priceRange.min}-${localFilters.priceRange.max}`}
            onChange={(e) => {
              const [min, max] = e.target.value.split('-').map(Number);
              updateFilter('priceRange', { min, max });
            }}
            className="px-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white"
          >
            <option value="0-1000000000">Price Range</option>
            {pricePresets.map(preset => (
              <option key={preset.label} value={`${preset.min}-${preset.max}`}>{preset.label}</option>
            ))}
          </select>

          {/* Bedrooms */}
          <select
            value={localFilters.bedrooms[0] || ''}
            onChange={(e) => updateFilter('bedrooms', e.target.value ? [e.target.value] : [])}
            className="px-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white"
          >
            <option value="">Bedrooms</option>
            {bedroomOptions.map(opt => (
              <option key={opt} value={opt}>{opt} BHK</option>
            ))}
          </select>

          {/* Search Button */}
          <button
            onClick={onSearch}
            disabled={isLoading}
            className="px-6 py-2.5 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all disabled:opacity-50"
          >
            {isLoading ? 'Searching...' : 'Search'}
          </button>
        </div>
      </div>
    );
  }

  // Sidebar variant
  return (
    <div className="bg-white rounded-xl shadow-sm p-5">
      {/* Header */}
      <div className="flex items-center justify-between mb-5">
        <h3 className="font-semibold text-gray-900">Filters</h3>
        {activeFilterCount > 0 && (
          <button
            onClick={onReset}
            className="text-sm text-orange-500 hover:text-orange-600"
          >
            Clear All ({activeFilterCount})
          </button>
        )}
      </div>

      {/* Location */}
      <FilterSection title="Location">
        <div className="relative">
          <svg className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
          <input
            type="text"
            value={localFilters.location}
            onChange={(e) => updateFilter('location', e.target.value)}
            placeholder="City, locality, or project"
            className="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"
          />
        </div>
      </FilterSection>

      {/* Property Type */}
      <FilterSection title="Property Type">
        <div className="grid grid-cols-2 gap-2">
          {propertyTypes.map(type => (
            <button
              key={type.value}
              onClick={() => toggleArrayFilter('propertyType', type.value)}
              className={`px-3 py-2 text-sm rounded-lg border transition-colors ${
                localFilters.propertyType.includes(type.value)
                  ? 'border-orange-500 bg-orange-50 text-orange-600'
                  : 'border-gray-200 hover:border-gray-300 text-gray-600'
              }`}
            >
              {type.label}
            </button>
          ))}
        </div>
      </FilterSection>

      {/* Price Range */}
      <FilterSection title="Price Range">
        <div className="space-y-4">
          <div className="flex gap-2">
            {pricePresets.slice(0, 3).map(preset => (
              <button
                key={preset.label}
                onClick={() => updateFilter('priceRange', { min: preset.min, max: preset.max })}
                className={`flex-1 px-2 py-1.5 text-xs rounded-lg border transition-colors ${
                  localFilters.priceRange.min === preset.min && localFilters.priceRange.max === preset.max
                    ? 'border-orange-500 bg-orange-50 text-orange-600'
                    : 'border-gray-200 hover:border-gray-300 text-gray-600'
                }`}
              >
                {preset.label}
              </button>
            ))}
          </div>
          <div className="flex gap-2 items-center">
            <div className="flex-1">
              <label className="text-xs text-gray-500 block mb-1">Min</label>
              <input
                type="number"
                value={localFilters.priceRange.min || ''}
                onChange={(e) => updateFilter('priceRange', { ...localFilters.priceRange, min: Number(e.target.value) })}
                placeholder="₹ Min"
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"
              />
            </div>
            <span className="text-gray-400 mt-5">-</span>
            <div className="flex-1">
              <label className="text-xs text-gray-500 block mb-1">Max</label>
              <input
                type="number"
                value={localFilters.priceRange.max < 1000000000 ? localFilters.priceRange.max : ''}
                onChange={(e) => updateFilter('priceRange', { ...localFilters.priceRange, max: Number(e.target.value) || 1000000000 })}
                placeholder="₹ Max"
                className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"
              />
            </div>
          </div>
          <div className="text-xs text-gray-500">
            {formatPrice(localFilters.priceRange.min)} - {localFilters.priceRange.max < 1000000000 ? formatPrice(localFilters.priceRange.max) : 'No Max'}
          </div>
        </div>
      </FilterSection>

      {/* Bedrooms */}
      <FilterSection title="Bedrooms">
        <div className="flex gap-2">
          {bedroomOptions.map(opt => (
            <button
              key={opt}
              onClick={() => toggleArrayFilter('bedrooms', opt)}
              className={`flex-1 px-3 py-2 text-sm rounded-lg border transition-colors ${
                localFilters.bedrooms.includes(opt)
                  ? 'border-orange-500 bg-orange-50 text-orange-600'
                  : 'border-gray-200 hover:border-gray-300 text-gray-600'
              }`}
            >
              {opt}
            </button>
          ))}
        </div>
      </FilterSection>

      {/* Bathrooms */}
      <FilterSection title="Bathrooms">
        <div className="flex gap-2">
          {bathroomOptions.map(opt => (
            <button
              key={opt}
              onClick={() => toggleArrayFilter('bathrooms', opt)}
              className={`flex-1 px-3 py-2 text-sm rounded-lg border transition-colors ${
                localFilters.bathrooms.includes(opt)
                  ? 'border-orange-500 bg-orange-50 text-orange-600'
                  : 'border-gray-200 hover:border-gray-300 text-gray-600'
              }`}
            >
              {opt}
            </button>
          ))}
        </div>
      </FilterSection>

      {/* Vastu Score */}
      <FilterSection title="Minimum Vastu Score">
        <div className="space-y-2">
          <input
            type="range"
            min="0"
            max="100"
            value={localFilters.vastuScore}
            onChange={(e) => updateFilter('vastuScore', Number(e.target.value))}
            className="w-full accent-orange-500"
          />
          <div className="flex justify-between text-sm text-gray-600">
            <span>0%</span>
            <span className="font-medium text-orange-500">{localFilters.vastuScore}%</span>
            <span>100%</span>
          </div>
        </div>
      </FilterSection>

      {/* Facing */}
      <FilterSection title="Facing" defaultOpen={false}>
        <div className="grid grid-cols-2 gap-2">
          {facingOptions.map(facing => (
            <button
              key={facing}
              onClick={() => toggleArrayFilter('facing', facing)}
              className={`px-3 py-2 text-sm rounded-lg border transition-colors ${
                localFilters.facing.includes(facing)
                  ? 'border-orange-500 bg-orange-50 text-orange-600'
                  : 'border-gray-200 hover:border-gray-300 text-gray-600'
              }`}
            >
              {facing}
            </button>
          ))}
        </div>
      </FilterSection>

      {/* Furnishing */}
      <FilterSection title="Furnishing" defaultOpen={false}>
        <select
          value={localFilters.furnishing}
          onChange={(e) => updateFilter('furnishing', e.target.value)}
          className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white"
        >
          {furnishingOptions.map(opt => (
            <option key={opt.value} value={opt.value}>{opt.label}</option>
          ))}
        </select>
      </FilterSection>

      {/* Possession */}
      <FilterSection title="Possession Status" defaultOpen={false}>
        <select
          value={localFilters.possession}
          onChange={(e) => updateFilter('possession', e.target.value)}
          className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white"
        >
          {possessionOptions.map(opt => (
            <option key={opt.value} value={opt.value}>{opt.label}</option>
          ))}
        </select>
      </FilterSection>

      {/* Posted By */}
      <FilterSection title="Posted By" defaultOpen={false}>
        <div className="flex gap-2">
          {postedByOptions.slice(1).map(opt => (
            <button
              key={opt.value}
              onClick={() => updateFilter('postedBy', localFilters.postedBy === opt.value ? '' : opt.value)}
              className={`flex-1 px-3 py-2 text-sm rounded-lg border transition-colors ${
                localFilters.postedBy === opt.value
                  ? 'border-orange-500 bg-orange-50 text-orange-600'
                  : 'border-gray-200 hover:border-gray-300 text-gray-600'
              }`}
            >
              {opt.label}
            </button>
          ))}
        </div>
      </FilterSection>

      {/* Amenities */}
      <FilterSection title="Amenities" defaultOpen={false}>
        <div className="space-y-2">
          <div className="flex flex-wrap gap-2">
            {displayedAmenities.map(amenity => (
              <button
                key={amenity}
                onClick={() => toggleArrayFilter('amenities', amenity)}
                className={`px-3 py-1.5 text-sm rounded-full border transition-colors ${
                  localFilters.amenities.includes(amenity)
                    ? 'border-orange-500 bg-orange-50 text-orange-600'
                    : 'border-gray-200 hover:border-gray-300 text-gray-600'
                }`}
              >
                {amenity}
              </button>
            ))}
          </div>
          {amenitiesList.length > 8 && (
            <button
              onClick={() => setShowMoreAmenities(!showMoreAmenities)}
              className="text-sm text-orange-500 hover:text-orange-600"
            >
              {showMoreAmenities ? 'Show Less' : `+${amenitiesList.length - 8} More`}
            </button>
          )}
        </div>
      </FilterSection>

      {/* Apply Button */}
      <button
        onClick={onSearch}
        disabled={isLoading}
        className="w-full py-3 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-amber-600 transition-all disabled:opacity-50 mt-4"
      >
        {isLoading ? (
          <span className="flex items-center justify-center">
            <svg className="animate-spin -ml-1 mr-2 h-5 w-5 text-white" fill="none" viewBox="0 0 24 24">
              <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
              <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
            </svg>
            Searching...
          </span>
        ) : (
          'Apply Filters'
        )}
      </button>
    </div>
  );
}

export default SearchFilters;
Toast · TSX
'use client';

import { createContext, useContext, useState, useCallback, ReactNode } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

type ToastType = 'success' | 'error' | 'warning' | 'info';

interface Toast {
  id: string;
  type: ToastType;
  title: string;
  message?: string;
  duration?: number;
  action?: {
    label: string;
    onClick: () => void;
  };
}

interface ToastContextType {
  toasts: Toast[];
  addToast: (toast: Omit<Toast, 'id'>) => void;
  removeToast: (id: string) => void;
  success: (title: string, message?: string) => void;
  error: (title: string, message?: string) => void;
  warning: (title: string, message?: string) => void;
  info: (title: string, message?: string) => void;
}

const ToastContext = createContext<ToastContextType | undefined>(undefined);

export function useToast() {
  const context = useContext(ToastContext);
  if (!context) {
    throw new Error('useToast must be used within a ToastProvider');
  }
  return context;
}

const icons: Record<ToastType, ReactNode> = {
  success: (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
    </svg>
  ),
  error: (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
    </svg>
  ),
  warning: (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
    </svg>
  ),
  info: (
    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
  ),
};

const colors: Record<ToastType, { bg: string; icon: string; border: string }> = {
  success: { bg: 'bg-green-50', icon: 'text-green-500', border: 'border-green-200' },
  error: { bg: 'bg-red-50', icon: 'text-red-500', border: 'border-red-200' },
  warning: { bg: 'bg-yellow-50', icon: 'text-yellow-500', border: 'border-yellow-200' },
  info: { bg: 'bg-blue-50', icon: 'text-blue-500', border: 'border-blue-200' },
};

interface ToastItemProps {
  toast: Toast;
  onClose: () => void;
}

function ToastItem({ toast, onClose }: ToastItemProps) {
  const { type, title, message, action } = toast;
  const color = colors[type];

  return (
    <motion.div
      initial={{ opacity: 0, x: 100, scale: 0.9 }}
      animate={{ opacity: 1, x: 0, scale: 1 }}
      exit={{ opacity: 0, x: 100, scale: 0.9 }}
      transition={{ type: 'spring', stiffness: 500, damping: 30 }}
      className={`${color.bg} ${color.border} border rounded-xl shadow-lg p-4 max-w-sm w-full pointer-events-auto`}
    >
      <div className="flex items-start gap-3">
        <div className={`flex-shrink-0 ${color.icon}`}>
          {icons[type]}
        </div>
        <div className="flex-1 min-w-0">
          <h4 className="text-sm font-medium text-gray-900">{title}</h4>
          {message && (
            <p className="text-sm text-gray-600 mt-1">{message}</p>
          )}
          {action && (
            <button
              onClick={() => {
                action.onClick();
                onClose();
              }}
              className="text-sm font-medium text-orange-500 hover:text-orange-600 mt-2"
            >
              {action.label}
            </button>
          )}
        </div>
        <button
          onClick={onClose}
          className="flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors"
        >
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </motion.div>
  );
}

interface ToastProviderProps {
  children: ReactNode;
  position?: 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left' | 'top-center' | 'bottom-center';
}

export function ToastProvider({ children, position = 'top-right' }: ToastProviderProps) {
  const [toasts, setToasts] = useState<Toast[]>([]);

  const removeToast = useCallback((id: string) => {
    setToasts(prev => prev.filter(t => t.id !== id));
  }, []);

  const addToast = useCallback((toast: Omit<Toast, 'id'>) => {
    const id = Math.random().toString(36).substring(2, 9);
    const newToast = { ...toast, id };
    
    setToasts(prev => [...prev, newToast]);

    // Auto remove after duration (default 5 seconds)
    const duration = toast.duration ?? 5000;
    if (duration > 0) {
      setTimeout(() => {
        removeToast(id);
      }, duration);
    }
  }, [removeToast]);

  const success = useCallback((title: string, message?: string) => {
    addToast({ type: 'success', title, message });
  }, [addToast]);

  const error = useCallback((title: string, message?: string) => {
    addToast({ type: 'error', title, message });
  }, [addToast]);

  const warning = useCallback((title: string, message?: string) => {
    addToast({ type: 'warning', title, message });
  }, [addToast]);

  const info = useCallback((title: string, message?: string) => {
    addToast({ type: 'info', title, message });
  }, [addToast]);

  const positionClasses: Record<string, string> = {
    'top-right': 'top-4 right-4',
    'top-left': 'top-4 left-4',
    'bottom-right': 'bottom-4 right-4',
    'bottom-left': 'bottom-4 left-4',
    'top-center': 'top-4 left-1/2 -translate-x-1/2',
    'bottom-center': 'bottom-4 left-1/2 -translate-x-1/2',
  };

  return (
    <ToastContext.Provider value={{ toasts, addToast, removeToast, success, error, warning, info }}>
      {children}
      
      {/* Toast Container */}
      <div
        className={`fixed z-50 ${positionClasses[position]} pointer-events-none`}
        aria-live="polite"
      >
        <div className="flex flex-col gap-3">
          <AnimatePresence mode="popLayout">
            {toasts.map(toast => (
              <ToastItem
                key={toast.id}
                toast={toast}
                onClose={() => removeToast(toast.id)}
              />
            ))}
          </AnimatePresence>
        </div>
      </div>
    </ToastContext.Provider>
  );
}

// Standalone toast function (requires ToastProvider in app)
export const toast = {
  success: (title: string, message?: string) => {
    // This will be connected via context
    console.log('Toast success:', title, message);
  },
  error: (title: string, message?: string) => {
    console.log('Toast error:', title, message);
  },
  warning: (title: string, message?: string) => {
    console.log('Toast warning:', title, message);
  },
  info: (title: string, message?: string) => {
    console.log('Toast info:', title, message);
  },
};

export default ToastProvider;


















Mapview · TSX
'use client';

import { useState, useEffect, useCallback, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// Property marker interface
interface PropertyMarker {
  id: string;
  position: { lat: number; lng: number };
  title: string;
  price: number;
  priceType: 'sale' | 'rent';
  propertyType: string;
  bedrooms?: number;
  image?: string;
  vastuScore?: number;
  isSelected?: boolean;
}

// Map configuration
interface MapConfig {
  center: { lat: number; lng: number };
  zoom: number;
  minZoom?: number;
  maxZoom?: number;
  mapTypeId?: 'roadmap' | 'satellite' | 'hybrid' | 'terrain';
  styles?: google.maps.MapTypeStyle[];
}

// Component props
interface MapViewProps {
  markers?: PropertyMarker[];
  config?: Partial<MapConfig>;
  onMarkerClick?: (marker: PropertyMarker) => void;
  onMapClick?: (position: { lat: number; lng: number }) => void;
  onBoundsChange?: (bounds: { ne: { lat: number; lng: number }; sw: { lat: number; lng: number } }) => void;
  showClustering?: boolean;
  showDrawingTools?: boolean;
  showPropertyCards?: boolean;
  selectedMarkerId?: string;
  height?: string;
  className?: string;
}

// Default map configuration (centered on Mumbai)
const defaultConfig: MapConfig = {
  center: { lat: 19.0760, lng: 72.8777 },
  zoom: 12,
  minZoom: 4,
  maxZoom: 20,
  mapTypeId: 'roadmap',
  styles: [
    {
      featureType: 'poi',
      elementType: 'labels',
      stylers: [{ visibility: 'off' }],
    },
    {
      featureType: 'transit',
      elementType: 'labels',
      stylers: [{ visibility: 'off' }],
    },
  ],
};

// Format price for display
const formatPrice = (price: number, type: 'sale' | 'rent'): string => {
  if (type === 'rent') {
    return `₹${(price / 1000).toFixed(0)}K/mo`;
  }
  if (price >= 10000000) {
    return `₹${(price / 10000000).toFixed(1)}Cr`;
  }
  if (price >= 100000) {
    return `₹${(price / 100000).toFixed(0)}L`;
  }
  return `₹${price.toLocaleString('en-IN')}`;
};

// Property info card component
const PropertyInfoCard = ({
  marker,
  onClose,
  onViewDetails,
}: {
  marker: PropertyMarker;
  onClose: () => void;
  onViewDetails: () => void;
}) => {
  return (
    <motion.div
      initial={{ opacity: 0, y: 10, scale: 0.95 }}
      animate={{ opacity: 1, y: 0, scale: 1 }}
      exit={{ opacity: 0, y: 10, scale: 0.95 }}
      className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden z-50"
    >
      {/* Image */}
      <div className="relative h-32">
        {marker.image ? (
          <img
            src={marker.image}
            alt={marker.title}
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="w-full h-full bg-gradient-to-br from-orange-100 to-amber-100 flex items-center justify-center">
            <svg className="w-12 h-12 text-orange-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
          </div>
        )}
        
        {/* Close button */}
        <button
          onClick={onClose}
          className="absolute top-2 right-2 w-6 h-6 bg-black/50 hover:bg-black/70 rounded-full flex items-center justify-center text-white transition-colors"
        >
          <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
        
        {/* Price tag */}
        <div className="absolute bottom-2 left-2 px-2 py-1 bg-gradient-to-r from-orange-500 to-amber-500 text-white text-sm font-bold rounded">
          {formatPrice(marker.price, marker.priceType)}
        </div>
        
        {/* Vastu score */}
        {marker.vastuScore && (
          <div className={`absolute bottom-2 right-2 px-2 py-1 text-xs font-medium rounded ${
            marker.vastuScore >= 80 ? 'bg-green-500 text-white' :
            marker.vastuScore >= 60 ? 'bg-yellow-500 text-white' :
            'bg-red-500 text-white'
          }`}>
            Vastu {marker.vastuScore}%
          </div>
        )}
      </div>
      
      {/* Content */}
      <div className="p-3">
        <h3 className="font-semibold text-gray-900 text-sm line-clamp-1">{marker.title}</h3>
        <div className="flex items-center gap-2 mt-1 text-xs text-gray-500">
          <span className="capitalize">{marker.propertyType}</span>
          {marker.bedrooms && (
            <>
              <span>•</span>
              <span>{marker.bedrooms} BHK</span>
            </>
          )}
        </div>
        
        <button
          onClick={onViewDetails}
          className="w-full mt-3 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white text-sm font-medium rounded-lg hover:from-orange-600 hover:to-amber-600 transition-all"
        >
          View Details
        </button>
      </div>
    </motion.div>
  );
};

// Custom marker component (for when not using Google Maps directly)
const CustomMarker = ({
  marker,
  isSelected,
  onClick,
  onViewDetails,
  onClose,
}: {
  marker: PropertyMarker;
  isSelected: boolean;
  onClick: () => void;
  onViewDetails: () => void;
  onClose: () => void;
}) => {
  return (
    <div className="relative">
      {/* Marker pin */}
      <motion.button
        whileHover={{ scale: 1.1 }}
        whileTap={{ scale: 0.95 }}
        onClick={onClick}
        className={`relative flex items-center justify-center ${
          isSelected ? 'z-40' : 'z-10'
        }`}
      >
        <div className={`px-2 py-1 rounded-full font-bold text-xs shadow-lg transition-all ${
          isSelected
            ? 'bg-orange-500 text-white scale-110'
            : 'bg-white text-gray-900 hover:bg-orange-50'
        }`}>
          {formatPrice(marker.price, marker.priceType)}
        </div>
        {/* Pin tail */}
        <div className={`absolute -bottom-1.5 left-1/2 -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent ${
          isSelected ? 'border-t-orange-500' : 'border-t-white'
        }`} />
      </motion.button>
      
      {/* Info card */}
      <AnimatePresence>
        {isSelected && (
          <PropertyInfoCard
            marker={marker}
            onClose={onClose}
            onViewDetails={onViewDetails}
          />
        )}
      </AnimatePresence>
    </div>
  );
};

// Map controls component
const MapControls = ({
  onZoomIn,
  onZoomOut,
  onRecenter,
  onToggleMapType,
  onToggleFullscreen,
  mapType,
  isFullscreen,
}: {
  onZoomIn: () => void;
  onZoomOut: () => void;
  onRecenter: () => void;
  onToggleMapType: () => void;
  onToggleFullscreen: () => void;
  mapType: string;
  isFullscreen: boolean;
}) => {
  return (
    <div className="absolute right-4 top-4 flex flex-col gap-2">
      {/* Zoom controls */}
      <div className="bg-white rounded-lg shadow-lg overflow-hidden">
        <button
          onClick={onZoomIn}
          className="w-10 h-10 flex items-center justify-center hover:bg-gray-100 transition-colors border-b border-gray-200"
          title="Zoom in"
        >
          <svg className="w-5 h-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
          </svg>
        </button>
        <button
          onClick={onZoomOut}
          className="w-10 h-10 flex items-center justify-center hover:bg-gray-100 transition-colors"
          title="Zoom out"
        >
          <svg className="w-5 h-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20 12H4" />
          </svg>
        </button>
      </div>
      
      {/* Other controls */}
      <button
        onClick={onRecenter}
        className="w-10 h-10 bg-white rounded-lg shadow-lg flex items-center justify-center hover:bg-gray-100 transition-colors"
        title="Recenter map"
      >
        <svg className="w-5 h-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
      </button>
      
      <button
        onClick={onToggleMapType}
        className="w-10 h-10 bg-white rounded-lg shadow-lg flex items-center justify-center hover:bg-gray-100 transition-colors"
        title={mapType === 'roadmap' ? 'Satellite view' : 'Map view'}
      >
        <svg className="w-5 h-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
        </svg>
      </button>
      
      <button
        onClick={onToggleFullscreen}
        className="w-10 h-10 bg-white rounded-lg shadow-lg flex items-center justify-center hover:bg-gray-100 transition-colors"
        title={isFullscreen ? 'Exit fullscreen' : 'Fullscreen'}
      >
        {isFullscreen ? (
          <svg className="w-5 h-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        ) : (
          <svg className="w-5 h-5 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
          </svg>
        )}
      </button>
    </div>
  );
};

// Drawing tools component
const DrawingTools = ({
  onDrawPolygon,
  onDrawCircle,
  onClearDrawing,
  isDrawing,
  hasDrawing,
}: {
  onDrawPolygon: () => void;
  onDrawCircle: () => void;
  onClearDrawing: () => void;
  isDrawing: boolean;
  hasDrawing: boolean;
}) => {
  return (
    <div className="absolute left-4 top-4 flex flex-col gap-2">
      <div className="bg-white rounded-lg shadow-lg p-2">
        <p className="text-xs text-gray-500 mb-2 px-1">Draw to search</p>
        <div className="flex gap-1">
          <button
            onClick={onDrawPolygon}
            className={`p-2 rounded transition-colors ${
              isDrawing ? 'bg-orange-100 text-orange-600' : 'hover:bg-gray-100 text-gray-700'
            }`}
            title="Draw polygon"
          >
            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 3l14 9-14 9V3z" />
            </svg>
          </button>
          <button
            onClick={onDrawCircle}
            className={`p-2 rounded transition-colors ${
              isDrawing ? 'bg-orange-100 text-orange-600' : 'hover:bg-gray-100 text-gray-700'
            }`}
            title="Draw circle"
          >
            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <circle cx="12" cy="12" r="9" strokeWidth={2} />
            </svg>
          </button>
          {hasDrawing && (
            <button
              onClick={onClearDrawing}
              className="p-2 rounded hover:bg-red-50 text-red-500 transition-colors"
              title="Clear drawing"
            >
              <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          )}
        </div>
      </div>
    </div>
  );
};

// Legend component
const MapLegend = () => {
  return (
    <div className="absolute bottom-4 left-4 bg-white rounded-lg shadow-lg p-3">
      <p className="text-xs font-medium text-gray-700 mb-2">Vastu Score</p>
      <div className="flex flex-col gap-1">
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded-full bg-green-500" />
          <span className="text-xs text-gray-600">80-100% (Excellent)</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded-full bg-yellow-500" />
          <span className="text-xs text-gray-600">60-79% (Good)</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded-full bg-red-500" />
          <span className="text-xs text-gray-600">0-59% (Needs Work)</span>
        </div>
      </div>
    </div>
  );
};

// Main MapView component
export default function MapView({
  markers = [],
  config = {},
  onMarkerClick,
  onMapClick,
  onBoundsChange,
  showClustering = true,
  showDrawingTools = false,
  showPropertyCards = true,
  selectedMarkerId,
  height = '500px',
  className = '',
}: MapViewProps) {
  const mapRef = useRef<HTMLDivElement>(null);
  const [mapInstance, setMapInstance] = useState<google.maps.Map | null>(null);
  const [selectedMarker, setSelectedMarker] = useState<string | null>(selectedMarkerId || null);
  const [mapType, setMapType] = useState<string>(config.mapTypeId || 'roadmap');
  const [isFullscreen, setIsFullscreen] = useState(false);
  const [isDrawing, setIsDrawing] = useState(false);
  const [hasDrawing, setHasDrawing] = useState(false);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  
  const mergedConfig = { ...defaultConfig, ...config };
  
  // Initialize map (placeholder - would use Google Maps API in production)
  useEffect(() => {
    // Simulate loading
    const timer = setTimeout(() => {
      setIsLoading(false);
    }, 1000);
    
    return () => clearTimeout(timer);
  }, []);
  
  // Update selected marker when prop changes
  useEffect(() => {
    setSelectedMarker(selectedMarkerId || null);
  }, [selectedMarkerId]);
  
  // Handle marker click
  const handleMarkerClick = useCallback((marker: PropertyMarker) => {
    setSelectedMarker(marker.id);
    onMarkerClick?.(marker);
  }, [onMarkerClick]);
  
  // Handle view details
  const handleViewDetails = useCallback((marker: PropertyMarker) => {
    // Navigate to property page
    window.location.href = `/property/${marker.id}`;
  }, []);
  
  // Map control handlers
  const handleZoomIn = useCallback(() => {
    if (mapInstance) {
      const currentZoom = mapInstance.getZoom() || mergedConfig.zoom;
      mapInstance.setZoom(Math.min(currentZoom + 1, mergedConfig.maxZoom || 20));
    }
  }, [mapInstance, mergedConfig]);
  
  const handleZoomOut = useCallback(() => {
    if (mapInstance) {
      const currentZoom = mapInstance.getZoom() || mergedConfig.zoom;
      mapInstance.setZoom(Math.max(currentZoom - 1, mergedConfig.minZoom || 4));
    }
  }, [mapInstance, mergedConfig]);
  
  const handleRecenter = useCallback(() => {
    if (mapInstance) {
      mapInstance.setCenter(mergedConfig.center);
      mapInstance.setZoom(mergedConfig.zoom);
    }
  }, [mapInstance, mergedConfig]);
  
  const handleToggleMapType = useCallback(() => {
    const newType = mapType === 'roadmap' ? 'satellite' : 'roadmap';
    setMapType(newType);
    if (mapInstance) {
      mapInstance.setMapTypeId(newType);
    }
  }, [mapInstance, mapType]);
  
  const handleToggleFullscreen = useCallback(() => {
    if (!mapRef.current) return;
    
    if (!isFullscreen) {
      if (mapRef.current.requestFullscreen) {
        mapRef.current.requestFullscreen();
      }
    } else {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      }
    }
    setIsFullscreen(!isFullscreen);
  }, [isFullscreen]);
  
  // Drawing handlers
  const handleDrawPolygon = useCallback(() => {
    setIsDrawing(!isDrawing);
  }, [isDrawing]);
  
  const handleDrawCircle = useCallback(() => {
    setIsDrawing(!isDrawing);
  }, [isDrawing]);
  
  const handleClearDrawing = useCallback(() => {
    setHasDrawing(false);
    setIsDrawing(false);
  }, []);
  
  // Loading state
  if (isLoading) {
    return (
      <div 
        className={`relative bg-gray-100 rounded-xl overflow-hidden ${className}`}
        style={{ height }}
      >
        <div className="absolute inset-0 flex items-center justify-center">
          <div className="text-center">
            <div className="w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4" />
            <p className="text-gray-600">Loading map...</p>
          </div>
        </div>
      </div>
    );
  }
  
  // Error state
  if (error) {
    return (
      <div 
        className={`relative bg-gray-100 rounded-xl overflow-hidden ${className}`}
        style={{ height }}
      >
        <div className="absolute inset-0 flex items-center justify-center">
          <div className="text-center p-6">
            <svg className="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
            </svg>
            <p className="text-gray-600 mb-4">{error}</p>
            <button
              onClick={() => window.location.reload()}
              className="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors"
            >
              Retry
            </button>
          </div>
        </div>
      </div>
    );
  }
  
  return (
    <div 
      ref={mapRef}
      className={`relative bg-gray-200 rounded-xl overflow-hidden ${className}`}
      style={{ height }}
    >
      {/* Map placeholder - would be replaced with actual Google Maps in production */}
      <div className="absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200">
        {/* Grid pattern to simulate map */}
        <div className="absolute inset-0 opacity-30" style={{
          backgroundImage: `
            linear-gradient(to right, #d1d5db 1px, transparent 1px),
            linear-gradient(to bottom, #d1d5db 1px, transparent 1px)
          `,
          backgroundSize: '50px 50px',
        }} />
        
        {/* Markers */}
        <div className="absolute inset-0">
          {markers.map((marker, index) => {
            // Calculate position based on lat/lng (simplified for demo)
            const x = ((marker.position.lng - mergedConfig.center.lng + 0.5) / 1) * 100;
            const y = ((mergedConfig.center.lat - marker.position.lat + 0.5) / 1) * 100;
            
            return (
              <div
                key={marker.id}
                className="absolute transform -translate-x-1/2 -translate-y-full"
                style={{
                  left: `${Math.min(Math.max(x, 10), 90)}%`,
                  top: `${Math.min(Math.max(y, 15), 85)}%`,
                }}
              >
                <CustomMarker
                  marker={marker}
                  isSelected={selectedMarker === marker.id}
                  onClick={() => handleMarkerClick(marker)}
                  onViewDetails={() => handleViewDetails(marker)}
                  onClose={() => setSelectedMarker(null)}
                />
              </div>
            );
          })}
        </div>
        
        {/* No markers message */}
        {markers.length === 0 && (
          <div className="absolute inset-0 flex items-center justify-center">
            <div className="text-center p-6">
              <svg className="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              <p className="text-gray-600">No properties in this area</p>
              <p className="text-sm text-gray-500 mt-1">Try adjusting your search filters</p>
            </div>
          </div>
        )}
      </div>
      
      {/* Map controls */}
      <MapControls
        onZoomIn={handleZoomIn}
        onZoomOut={handleZoomOut}
        onRecenter={handleRecenter}
        onToggleMapType={handleToggleMapType}
        onToggleFullscreen={handleToggleFullscreen}
        mapType={mapType}
        isFullscreen={isFullscreen}
      />
      
      {/* Drawing tools */}
      {showDrawingTools && (
        <DrawingTools
          onDrawPolygon={handleDrawPolygon}
          onDrawCircle={handleDrawCircle}
          onClearDrawing={handleClearDrawing}
          isDrawing={isDrawing}
          hasDrawing={hasDrawing}
        />
      )}
      
      {/* Legend */}
      <MapLegend />
      
      {/* Property count badge */}
      <div className="absolute top-4 left-1/2 -translate-x-1/2 bg-white rounded-full px-4 py-2 shadow-lg">
        <span className="text-sm font-medium text-gray-700">
          {markers.length} {markers.length === 1 ? 'property' : 'properties'} found
        </span>
      </div>
    </div>
  );
}

// Export types
export type { PropertyMarker, MapConfig, MapViewProps };
Calendar · TSX
'use client';

import { useState, useCallback, useMemo } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// Event interface
interface CalendarEvent {
  id: string;
  title: string;
  date: Date;
  startTime?: string; // HH:mm format
  endTime?: string;
  type: 'showing' | 'open-house' | 'meeting' | 'inspection' | 'signing' | 'other';
  location?: string;
  description?: string;
  attendees?: string[];
  propertyId?: string;
  propertyTitle?: string;
  status?: 'confirmed' | 'pending' | 'cancelled';
  color?: string;
}

// Time slot interface
interface TimeSlot {
  time: string;
  label: string;
  available: boolean;
}

// Component props
interface CalendarProps {
  events?: CalendarEvent[];
  onDateSelect?: (date: Date) => void;
  onEventClick?: (event: CalendarEvent) => void;
  onTimeSlotSelect?: (date: Date, time: string) => void;
  selectedDate?: Date;
  view?: 'month' | 'week' | 'day';
  showTimeSlots?: boolean;
  availableSlots?: TimeSlot[];
  minDate?: Date;
  maxDate?: Date;
  disabledDates?: Date[];
  className?: string;
}

// Constants
const DAYS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
const MONTHS = [
  'January', 'February', 'March', 'April', 'May', 'June',
  'July', 'August', 'September', 'October', 'November', 'December'
];

// Event type colors
const eventTypeColors: Record<string, { bg: string; text: string; border: string }> = {
  showing: { bg: 'bg-blue-100', text: 'text-blue-700', border: 'border-blue-300' },
  'open-house': { bg: 'bg-green-100', text: 'text-green-700', border: 'border-green-300' },
  meeting: { bg: 'bg-purple-100', text: 'text-purple-700', border: 'border-purple-300' },
  inspection: { bg: 'bg-orange-100', text: 'text-orange-700', border: 'border-orange-300' },
  signing: { bg: 'bg-amber-100', text: 'text-amber-700', border: 'border-amber-300' },
  other: { bg: 'bg-gray-100', text: 'text-gray-700', border: 'border-gray-300' },
};

// Default time slots
const defaultTimeSlots: TimeSlot[] = [
  { time: '09:00', label: '9:00 AM', available: true },
  { time: '10:00', label: '10:00 AM', available: true },
  { time: '11:00', label: '11:00 AM', available: true },
  { time: '12:00', label: '12:00 PM', available: true },
  { time: '14:00', label: '2:00 PM', available: true },
  { time: '15:00', label: '3:00 PM', available: true },
  { time: '16:00', label: '4:00 PM', available: true },
  { time: '17:00', label: '5:00 PM', available: true },
  { time: '18:00', label: '6:00 PM', available: true },
];

// Helper functions
const isSameDay = (date1: Date, date2: Date): boolean => {
  return (
    date1.getFullYear() === date2.getFullYear() &&
    date1.getMonth() === date2.getMonth() &&
    date1.getDate() === date2.getDate()
  );
};

const isToday = (date: Date): boolean => {
  return isSameDay(date, new Date());
};

const isDateDisabled = (date: Date, minDate?: Date, maxDate?: Date, disabledDates?: Date[]): boolean => {
  if (minDate && date < minDate) return true;
  if (maxDate && date > maxDate) return true;
  if (disabledDates?.some(d => isSameDay(d, date))) return true;
  return false;
};

const getDaysInMonth = (year: number, month: number): number => {
  return new Date(year, month + 1, 0).getDate();
};

const getFirstDayOfMonth = (year: number, month: number): number => {
  return new Date(year, month, 1).getDay();
};

const formatTime = (time: string): string => {
  const [hours, minutes] = time.split(':').map(Number);
  const period = hours >= 12 ? 'PM' : 'AM';
  const displayHours = hours % 12 || 12;
  return `${displayHours}:${minutes.toString().padStart(2, '0')} ${period}`;
};

// Event card component
const EventCard = ({
  event,
  onClick,
  compact = false,
}: {
  event: CalendarEvent;
  onClick: () => void;
  compact?: boolean;
}) => {
  const colors = eventTypeColors[event.type] || eventTypeColors.other;
  
  if (compact) {
    return (
      <button
        onClick={onClick}
        className={`w-full text-left px-1.5 py-0.5 rounded text-xs truncate ${colors.bg} ${colors.text} hover:opacity-80 transition-opacity`}
      >
        {event.startTime && <span className="font-medium">{formatTime(event.startTime)} </span>}
        {event.title}
      </button>
    );
  }
  
  return (
    <motion.button
      whileHover={{ scale: 1.02 }}
      whileTap={{ scale: 0.98 }}
      onClick={onClick}
      className={`w-full text-left p-3 rounded-lg border ${colors.bg} ${colors.border} hover:shadow-md transition-all`}
    >
      <div className="flex items-start justify-between gap-2">
        <div className="flex-1 min-w-0">
          <p className={`font-medium ${colors.text} truncate`}>{event.title}</p>
          {event.startTime && (
            <p className="text-sm text-gray-600 mt-0.5">
              {formatTime(event.startTime)}
              {event.endTime && ` - ${formatTime(event.endTime)}`}
            </p>
          )}
          {event.location && (
            <p className="text-sm text-gray-500 mt-1 truncate flex items-center gap-1">
              <svg className="w-3.5 h-3.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              </svg>
              {event.location}
            </p>
          )}
        </div>
        {event.status && (
          <span className={`flex-shrink-0 px-2 py-0.5 rounded-full text-xs font-medium ${
            event.status === 'confirmed' ? 'bg-green-100 text-green-700' :
            event.status === 'pending' ? 'bg-yellow-100 text-yellow-700' :
            'bg-red-100 text-red-700'
          }`}>
            {event.status}
          </span>
        )}
      </div>
    </motion.button>
  );
};

// Event detail modal
const EventDetailModal = ({
  event,
  onClose,
}: {
  event: CalendarEvent;
  onClose: () => void;
}) => {
  const colors = eventTypeColors[event.type] || eventTypeColors.other;
  
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"
      onClick={onClose}
    >
      <motion.div
        initial={{ scale: 0.95, opacity: 0 }}
        animate={{ scale: 1, opacity: 1 }}
        exit={{ scale: 0.95, opacity: 0 }}
        className="bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden"
        onClick={e => e.stopPropagation()}
      >
        {/* Header */}
        <div className={`p-4 ${colors.bg}`}>
          <div className="flex items-start justify-between">
            <div>
              <span className={`inline-block px-2 py-0.5 rounded text-xs font-medium ${colors.text} bg-white/50 capitalize mb-2`}>
                {event.type.replace('-', ' ')}
              </span>
              <h3 className={`text-lg font-semibold ${colors.text}`}>{event.title}</h3>
            </div>
            <button
              onClick={onClose}
              className="p-1 hover:bg-white/30 rounded transition-colors"
            >
              <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>
        
        {/* Content */}
        <div className="p-4 space-y-4">
          {/* Date and time */}
          <div className="flex items-center gap-3">
            <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
              <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
            <div>
              <p className="font-medium text-gray-900">
                {event.date.toLocaleDateString('en-IN', {
                  weekday: 'long',
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </p>
              {event.startTime && (
                <p className="text-sm text-gray-500">
                  {formatTime(event.startTime)}
                  {event.endTime && ` - ${formatTime(event.endTime)}`}
                </p>
              )}
            </div>
          </div>
          
          {/* Location */}
          {event.location && (
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                </svg>
              </div>
              <div>
                <p className="font-medium text-gray-900">{event.location}</p>
                <button className="text-sm text-orange-500 hover:underline">Get directions</button>
              </div>
            </div>
          )}
          
          {/* Property */}
          {event.propertyTitle && (
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
              </div>
              <div>
                <p className="font-medium text-gray-900">{event.propertyTitle}</p>
                <button className="text-sm text-orange-500 hover:underline">View property</button>
              </div>
            </div>
          )}
          
          {/* Description */}
          {event.description && (
            <div className="p-3 bg-gray-50 rounded-lg">
              <p className="text-sm text-gray-600">{event.description}</p>
            </div>
          )}
          
          {/* Attendees */}
          {event.attendees && event.attendees.length > 0 && (
            <div>
              <p className="text-sm font-medium text-gray-700 mb-2">Attendees</p>
              <div className="flex flex-wrap gap-2">
                {event.attendees.map((attendee, index) => (
                  <span
                    key={index}
                    className="px-2 py-1 bg-gray-100 rounded-full text-sm text-gray-700"
                  >
                    {attendee}
                  </span>
                ))}
              </div>
            </div>
          )}
          
          {/* Status */}
          {event.status && (
            <div className={`p-3 rounded-lg ${
              event.status === 'confirmed' ? 'bg-green-50 text-green-700' :
              event.status === 'pending' ? 'bg-yellow-50 text-yellow-700' :
              'bg-red-50 text-red-700'
            }`}>
              <div className="flex items-center gap-2">
                {event.status === 'confirmed' && (
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                  </svg>
                )}
                {event.status === 'pending' && (
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                )}
                {event.status === 'cancelled' && (
                  <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                )}
                <span className="font-medium capitalize">{event.status}</span>
              </div>
            </div>
          )}
        </div>
        
        {/* Actions */}
        <div className="p-4 border-t border-gray-100 flex gap-3">
          <button
            onClick={onClose}
            className="flex-1 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
          >
            Close
          </button>
          {event.status !== 'cancelled' && (
            <button className="flex-1 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg hover:from-orange-600 hover:to-amber-600 transition-colors">
              {event.type === 'showing' ? 'Join Showing' : 
               event.type === 'meeting' ? 'Join Meeting' : 
               'View Details'}
            </button>
          )}
        </div>
      </motion.div>
    </motion.div>
  );
};

// Time slot picker component
const TimeSlotPicker = ({
  slots,
  selectedTime,
  onSelectTime,
}: {
  slots: TimeSlot[];
  selectedTime?: string;
  onSelectTime: (time: string) => void;
}) => {
  return (
    <div className="grid grid-cols-3 gap-2">
      {slots.map(slot => (
        <button
          key={slot.time}
          onClick={() => slot.available && onSelectTime(slot.time)}
          disabled={!slot.available}
          className={`py-2 px-3 rounded-lg text-sm font-medium transition-all ${
            !slot.available
              ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
              : selectedTime === slot.time
              ? 'bg-gradient-to-r from-orange-500 to-amber-500 text-white shadow-md'
              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
          }`}
        >
          {slot.label}
        </button>
      ))}
    </div>
  );
};

// Main Calendar component
export default function Calendar({
  events = [],
  onDateSelect,
  onEventClick,
  onTimeSlotSelect,
  selectedDate: propSelectedDate,
  view = 'month',
  showTimeSlots = false,
  availableSlots = defaultTimeSlots,
  minDate,
  maxDate,
  disabledDates,
  className = '',
}: CalendarProps) {
  const [currentDate, setCurrentDate] = useState(new Date());
  const [selectedDate, setSelectedDate] = useState<Date | null>(propSelectedDate || null);
  const [selectedTime, setSelectedTime] = useState<string | undefined>();
  const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null);
  const [currentView, setCurrentView] = useState(view);
  
  const currentYear = currentDate.getFullYear();
  const currentMonth = currentDate.getMonth();
  
  // Get calendar days
  const calendarDays = useMemo(() => {
    const daysInMonth = getDaysInMonth(currentYear, currentMonth);
    const firstDay = getFirstDayOfMonth(currentYear, currentMonth);
    const days: (Date | null)[] = [];
    
    // Previous month days
    for (let i = 0; i < firstDay; i++) {
      days.push(null);
    }
    
    // Current month days
    for (let i = 1; i <= daysInMonth; i++) {
      days.push(new Date(currentYear, currentMonth, i));
    }
    
    return days;
  }, [currentYear, currentMonth]);
  
  // Get events for a specific date
  const getEventsForDate = useCallback((date: Date) => {
    return events.filter(event => isSameDay(event.date, date));
  }, [events]);
  
  // Navigation handlers
  const handlePrevMonth = () => {
    setCurrentDate(new Date(currentYear, currentMonth - 1, 1));
  };
  
  const handleNextMonth = () => {
    setCurrentDate(new Date(currentYear, currentMonth + 1, 1));
  };
  
  const handleToday = () => {
    setCurrentDate(new Date());
  };
  
  // Date selection handler
  const handleDateClick = (date: Date) => {
    if (isDateDisabled(date, minDate, maxDate, disabledDates)) return;
    
    setSelectedDate(date);
    setSelectedTime(undefined);
    onDateSelect?.(date);
  };
  
  // Time selection handler
  const handleTimeSelect = (time: string) => {
    setSelectedTime(time);
    if (selectedDate) {
      onTimeSlotSelect?.(selectedDate, time);
    }
  };
  
  // Event click handler
  const handleEventClick = (event: CalendarEvent) => {
    setSelectedEvent(event);
    onEventClick?.(event);
  };
  
  // Selected date events
  const selectedDateEvents = useMemo(() => {
    if (!selectedDate) return [];
    return getEventsForDate(selectedDate);
  }, [selectedDate, getEventsForDate]);
  
  return (
    <div className={`bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden ${className}`}>
      {/* Header */}
      <div className="p-4 border-b border-gray-200">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-4">
            <h2 className="text-xl font-bold text-gray-900">
              {MONTHS[currentMonth]} {currentYear}
            </h2>
            <button
              onClick={handleToday}
              className="px-3 py-1 text-sm text-orange-500 hover:bg-orange-50 rounded-lg transition-colors"
            >
              Today
            </button>
          </div>
          
          <div className="flex items-center gap-2">
            {/* View toggle */}
            <div className="flex border border-gray-200 rounded-lg overflow-hidden">
              <button
                onClick={() => setCurrentView('month')}
                className={`px-3 py-1.5 text-sm ${
                  currentView === 'month'
                    ? 'bg-orange-500 text-white'
                    : 'text-gray-600 hover:bg-gray-100'
                }`}
              >
                Month
              </button>
              <button
                onClick={() => setCurrentView('week')}
                className={`px-3 py-1.5 text-sm ${
                  currentView === 'week'
                    ? 'bg-orange-500 text-white'
                    : 'text-gray-600 hover:bg-gray-100'
                }`}
              >
                Week
              </button>
              <button
                onClick={() => setCurrentView('day')}
                className={`px-3 py-1.5 text-sm ${
                  currentView === 'day'
                    ? 'bg-orange-500 text-white'
                    : 'text-gray-600 hover:bg-gray-100'
                }`}
              >
                Day
              </button>
            </div>
            
            {/* Navigation */}
            <div className="flex items-center">
              <button
                onClick={handlePrevMonth}
                className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
              >
                <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                </svg>
              </button>
              <button
                onClick={handleNextMonth}
                className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
              >
                <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div className="flex">
        {/* Calendar grid */}
        <div className="flex-1 p-4">
          {/* Day headers */}
          <div className="grid grid-cols-7 mb-2">
            {DAYS.map(day => (
              <div key={day} className="text-center text-sm font-medium text-gray-500 py-2">
                {day}
              </div>
            ))}
          </div>
          
          {/* Calendar days */}
          <div className="grid grid-cols-7 gap-1">
            {calendarDays.map((date, index) => {
              if (!date) {
                return <div key={`empty-${index}`} className="aspect-square" />;
              }
              
              const dateEvents = getEventsForDate(date);
              const isSelected = selectedDate && isSameDay(date, selectedDate);
              const disabled = isDateDisabled(date, minDate, maxDate, disabledDates);
              
              return (
                <motion.button
                  key={date.toISOString()}
                  whileHover={{ scale: disabled ? 1 : 1.05 }}
                  whileTap={{ scale: disabled ? 1 : 0.95 }}
                  onClick={() => handleDateClick(date)}
                  disabled={disabled}
                  className={`aspect-square p-1 rounded-lg transition-all ${
                    disabled
                      ? 'cursor-not-allowed opacity-50'
                      : isSelected
                      ? 'bg-gradient-to-r from-orange-500 to-amber-500 text-white shadow-md'
                      : isToday(date)
                      ? 'bg-orange-50 text-orange-600 ring-2 ring-orange-500'
                      : 'hover:bg-gray-100'
                  }`}
                >
                  <div className="flex flex-col h-full">
                    <span className={`text-sm font-medium ${
                      isSelected ? 'text-white' : isToday(date) ? 'text-orange-600' : 'text-gray-900'
                    }`}>
                      {date.getDate()}
                    </span>
                    
                    {/* Event indicators */}
                    {dateEvents.length > 0 && (
                      <div className="mt-auto flex justify-center gap-0.5">
                        {dateEvents.slice(0, 3).map((event, i) => (
                          <div
                            key={i}
                            className={`w-1.5 h-1.5 rounded-full ${
                              isSelected ? 'bg-white' : eventTypeColors[event.type]?.bg || 'bg-gray-300'
                            }`}
                          />
                        ))}
                        {dateEvents.length > 3 && (
                          <span className={`text-[10px] ${isSelected ? 'text-white' : 'text-gray-500'}`}>
                            +{dateEvents.length - 3}
                          </span>
                        )}
                      </div>
                    )}
                  </div>
                </motion.button>
              );
            })}
          </div>
          
          {/* Event legend */}
          <div className="mt-4 flex flex-wrap gap-3">
            {Object.entries(eventTypeColors).map(([type, colors]) => (
              <div key={type} className="flex items-center gap-1.5">
                <div className={`w-3 h-3 rounded-full ${colors.bg} ${colors.border} border`} />
                <span className="text-xs text-gray-600 capitalize">{type.replace('-', ' ')}</span>
              </div>
            ))}
          </div>
        </div>
        
        {/* Side panel - Selected date details */}
        {(selectedDate || showTimeSlots) && (
          <div className="w-80 border-l border-gray-200 p-4 bg-gray-50">
            {selectedDate && (
              <>
                <h3 className="font-semibold text-gray-900 mb-1">
                  {selectedDate.toLocaleDateString('en-IN', {
                    weekday: 'long',
                    month: 'long',
                    day: 'numeric',
                  })}
                </h3>
                
                {/* Time slots */}
                {showTimeSlots && (
                  <div className="mb-4">
                    <p className="text-sm text-gray-600 mb-3">Select a time</p>
                    <TimeSlotPicker
                      slots={availableSlots}
                      selectedTime={selectedTime}
                      onSelectTime={handleTimeSelect}
                    />
                  </div>
                )}
                
                {/* Events for selected date */}
                {selectedDateEvents.length > 0 ? (
                  <div className="space-y-2">
                    <p className="text-sm font-medium text-gray-700">
                      {selectedDateEvents.length} event{selectedDateEvents.length > 1 ? 's' : ''}
                    </p>
                    {selectedDateEvents.map(event => (
                      <EventCard
                        key={event.id}
                        event={event}
                        onClick={() => handleEventClick(event)}
                      />
                    ))}
                  </div>
                ) : (
                  <div className="text-center py-8">
                    <svg className="w-12 h-12 text-gray-300 mx-auto mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <p className="text-gray-500">No events scheduled</p>
                    <button className="mt-2 text-sm text-orange-500 hover:underline">
                      Schedule something
                    </button>
                  </div>
                )}
              </>
            )}
          </div>
        )}
      </div>
      
      {/* Event detail modal */}
      <AnimatePresence>
        {selectedEvent && (
          <EventDetailModal
            event={selectedEvent}
            onClose={() => setSelectedEvent(null)}
          />
        )}
      </AnimatePresence>
    </div>
  );
}

// Export types
export type { CalendarEvent, TimeSlot, CalendarProps };
Fileupload · TSX
'use client';

import { useState, useCallback, useRef, ChangeEvent, DragEvent } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// File with preview interface
interface UploadedFile {
  id: string;
  file: File;
  name: string;
  size: number;
  type: string;
  preview?: string;
  progress: number;
  status: 'pending' | 'uploading' | 'complete' | 'error';
  error?: string;
}

// Component props
interface FileUploadProps {
  onFilesSelected?: (files: File[]) => void;
  onFileRemove?: (file: UploadedFile) => void;
  onUpload?: (files: File[]) => Promise<void>;
  accept?: string;
  maxFiles?: number;
  maxSize?: number; // in bytes
  multiple?: boolean;
  showPreview?: boolean;
  showProgress?: boolean;
  uploadedFiles?: UploadedFile[];
  variant?: 'default' | 'compact' | 'avatar';
  label?: string;
  description?: string;
  className?: string;
  disabled?: boolean;
}

// File type icons
const fileTypeIcons: Record<string, JSX.Element> = {
  image: (
    <svg className="w-8 h-8 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
    </svg>
  ),
  pdf: (
    <svg className="w-8 h-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
    </svg>
  ),
  document: (
    <svg className="w-8 h-8 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
    </svg>
  ),
  spreadsheet: (
    <svg className="w-8 h-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
    </svg>
  ),
  video: (
    <svg className="w-8 h-8 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
    </svg>
  ),
  default: (
    <svg className="w-8 h-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
    </svg>
  ),
};

// Helper functions
const formatFileSize = (bytes: number): string => {
  if (bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
};

const getFileTypeCategory = (type: string): string => {
  if (type.startsWith('image/')) return 'image';
  if (type === 'application/pdf') return 'pdf';
  if (type.includes('word') || type.includes('document')) return 'document';
  if (type.includes('sheet') || type.includes('excel')) return 'spreadsheet';
  if (type.startsWith('video/')) return 'video';
  return 'default';
};

const generateId = (): string => {
  return Math.random().toString(36).substring(2, 15);
};

// File preview component
const FilePreview = ({
  file,
  onRemove,
  showProgress,
}: {
  file: UploadedFile;
  onRemove: () => void;
  showProgress: boolean;
}) => {
  const category = getFileTypeCategory(file.type);
  const isImage = category === 'image';
  
  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.9 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 0.9 }}
      className="relative group bg-white rounded-lg border border-gray-200 overflow-hidden"
    >
      {/* Preview */}
      <div className="aspect-square flex items-center justify-center bg-gray-50 overflow-hidden">
        {isImage && file.preview ? (
          <img
            src={file.preview}
            alt={file.name}
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="flex flex-col items-center justify-center p-4">
            {fileTypeIcons[category] || fileTypeIcons.default}
            <span className="mt-2 text-xs text-gray-500 uppercase">
              {file.name.split('.').pop()}
            </span>
          </div>
        )}
        
        {/* Status overlay */}
        {file.status === 'uploading' && (
          <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
            <div className="w-10 h-10 border-3 border-white border-t-transparent rounded-full animate-spin" />
          </div>
        )}
        
        {file.status === 'error' && (
          <div className="absolute inset-0 bg-red-500/80 flex items-center justify-center">
            <svg className="w-8 h-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
          </div>
        )}
        
        {file.status === 'complete' && (
          <div className="absolute top-2 right-2">
            <div className="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center">
              <svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
              </svg>
            </div>
          </div>
        )}
        
        {/* Remove button */}
        <button
          onClick={onRemove}
          className="absolute top-2 right-2 w-6 h-6 bg-red-500 hover:bg-red-600 rounded-full flex items-center justify-center text-white opacity-0 group-hover:opacity-100 transition-opacity"
        >
          <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      
      {/* File info */}
      <div className="p-2">
        <p className="text-sm font-medium text-gray-900 truncate" title={file.name}>
          {file.name}
        </p>
        <p className="text-xs text-gray-500">{formatFileSize(file.size)}</p>
        
        {/* Progress bar */}
        {showProgress && file.status === 'uploading' && (
          <div className="mt-2">
            <div className="h-1 bg-gray-200 rounded-full overflow-hidden">
              <motion.div
                initial={{ width: 0 }}
                animate={{ width: `${file.progress}%` }}
                className="h-full bg-gradient-to-r from-orange-500 to-amber-500"
              />
            </div>
            <p className="text-xs text-gray-500 mt-1">{file.progress}%</p>
          </div>
        )}
        
        {/* Error message */}
        {file.error && (
          <p className="text-xs text-red-500 mt-1">{file.error}</p>
        )}
      </div>
    </motion.div>
  );
};

// File list item component
const FileListItem = ({
  file,
  onRemove,
  showProgress,
}: {
  file: UploadedFile;
  onRemove: () => void;
  showProgress: boolean;
}) => {
  const category = getFileTypeCategory(file.type);
  
  return (
    <motion.div
      initial={{ opacity: 0, x: -20 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: 20 }}
      className="flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200"
    >
      {/* Icon or preview */}
      <div className="flex-shrink-0 w-12 h-12 rounded-lg bg-gray-50 flex items-center justify-center overflow-hidden">
        {category === 'image' && file.preview ? (
          <img
            src={file.preview}
            alt={file.name}
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="scale-75">
            {fileTypeIcons[category] || fileTypeIcons.default}
          </div>
        )}
      </div>
      
      {/* File info */}
      <div className="flex-1 min-w-0">
        <p className="text-sm font-medium text-gray-900 truncate">{file.name}</p>
        <p className="text-xs text-gray-500">{formatFileSize(file.size)}</p>
        
        {/* Progress bar */}
        {showProgress && file.status === 'uploading' && (
          <div className="mt-1">
            <div className="h-1 bg-gray-200 rounded-full overflow-hidden">
              <motion.div
                initial={{ width: 0 }}
                animate={{ width: `${file.progress}%` }}
                className="h-full bg-gradient-to-r from-orange-500 to-amber-500"
              />
            </div>
          </div>
        )}
        
        {file.error && (
          <p className="text-xs text-red-500 mt-1">{file.error}</p>
        )}
      </div>
      
      {/* Status */}
      <div className="flex-shrink-0">
        {file.status === 'uploading' && (
          <div className="w-6 h-6 border-2 border-orange-500 border-t-transparent rounded-full animate-spin" />
        )}
        {file.status === 'complete' && (
          <div className="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center">
            <svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
            </svg>
          </div>
        )}
        {file.status === 'error' && (
          <div className="w-6 h-6 bg-red-500 rounded-full flex items-center justify-center">
            <svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
          </div>
        )}
        {file.status === 'pending' && (
          <button
            onClick={onRemove}
            className="p-1 text-gray-400 hover:text-red-500 transition-colors"
          >
            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </button>
        )}
      </div>
    </motion.div>
  );
};

// Main FileUpload component
export default function FileUpload({
  onFilesSelected,
  onFileRemove,
  onUpload,
  accept = '*/*',
  maxFiles = 10,
  maxSize = 10 * 1024 * 1024, // 10MB default
  multiple = true,
  showPreview = true,
  showProgress = true,
  uploadedFiles: externalFiles,
  variant = 'default',
  label = 'Upload files',
  description = 'Drag and drop files here, or click to browse',
  className = '',
  disabled = false,
}: FileUploadProps) {
  const [isDragging, setIsDragging] = useState(false);
  const [files, setFiles] = useState<UploadedFile[]>(externalFiles || []);
  const [error, setError] = useState<string | null>(null);
  const inputRef = useRef<HTMLInputElement>(null);
  
  // Validate file
  const validateFile = (file: File): string | null => {
    if (file.size > maxSize) {
      return `File size exceeds ${formatFileSize(maxSize)} limit`;
    }
    
    if (accept !== '*/*') {
      const acceptedTypes = accept.split(',').map(t => t.trim());
      const isAccepted = acceptedTypes.some(type => {
        if (type.startsWith('.')) {
          return file.name.toLowerCase().endsWith(type.toLowerCase());
        }
        if (type.endsWith('/*')) {
          return file.type.startsWith(type.replace('/*', '/'));
        }
        return file.type === type;
      });
      
      if (!isAccepted) {
        return `File type not accepted`;
      }
    }
    
    return null;
  };
  
  // Create file preview
  const createPreview = (file: File): Promise<string | undefined> => {
    return new Promise(resolve => {
      if (!file.type.startsWith('image/')) {
        resolve(undefined);
        return;
      }
      
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result as string);
      reader.onerror = () => resolve(undefined);
      reader.readAsDataURL(file);
    });
  };
  
  // Process files
  const processFiles = useCallback(async (fileList: FileList) => {
    setError(null);
    
    const newFiles: File[] = [];
    const errors: string[] = [];
    
    const currentCount = files.length;
    const availableSlots = maxFiles - currentCount;
    
    if (availableSlots <= 0) {
      setError(`Maximum ${maxFiles} files allowed`);
      return;
    }
    
    const filesToProcess = Array.from(fileList).slice(0, availableSlots);
    
    for (const file of filesToProcess) {
      const validationError = validateFile(file);
      if (validationError) {
        errors.push(`${file.name}: ${validationError}`);
      } else {
        newFiles.push(file);
      }
    }
    
    if (errors.length > 0) {
      setError(errors.join(', '));
    }
    
    if (newFiles.length === 0) return;
    
    // Create upload file objects with previews
    const uploadFiles: UploadedFile[] = await Promise.all(
      newFiles.map(async file => ({
        id: generateId(),
        file,
        name: file.name,
        size: file.size,
        type: file.type,
        preview: await createPreview(file),
        progress: 0,
        status: 'pending' as const,
      }))
    );
    
    setFiles(prev => [...prev, ...uploadFiles]);
    onFilesSelected?.(newFiles);
  }, [files.length, maxFiles, maxSize, accept, onFilesSelected]);
  
  // Handle drag events
  const handleDragEnter = (e: DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    if (!disabled) setIsDragging(true);
  };
  
  const handleDragLeave = (e: DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    setIsDragging(false);
  };
  
  const handleDragOver = (e: DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
  };
  
  const handleDrop = (e: DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    setIsDragging(false);
    
    if (disabled) return;
    
    const { files: droppedFiles } = e.dataTransfer;
    if (droppedFiles && droppedFiles.length > 0) {
      processFiles(droppedFiles);
    }
  };
  
  // Handle file input change
  const handleFileChange = (e: ChangeEvent<HTMLInputElement>) => {
    const { files: selectedFiles } = e.target;
    if (selectedFiles && selectedFiles.length > 0) {
      processFiles(selectedFiles);
    }
    // Reset input
    if (inputRef.current) {
      inputRef.current.value = '';
    }
  };
  
  // Remove file
  const handleRemoveFile = (fileToRemove: UploadedFile) => {
    setFiles(prev => prev.filter(f => f.id !== fileToRemove.id));
    // Revoke preview URL to free memory
    if (fileToRemove.preview) {
      URL.revokeObjectURL(fileToRemove.preview);
    }
    onFileRemove?.(fileToRemove);
  };
  
  // Click to upload
  const handleClick = () => {
    if (!disabled && inputRef.current) {
      inputRef.current.click();
    }
  };
  
  // Render avatar variant
  if (variant === 'avatar') {
    const currentFile = files[0];
    
    return (
      <div className={className}>
        <input
          ref={inputRef}
          type="file"
          accept={accept}
          onChange={handleFileChange}
          className="hidden"
          disabled={disabled}
        />
        
        <div className="flex items-center gap-4">
          {/* Avatar preview */}
          <div className="relative">
            <div className="w-24 h-24 rounded-full bg-gray-100 overflow-hidden border-4 border-white shadow-lg">
              {currentFile?.preview ? (
                <img
                  src={currentFile.preview}
                  alt="Avatar"
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-gray-400">
                  <svg className="w-12 h-12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                </div>
              )}
            </div>
            
            <button
              onClick={handleClick}
              disabled={disabled}
              className="absolute bottom-0 right-0 w-8 h-8 bg-orange-500 hover:bg-orange-600 rounded-full flex items-center justify-center text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            >
              <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </button>
          </div>
          
          <div>
            <p className="text-sm font-medium text-gray-900">{label}</p>
            <p className="text-xs text-gray-500 mt-1">
              JPG, PNG or GIF. Max {formatFileSize(maxSize)}
            </p>
          </div>
        </div>
        
        {error && (
          <p className="text-sm text-red-500 mt-2">{error}</p>
        )}
      </div>
    );
  }
  
  // Render compact variant
  if (variant === 'compact') {
    return (
      <div className={className}>
        <input
          ref={inputRef}
          type="file"
          accept={accept}
          multiple={multiple}
          onChange={handleFileChange}
          className="hidden"
          disabled={disabled}
        />
        
        <button
          onClick={handleClick}
          disabled={disabled}
          className="inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
          </svg>
          <span>{label}</span>
        </button>
        
        {files.length > 0 && (
          <div className="mt-3 space-y-2">
            <AnimatePresence>
              {files.map(file => (
                <FileListItem
                  key={file.id}
                  file={file}
                  onRemove={() => handleRemoveFile(file)}
                  showProgress={showProgress}
                />
              ))}
            </AnimatePresence>
          </div>
        )}
        
        {error && (
          <p className="text-sm text-red-500 mt-2">{error}</p>
        )}
      </div>
    );
  }
  
  // Render default variant
  return (
    <div className={className}>
      <input
        ref={inputRef}
        type="file"
        accept={accept}
        multiple={multiple}
        onChange={handleFileChange}
        className="hidden"
        disabled={disabled}
      />
      
      {/* Drop zone */}
      <motion.div
        onDragEnter={handleDragEnter}
        onDragLeave={handleDragLeave}
        onDragOver={handleDragOver}
        onDrop={handleDrop}
        onClick={handleClick}
        animate={{
          borderColor: isDragging ? '#f97316' : '#e5e7eb',
          backgroundColor: isDragging ? '#fff7ed' : '#f9fafb',
        }}
        className={`relative border-2 border-dashed rounded-xl p-8 text-center cursor-pointer transition-colors ${
          disabled ? 'opacity-50 cursor-not-allowed' : 'hover:border-orange-400 hover:bg-orange-50/50'
        }`}
      >
        <div className="flex flex-col items-center">
          <div className="w-16 h-16 rounded-full bg-orange-100 flex items-center justify-center mb-4">
            <svg className="w-8 h-8 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
            </svg>
          </div>
          
          <p className="text-lg font-medium text-gray-900 mb-1">{label}</p>
          <p className="text-sm text-gray-500 mb-4">{description}</p>
          
          <div className="flex items-center gap-4 text-xs text-gray-400">
            <span>Max {formatFileSize(maxSize)}</span>
            <span>•</span>
            <span>Up to {maxFiles} files</span>
            {accept !== '*/*' && (
              <>
                <span>•</span>
                <span>{accept}</span>
              </>
            )}
          </div>
        </div>
        
        {/* Drag overlay */}
        <AnimatePresence>
          {isDragging && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="absolute inset-0 bg-orange-50 border-2 border-orange-500 border-dashed rounded-xl flex items-center justify-center"
            >
              <div className="text-center">
                <svg className="w-12 h-12 text-orange-500 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                </svg>
                <p className="text-orange-600 font-medium">Drop files here</p>
              </div>
            </motion.div>
          )}
        </AnimatePresence>
      </motion.div>
      
      {/* Error message */}
      {error && (
        <p className="text-sm text-red-500 mt-2">{error}</p>
      )}
      
      {/* File previews */}
      {showPreview && files.length > 0 && (
        <div className="mt-4">
          <div className="flex items-center justify-between mb-3">
            <p className="text-sm font-medium text-gray-700">
              {files.length} file{files.length > 1 ? 's' : ''} selected
            </p>
            <button
              onClick={() => {
                files.forEach(f => {
                  if (f.preview) URL.revokeObjectURL(f.preview);
                });
                setFiles([]);
              }}
              className="text-sm text-red-500 hover:text-red-600"
            >
              Clear all
            </button>
          </div>
          
          <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
            <AnimatePresence>
              {files.map(file => (
                <FilePreview
                  key={file.id}
                  file={file}
                  onRemove={() => handleRemoveFile(file)}
                  showProgress={showProgress}
                />
              ))}
            </AnimatePresence>
          </div>
        </div>
      )}
      
      {/* Upload button */}
      {files.length > 0 && onUpload && (
        <div className="mt-4 flex justify-end">
          <button
            onClick={() => onUpload(files.map(f => f.file))}
            disabled={files.some(f => f.status === 'uploading')}
            className="px-6 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white font-medium rounded-lg hover:from-orange-600 hover:to-amber-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
          >
            {files.some(f => f.status === 'uploading') ? (
              <span className="flex items-center gap-2">
                <svg className="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
                  <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" />
                  <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" />
                </svg>
                Uploading...
              </span>
            ) : (
              `Upload ${files.length} file${files.length > 1 ? 's' : ''}`
            )}
          </button>
        </div>
      )}
    </div>
  );
}

// Export types
export type { UploadedFile, FileUploadProps };
Charts · TSX
'use client';

import { useState, useMemo } from 'react';
import { motion } from 'framer-motion';

// Chart data interfaces
interface DataPoint {
  label: string;
  value: number;
  color?: string;
  [key: string]: any;
}

interface LineChartData {
  labels: string[];
  datasets: {
    label: string;
    data: number[];
    color?: string;
    fill?: boolean;
  }[];
}

interface BarChartData {
  labels: string[];
  datasets: {
    label: string;
    data: number[];
    color?: string;
  }[];
}

interface PieChartData {
  data: DataPoint[];
}

interface ChartProps {
  title?: string;
  subtitle?: string;
  className?: string;
  height?: number;
  showLegend?: boolean;
  showGrid?: boolean;
  showTooltip?: boolean;
  animate?: boolean;
}

// Default colors
const defaultColors = [
  '#f97316', // orange-500
  '#f59e0b', // amber-500
  '#22c55e', // green-500
  '#3b82f6', // blue-500
  '#8b5cf6', // violet-500
  '#ec4899', // pink-500
  '#14b8a6', // teal-500
  '#ef4444', // red-500
];

// Format number for display
const formatNumber = (value: number): string => {
  if (value >= 10000000) {
    return `₹${(value / 10000000).toFixed(1)}Cr`;
  }
  if (value >= 100000) {
    return `₹${(value / 100000).toFixed(1)}L`;
  }
  if (value >= 1000) {
    return `${(value / 1000).toFixed(1)}K`;
  }
  return value.toString();
};

// Line Chart Component
interface LineChartProps extends ChartProps {
  data: LineChartData;
  curved?: boolean;
}

export function LineChart({
  data,
  title,
  subtitle,
  className = '',
  height = 300,
  showLegend = true,
  showGrid = true,
  showTooltip = true,
  animate = true,
  curved = true,
}: LineChartProps) {
  const [hoveredPoint, setHoveredPoint] = useState<{ datasetIndex: number; pointIndex: number } | null>(null);
  
  // Calculate chart dimensions
  const padding = { top: 20, right: 20, bottom: 40, left: 60 };
  const chartWidth = 100; // percentage
  const chartHeight = height - padding.top - padding.bottom;
  
  // Calculate scales
  const allValues = data.datasets.flatMap(d => d.data);
  const maxValue = Math.max(...allValues) * 1.1;
  const minValue = Math.min(0, ...allValues);
  
  const scaleY = (value: number) => {
    return chartHeight - ((value - minValue) / (maxValue - minValue)) * chartHeight;
  };
  
  const scaleX = (index: number) => {
    return (index / (data.labels.length - 1)) * 100;
  };
  
  // Generate path for a dataset
  const generatePath = (values: number[]) => {
    const points = values.map((value, index) => ({
      x: scaleX(index),
      y: scaleY(value),
    }));
    
    if (curved) {
      // Generate smooth curve
      let path = `M ${points[0].x} ${points[0].y}`;
      for (let i = 1; i < points.length; i++) {
        const prev = points[i - 1];
        const curr = points[i];
        const cpX = (prev.x + curr.x) / 2;
        path += ` C ${cpX} ${prev.y}, ${cpX} ${curr.y}, ${curr.x} ${curr.y}`;
      }
      return path;
    } else {
      return points.map((p, i) => `${i === 0 ? 'M' : 'L'} ${p.x} ${p.y}`).join(' ');
    }
  };
  
  // Generate Y-axis ticks
  const yTicks = useMemo(() => {
    const tickCount = 5;
    const step = (maxValue - minValue) / (tickCount - 1);
    return Array.from({ length: tickCount }, (_, i) => minValue + step * i);
  }, [maxValue, minValue]);
  
  return (
    <div className={`bg-white rounded-xl p-4 ${className}`}>
      {/* Header */}
      {(title || subtitle) && (
        <div className="mb-4">
          {title && <h3 className="text-lg font-semibold text-gray-900">{title}</h3>}
          {subtitle && <p className="text-sm text-gray-500">{subtitle}</p>}
        </div>
      )}
      
      {/* Chart */}
      <div className="relative" style={{ height }}>
        <svg
          viewBox={`0 0 100 ${height}`}
          preserveAspectRatio="none"
          className="w-full h-full"
        >
          {/* Grid lines */}
          {showGrid && (
            <g className="text-gray-200">
              {yTicks.map((tick, i) => (
                <line
                  key={i}
                  x1="0"
                  y1={padding.top + scaleY(tick)}
                  x2="100"
                  y2={padding.top + scaleY(tick)}
                  stroke="currentColor"
                  strokeDasharray="2"
                  vectorEffect="non-scaling-stroke"
                />
              ))}
            </g>
          )}
          
          {/* Lines */}
          <g transform={`translate(0, ${padding.top})`}>
            {data.datasets.map((dataset, datasetIndex) => {
              const color = dataset.color || defaultColors[datasetIndex % defaultColors.length];
              const path = generatePath(dataset.data);
              
              return (
                <g key={datasetIndex}>
                  {/* Fill area */}
                  {dataset.fill && (
                    <motion.path
                      initial={animate ? { opacity: 0 } : undefined}
                      animate={{ opacity: 0.1 }}
                      d={`${path} L 100 ${chartHeight} L 0 ${chartHeight} Z`}
                      fill={color}
                    />
                  )}
                  
                  {/* Line */}
                  <motion.path
                    initial={animate ? { pathLength: 0 } : undefined}
                    animate={{ pathLength: 1 }}
                    transition={{ duration: 1, ease: 'easeOut' }}
                    d={path}
                    fill="none"
                    stroke={color}
                    strokeWidth="2"
                    vectorEffect="non-scaling-stroke"
                  />
                  
                  {/* Points */}
                  {dataset.data.map((value, pointIndex) => (
                    <motion.circle
                      key={pointIndex}
                      initial={animate ? { scale: 0 } : undefined}
                      animate={{ scale: 1 }}
                      transition={{ delay: pointIndex * 0.05 }}
                      cx={`${scaleX(pointIndex)}%`}
                      cy={scaleY(value)}
                      r="4"
                      fill="white"
                      stroke={color}
                      strokeWidth="2"
                      vectorEffect="non-scaling-stroke"
                      className="cursor-pointer"
                      onMouseEnter={() => setHoveredPoint({ datasetIndex, pointIndex })}
                      onMouseLeave={() => setHoveredPoint(null)}
                    />
                  ))}
                </g>
              );
            })}
          </g>
        </svg>
        
        {/* Y-axis labels */}
        <div className="absolute left-0 top-0 h-full flex flex-col justify-between py-5 text-xs text-gray-500">
          {yTicks.reverse().map((tick, i) => (
            <span key={i}>{formatNumber(tick)}</span>
          ))}
        </div>
        
        {/* X-axis labels */}
        <div className="absolute bottom-0 left-0 right-0 flex justify-between px-2 text-xs text-gray-500">
          {data.labels.map((label, i) => (
            <span key={i} className="text-center">{label}</span>
          ))}
        </div>
        
        {/* Tooltip */}
        {showTooltip && hoveredPoint && (
          <div
            className="absolute pointer-events-none bg-gray-900 text-white text-xs px-2 py-1 rounded shadow-lg z-10"
            style={{
              left: `${scaleX(hoveredPoint.pointIndex)}%`,
              top: padding.top + scaleY(data.datasets[hoveredPoint.datasetIndex].data[hoveredPoint.pointIndex]) - 30,
              transform: 'translateX(-50%)',
            }}
          >
            <p className="font-medium">{data.datasets[hoveredPoint.datasetIndex].label}</p>
            <p>{formatNumber(data.datasets[hoveredPoint.datasetIndex].data[hoveredPoint.pointIndex])}</p>
          </div>
        )}
      </div>
      
      {/* Legend */}
      {showLegend && (
        <div className="mt-4 flex flex-wrap gap-4 justify-center">
          {data.datasets.map((dataset, i) => (
            <div key={i} className="flex items-center gap-2">
              <div
                className="w-3 h-3 rounded-full"
                style={{ backgroundColor: dataset.color || defaultColors[i % defaultColors.length] }}
              />
              <span className="text-sm text-gray-600">{dataset.label}</span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}

// Bar Chart Component
interface BarChartProps extends ChartProps {
  data: BarChartData;
  horizontal?: boolean;
  stacked?: boolean;
}

export function BarChart({
  data,
  title,
  subtitle,
  className = '',
  height = 300,
  showLegend = true,
  showGrid = true,
  animate = true,
  horizontal = false,
  stacked = false,
}: BarChartProps) {
  const [hoveredBar, setHoveredBar] = useState<{ datasetIndex: number; barIndex: number } | null>(null);
  
  // Calculate max value
  const maxValue = stacked
    ? Math.max(...data.labels.map((_, i) => 
        data.datasets.reduce((sum, d) => sum + d.data[i], 0)
      )) * 1.1
    : Math.max(...data.datasets.flatMap(d => d.data)) * 1.1;
  
  const barWidth = 100 / data.labels.length / (stacked ? 1 : data.datasets.length) * 0.7;
  const barGap = barWidth * 0.3;
  
  return (
    <div className={`bg-white rounded-xl p-4 ${className}`}>
      {/* Header */}
      {(title || subtitle) && (
        <div className="mb-4">
          {title && <h3 className="text-lg font-semibold text-gray-900">{title}</h3>}
          {subtitle && <p className="text-sm text-gray-500">{subtitle}</p>}
        </div>
      )}
      
      {/* Chart */}
      <div className="relative" style={{ height }}>
        <div className="absolute inset-0 flex items-end justify-around px-4 pb-8">
          {data.labels.map((label, barIndex) => {
            let cumulativeHeight = 0;
            
            return (
              <div key={barIndex} className="flex items-end gap-1" style={{ flex: 1 }}>
                {data.datasets.map((dataset, datasetIndex) => {
                  const value = dataset.data[barIndex];
                  const barHeight = (value / maxValue) * 100;
                  const color = dataset.color || defaultColors[datasetIndex % defaultColors.length];
                  
                  if (stacked) {
                    const prevHeight = cumulativeHeight;
                    cumulativeHeight += barHeight;
                    
                    return (
                      <motion.div
                        key={datasetIndex}
                        initial={animate ? { height: 0 } : undefined}
                        animate={{ height: `${barHeight}%` }}
                        transition={{ delay: barIndex * 0.1, duration: 0.5 }}
                        className="absolute w-full rounded-t cursor-pointer hover:opacity-80 transition-opacity"
                        style={{
                          backgroundColor: color,
                          bottom: `${prevHeight}%`,
                          left: 0,
                          right: 0,
                          maxWidth: '40px',
                          margin: '0 auto',
                        }}
                        onMouseEnter={() => setHoveredBar({ datasetIndex, barIndex })}
                        onMouseLeave={() => setHoveredBar(null)}
                      />
                    );
                  }
                  
                  return (
                    <motion.div
                      key={datasetIndex}
                      initial={animate ? { height: 0 } : undefined}
                      animate={{ height: `${barHeight}%` }}
                      transition={{ delay: (barIndex * data.datasets.length + datasetIndex) * 0.05, duration: 0.5 }}
                      className="flex-1 max-w-[30px] rounded-t cursor-pointer hover:opacity-80 transition-opacity"
                      style={{ backgroundColor: color }}
                      onMouseEnter={() => setHoveredBar({ datasetIndex, barIndex })}
                      onMouseLeave={() => setHoveredBar(null)}
                    />
                  );
                })}
              </div>
            );
          })}
        </div>
        
        {/* X-axis labels */}
        <div className="absolute bottom-0 left-0 right-0 flex justify-around px-4 text-xs text-gray-500">
          {data.labels.map((label, i) => (
            <span key={i} className="text-center truncate" style={{ flex: 1 }}>{label}</span>
          ))}
        </div>
        
        {/* Tooltip */}
        {hoveredBar && (
          <div className="absolute top-4 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-xs px-3 py-2 rounded shadow-lg z-10">
            <p className="font-medium">{data.labels[hoveredBar.barIndex]}</p>
            <p className="text-gray-300">
              {data.datasets[hoveredBar.datasetIndex].label}: {formatNumber(data.datasets[hoveredBar.datasetIndex].data[hoveredBar.barIndex])}
            </p>
          </div>
        )}
      </div>
      
      {/* Legend */}
      {showLegend && (
        <div className="mt-4 flex flex-wrap gap-4 justify-center">
          {data.datasets.map((dataset, i) => (
            <div key={i} className="flex items-center gap-2">
              <div
                className="w-3 h-3 rounded"
                style={{ backgroundColor: dataset.color || defaultColors[i % defaultColors.length] }}
              />
              <span className="text-sm text-gray-600">{dataset.label}</span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}

// Pie/Donut Chart Component
interface PieChartProps extends ChartProps {
  data: PieChartData;
  donut?: boolean;
  centerLabel?: string;
  centerValue?: string;
}

export function PieChart({
  data,
  title,
  subtitle,
  className = '',
  height = 300,
  showLegend = true,
  animate = true,
  donut = false,
  centerLabel,
  centerValue,
}: PieChartProps) {
  const [hoveredSlice, setHoveredSlice] = useState<number | null>(null);
  
  // Calculate total and percentages
  const total = data.data.reduce((sum, d) => sum + d.value, 0);
  
  // Generate pie slices
  const slices = useMemo(() => {
    let startAngle = -90; // Start from top
    
    return data.data.map((item, index) => {
      const percentage = (item.value / total) * 100;
      const angle = (item.value / total) * 360;
      const endAngle = startAngle + angle;
      
      // Calculate arc path
      const largeArcFlag = angle > 180 ? 1 : 0;
      const startRad = (startAngle * Math.PI) / 180;
      const endRad = (endAngle * Math.PI) / 180;
      
      const outerRadius = 45;
      const innerRadius = donut ? 25 : 0;
      
      const x1 = 50 + outerRadius * Math.cos(startRad);
      const y1 = 50 + outerRadius * Math.sin(startRad);
      const x2 = 50 + outerRadius * Math.cos(endRad);
      const y2 = 50 + outerRadius * Math.sin(endRad);
      
      const x3 = 50 + innerRadius * Math.cos(endRad);
      const y3 = 50 + innerRadius * Math.sin(endRad);
      const x4 = 50 + innerRadius * Math.cos(startRad);
      const y4 = 50 + innerRadius * Math.sin(startRad);
      
      const path = donut
        ? `M ${x1} ${y1} A ${outerRadius} ${outerRadius} 0 ${largeArcFlag} 1 ${x2} ${y2} L ${x3} ${y3} A ${innerRadius} ${innerRadius} 0 ${largeArcFlag} 0 ${x4} ${y4} Z`
        : `M 50 50 L ${x1} ${y1} A ${outerRadius} ${outerRadius} 0 ${largeArcFlag} 1 ${x2} ${y2} Z`;
      
      startAngle = endAngle;
      
      return {
        ...item,
        path,
        percentage,
        color: item.color || defaultColors[index % defaultColors.length],
      };
    });
  }, [data.data, total, donut]);
  
  return (
    <div className={`bg-white rounded-xl p-4 ${className}`}>
      {/* Header */}
      {(title || subtitle) && (
        <div className="mb-4">
          {title && <h3 className="text-lg font-semibold text-gray-900">{title}</h3>}
          {subtitle && <p className="text-sm text-gray-500">{subtitle}</p>}
        </div>
      )}
      
      {/* Chart */}
      <div className="flex items-center justify-center gap-8">
        <div className="relative" style={{ width: height * 0.8, height: height * 0.8 }}>
          <svg viewBox="0 0 100 100" className="w-full h-full">
            {slices.map((slice, index) => (
              <motion.path
                key={index}
                initial={animate ? { scale: 0, opacity: 0 } : undefined}
                animate={{ 
                  scale: hoveredSlice === index ? 1.05 : 1,
                  opacity: 1,
                }}
                transition={{ delay: index * 0.1, duration: 0.5 }}
                d={slice.path}
                fill={slice.color}
                className="cursor-pointer transition-transform origin-center"
                style={{ transformOrigin: '50% 50%' }}
                onMouseEnter={() => setHoveredSlice(index)}
                onMouseLeave={() => setHoveredSlice(null)}
              />
            ))}
          </svg>
          
          {/* Center label for donut */}
          {donut && (centerLabel || centerValue) && (
            <div className="absolute inset-0 flex flex-col items-center justify-center">
              {centerValue && (
                <span className="text-2xl font-bold text-gray-900">{centerValue}</span>
              )}
              {centerLabel && (
                <span className="text-sm text-gray-500">{centerLabel}</span>
              )}
            </div>
          )}
          
          {/* Tooltip */}
          {hoveredSlice !== null && (
            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-900 text-white text-xs px-3 py-2 rounded shadow-lg z-10 pointer-events-none">
              <p className="font-medium">{slices[hoveredSlice].label}</p>
              <p>{formatNumber(slices[hoveredSlice].value)} ({slices[hoveredSlice].percentage.toFixed(1)}%)</p>
            </div>
          )}
        </div>
        
        {/* Legend */}
        {showLegend && (
          <div className="flex flex-col gap-2">
            {slices.map((slice, index) => (
              <div 
                key={index} 
                className={`flex items-center gap-2 cursor-pointer transition-opacity ${
                  hoveredSlice !== null && hoveredSlice !== index ? 'opacity-50' : ''
                }`}
                onMouseEnter={() => setHoveredSlice(index)}
                onMouseLeave={() => setHoveredSlice(null)}
              >
                <div
                  className="w-3 h-3 rounded-full flex-shrink-0"
                  style={{ backgroundColor: slice.color }}
                />
                <span className="text-sm text-gray-600">{slice.label}</span>
                <span className="text-sm text-gray-400 ml-auto">
                  {slice.percentage.toFixed(1)}%
                </span>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

// Area Chart Component (variant of Line Chart)
interface AreaChartProps extends LineChartProps {
  gradient?: boolean;
}

export function AreaChart({
  data,
  gradient = true,
  ...props
}: AreaChartProps) {
  // Add fill to all datasets
  const filledData = {
    ...data,
    datasets: data.datasets.map(d => ({ ...d, fill: true })),
  };
  
  return <LineChart data={filledData} {...props} />;
}

// Stats Card Component
interface StatCardProps {
  title: string;
  value: string | number;
  change?: number;
  changeLabel?: string;
  icon?: React.ReactNode;
  color?: 'orange' | 'green' | 'blue' | 'purple' | 'red';
  className?: string;
}

export function StatCard({
  title,
  value,
  change,
  changeLabel = 'vs last month',
  icon,
  color = 'orange',
  className = '',
}: StatCardProps) {
  const colorClasses = {
    orange: 'from-orange-500 to-amber-500',
    green: 'from-green-500 to-emerald-500',
    blue: 'from-blue-500 to-cyan-500',
    purple: 'from-purple-500 to-violet-500',
    red: 'from-red-500 to-rose-500',
  };
  
  const isPositive = change && change > 0;
  const isNegative = change && change < 0;
  
  return (
    <div className={`bg-white rounded-xl p-6 shadow-sm border border-gray-100 ${className}`}>
      <div className="flex items-start justify-between">
        <div>
          <p className="text-sm text-gray-500">{title}</p>
          <p className="text-3xl font-bold text-gray-900 mt-1">
            {typeof value === 'number' ? formatNumber(value) : value}
          </p>
          
          {change !== undefined && (
            <div className="flex items-center gap-1 mt-2">
              {isPositive && (
                <svg className="w-4 h-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 11l5-5m0 0l5 5m-5-5v12" />
                </svg>
              )}
              {isNegative && (
                <svg className="w-4 h-4 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 13l-5 5m0 0l-5-5m5 5V6" />
                </svg>
              )}
              <span className={`text-sm font-medium ${
                isPositive ? 'text-green-500' : isNegative ? 'text-red-500' : 'text-gray-500'
              }`}>
                {isPositive && '+'}{change}%
              </span>
              <span className="text-sm text-gray-400">{changeLabel}</span>
            </div>
          )}
        </div>
        
        {icon && (
          <div className={`w-12 h-12 rounded-xl bg-gradient-to-r ${colorClasses[color]} flex items-center justify-center text-white`}>
            {icon}
          </div>
        )}
      </div>
    </div>
  );
}

// Progress Ring Component
interface ProgressRingProps {
  value: number;
  max?: number;
  size?: number;
  strokeWidth?: number;
  color?: string;
  label?: string;
  className?: string;
}

export function ProgressRing({
  value,
  max = 100,
  size = 120,
  strokeWidth = 8,
  color = '#f97316',
  label,
  className = '',
}: ProgressRingProps) {
  const percentage = Math.min((value / max) * 100, 100);
  const radius = (size - strokeWidth) / 2;
  const circumference = radius * 2 * Math.PI;
  const strokeDashoffset = circumference - (percentage / 100) * circumference;
  
  return (
    <div className={`relative inline-flex items-center justify-center ${className}`}>
      <svg width={size} height={size} className="-rotate-90">
        {/* Background circle */}
        <circle
          cx={size / 2}
          cy={size / 2}
          r={radius}
          fill="none"
          stroke="#e5e7eb"
          strokeWidth={strokeWidth}
        />
        {/* Progress circle */}
        <motion.circle
          initial={{ strokeDashoffset: circumference }}
          animate={{ strokeDashoffset }}
          transition={{ duration: 1, ease: 'easeOut' }}
          cx={size / 2}
          cy={size / 2}
          r={radius}
          fill="none"
          stroke={color}
          strokeWidth={strokeWidth}
          strokeLinecap="round"
          strokeDasharray={circumference}
        />
      </svg>
      
      {/* Center content */}
      <div className="absolute inset-0 flex flex-col items-center justify-center">
        <span className="text-2xl font-bold text-gray-900">{percentage.toFixed(0)}%</span>
        {label && <span className="text-xs text-gray-500">{label}</span>}
      </div>
    </div>
  );
}

// Export types
export type { DataPoint, LineChartData, BarChartData, PieChartData };
Breadcrumbs · TSX
'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { useMemo } from 'react';

// Breadcrumb item interface
interface BreadcrumbItem {
  label: string;
  href?: string;
  icon?: React.ReactNode;
}

// Component props
interface BreadcrumbsProps {
  items?: BreadcrumbItem[];
  separator?: React.ReactNode;
  showHome?: boolean;
  homeLabel?: string;
  homeHref?: string;
  maxItems?: number;
  className?: string;
  autoGenerate?: boolean;
}

// Path segment to readable label mapping
const pathLabels: Record<string, string> = {
  properties: 'Properties',
  property: 'Property',
  agents: 'Agents',
  agent: 'Agent',
  dashboard: 'Dashboard',
  favorites: 'Favorites',
  searches: 'Saved Searches',
  showings: 'Showings',
  offers: 'Offers',
  messages: 'Messages',
  documents: 'Documents',
  astrology: 'Astrology',
  analytics: 'Analytics',
  settings: 'Settings',
  subscription: 'Subscription',
  listings: 'Listings',
  leads: 'Leads',
  clients: 'Clients',
  'open-houses': 'Open Houses',
  search: 'Search',
  compare: 'Compare',
  checkout: 'Checkout',
  about: 'About Us',
  contact: 'Contact',
  faq: 'FAQ',
  terms: 'Terms of Service',
  privacy: 'Privacy Policy',
  login: 'Login',
  register: 'Register',
  vastu: 'Vastu',
  consultation: 'Consultation',
  video: 'Video Call',
  signing: 'Document Signing',
};

// Default separator icon
const DefaultSeparator = () => (
  <svg className="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
  </svg>
);

// Home icon
const HomeIcon = () => (
  <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
  </svg>
);

// Convert path segment to readable label
const getLabel = (segment: string): string => {
  // Check custom labels
  if (pathLabels[segment.toLowerCase()]) {
    return pathLabels[segment.toLowerCase()];
  }
  
  // Check if it's an ID (UUID or numeric)
  if (/^[0-9a-f-]{36}$/i.test(segment) || /^\d+$/.test(segment)) {
    return 'Details';
  }
  
  // Convert kebab-case or snake_case to title case
  return segment
    .replace(/[-_]/g, ' ')
    .replace(/\b\w/g, char => char.toUpperCase());
};

export default function Breadcrumbs({
  items: customItems,
  separator,
  showHome = true,
  homeLabel = 'Home',
  homeHref = '/',
  maxItems = 0, // 0 means show all
  className = '',
  autoGenerate = true,
}: BreadcrumbsProps) {
  const pathname = usePathname();
  
  // Auto-generate breadcrumb items from pathname
  const generatedItems = useMemo(() => {
    if (!autoGenerate || customItems) return [];
    
    const segments = pathname.split('/').filter(Boolean);
    let currentPath = '';
    
    return segments.map((segment, index) => {
      currentPath += `/${segment}`;
      const isLast = index === segments.length - 1;
      
      return {
        label: getLabel(segment),
        href: isLast ? undefined : currentPath,
      };
    });
  }, [pathname, autoGenerate, customItems]);
  
  // Use custom items or generated items
  let items = customItems || generatedItems;
  
  // Add home if needed
  if (showHome) {
    items = [{ label: homeLabel, href: homeHref, icon: <HomeIcon /> }, ...items];
  }
  
  // Apply max items limit
  if (maxItems > 0 && items.length > maxItems) {
    const firstItem = items[0];
    const lastItems = items.slice(-( maxItems - 2));
    items = [
      firstItem,
      { label: '...', href: undefined },
      ...lastItems,
    ];
  }
  
  // Don't render if only home or empty
  if (items.length <= 1) {
    return null;
  }
  
  return (
    <nav aria-label="Breadcrumb" className={className}>
      <ol className="flex items-center flex-wrap gap-1">
        {items.map((item, index) => {
          const isLast = index === items.length - 1;
          const isEllipsis = item.label === '...';
          
          return (
            <li key={index} className="flex items-center">
              {index > 0 && (
                <span className="mx-2 flex-shrink-0">
                  {separator || <DefaultSeparator />}
                </span>
              )}
              
              {isEllipsis ? (
                <span className="text-gray-400 text-sm">...</span>
              ) : item.href && !isLast ? (
                <Link
                  href={item.href}
                  className="flex items-center gap-1.5 text-sm text-gray-500 hover:text-orange-500 transition-colors"
                >
                  {item.icon}
                  <span>{item.label}</span>
                </Link>
              ) : (
                <span className={`flex items-center gap-1.5 text-sm ${
                  isLast ? 'text-gray-900 font-medium' : 'text-gray-500'
                }`}>
                  {item.icon}
                  <span>{item.label}</span>
                </span>
              )}
            </li>
          );
        })}
      </ol>
    </nav>
  );
}

// Structured data component for SEO
export function BreadcrumbsStructuredData({ items }: { items: BreadcrumbItem[] }) {
  const structuredData = {
    '@context': 'https://schema.org',
    '@type': 'BreadcrumbList',
    itemListElement: items.map((item, index) => ({
      '@type': 'ListItem',
      position: index + 1,
      name: item.label,
      item: item.href ? `https://dharmarealty.in${item.href}` : undefined,
    })),
  };
  
  return (
    <script
      type="application/ld+json"
      dangerouslySetInnerHTML={{ __html: JSON.stringify(structuredData) }}
    />
  );
}

// Export types
export type { BreadcrumbItem, BreadcrumbsProps };
Tabs · TSX
'use client';

import { useState, useCallback, createContext, useContext, useRef, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// Tab item interface
interface TabItem {
  id: string;
  label: string;
  icon?: React.ReactNode;
  badge?: number | string;
  disabled?: boolean;
  content?: React.ReactNode;
}

// Context for controlled tabs
interface TabsContextType {
  activeTab: string;
  setActiveTab: (id: string) => void;
}

const TabsContext = createContext<TabsContextType | null>(null);

// Hook to access tabs context
export function useTabsContext() {
  const context = useContext(TabsContext);
  if (!context) {
    throw new Error('Tab components must be used within a Tabs component');
  }
  return context;
}

// Component props
interface TabsProps {
  tabs: TabItem[];
  defaultTab?: string;
  activeTab?: string;
  onTabChange?: (tabId: string) => void;
  variant?: 'default' | 'pills' | 'underline' | 'boxed' | 'vertical';
  size?: 'sm' | 'md' | 'lg';
  fullWidth?: boolean;
  animated?: boolean;
  className?: string;
  tabsClassName?: string;
  contentClassName?: string;
  children?: React.ReactNode;
}

// Individual tab button component
interface TabButtonProps {
  tab: TabItem;
  isActive: boolean;
  onClick: () => void;
  variant: TabsProps['variant'];
  size: TabsProps['size'];
  isFirst: boolean;
  isLast: boolean;
}

function TabButton({
  tab,
  isActive,
  onClick,
  variant,
  size,
  isFirst,
  isLast,
}: TabButtonProps) {
  const sizeClasses = {
    sm: 'px-3 py-1.5 text-sm',
    md: 'px-4 py-2 text-sm',
    lg: 'px-6 py-3 text-base',
  };
  
  const getVariantClasses = () => {
    switch (variant) {
      case 'pills':
        return isActive
          ? 'bg-gradient-to-r from-orange-500 to-amber-500 text-white shadow-md'
          : 'text-gray-600 hover:bg-gray-100';
      
      case 'underline':
        return isActive
          ? 'text-orange-500 border-b-2 border-orange-500'
          : 'text-gray-600 hover:text-gray-900 border-b-2 border-transparent';
      
      case 'boxed':
        return `${isActive 
          ? 'bg-white text-gray-900 shadow-sm border-gray-200' 
          : 'text-gray-600 hover:text-gray-900 border-transparent'
        } border ${isFirst ? 'rounded-l-lg' : ''} ${isLast ? 'rounded-r-lg' : '-ml-px'}`;
      
      case 'vertical':
        return isActive
          ? 'bg-orange-50 text-orange-600 border-l-2 border-orange-500'
          : 'text-gray-600 hover:bg-gray-50 border-l-2 border-transparent';
      
      default:
        return isActive
          ? 'bg-gray-100 text-gray-900'
          : 'text-gray-600 hover:bg-gray-50';
    }
  };
  
  return (
    <button
      onClick={onClick}
      disabled={tab.disabled}
      className={`
        relative flex items-center gap-2 font-medium transition-all
        ${sizeClasses[size || 'md']}
        ${getVariantClasses()}
        ${variant === 'pills' ? 'rounded-full' : variant === 'vertical' ? 'w-full text-left' : 'rounded-lg'}
        ${tab.disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}
      `}
      role="tab"
      aria-selected={isActive}
      aria-disabled={tab.disabled}
    >
      {/* Icon */}
      {tab.icon && <span className="flex-shrink-0">{tab.icon}</span>}
      
      {/* Label */}
      <span>{tab.label}</span>
      
      {/* Badge */}
      {tab.badge !== undefined && (
        <span className={`
          ml-1 px-1.5 py-0.5 text-xs font-medium rounded-full
          ${isActive 
            ? variant === 'pills' ? 'bg-white/20 text-white' : 'bg-orange-100 text-orange-600'
            : 'bg-gray-100 text-gray-600'
          }
        `}>
          {tab.badge}
        </span>
      )}
      
      {/* Active indicator for default variant */}
      {variant === 'default' && isActive && (
        <motion.div
          layoutId="activeTab"
          className="absolute inset-0 bg-gray-100 rounded-lg -z-10"
          transition={{ type: 'spring', duration: 0.3 }}
        />
      )}
    </button>
  );
}

// Tab panel component
interface TabPanelProps {
  tabId: string;
  children: React.ReactNode;
  className?: string;
}

export function TabPanel({ tabId, children, className = '' }: TabPanelProps) {
  const { activeTab } = useTabsContext();
  
  if (activeTab !== tabId) return null;
  
  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      exit={{ opacity: 0, y: -10 }}
      transition={{ duration: 0.2 }}
      role="tabpanel"
      className={className}
    >
      {children}
    </motion.div>
  );
}

// Tab list component (for custom tab rendering)
interface TabListProps {
  children: React.ReactNode;
  className?: string;
}

export function TabList({ children, className = '' }: TabListProps) {
  return (
    <div role="tablist" className={className}>
      {children}
    </div>
  );
}

// Main Tabs component
export default function Tabs({
  tabs,
  defaultTab,
  activeTab: controlledActiveTab,
  onTabChange,
  variant = 'default',
  size = 'md',
  fullWidth = false,
  animated = true,
  className = '',
  tabsClassName = '',
  contentClassName = '',
  children,
}: TabsProps) {
  // Internal state for uncontrolled mode
  const [internalActiveTab, setInternalActiveTab] = useState(
    defaultTab || tabs[0]?.id || ''
  );
  
  // Use controlled or internal state
  const activeTab = controlledActiveTab ?? internalActiveTab;
  
  // Handle tab change
  const handleTabChange = useCallback((tabId: string) => {
    const tab = tabs.find(t => t.id === tabId);
    if (tab?.disabled) return;
    
    if (controlledActiveTab === undefined) {
      setInternalActiveTab(tabId);
    }
    onTabChange?.(tabId);
  }, [tabs, controlledActiveTab, onTabChange]);
  
  // Get current tab content
  const currentTab = tabs.find(t => t.id === activeTab);
  
  // Context value
  const contextValue: TabsContextType = {
    activeTab,
    setActiveTab: handleTabChange,
  };
  
  // Tab list classes based on variant
  const getTabListClasses = () => {
    const baseClasses = 'flex';
    
    switch (variant) {
      case 'pills':
        return `${baseClasses} gap-2 p-1 bg-gray-100 rounded-full ${fullWidth ? 'w-full' : 'w-fit'}`;
      
      case 'underline':
        return `${baseClasses} gap-4 border-b border-gray-200 ${fullWidth ? 'w-full' : ''}`;
      
      case 'boxed':
        return `${baseClasses} ${fullWidth ? 'w-full' : 'w-fit'}`;
      
      case 'vertical':
        return `flex-col gap-1 ${fullWidth ? 'w-full' : 'w-48'}`;
      
      default:
        return `${baseClasses} gap-1 p-1 bg-gray-50 rounded-xl ${fullWidth ? 'w-full' : 'w-fit'}`;
    }
  };
  
  return (
    <TabsContext.Provider value={contextValue}>
      <div className={`${variant === 'vertical' ? 'flex gap-6' : ''} ${className}`}>
        {/* Tab buttons */}
        <div
          role="tablist"
          className={`${getTabListClasses()} ${tabsClassName}`}
        >
          {tabs.map((tab, index) => (
            <TabButton
              key={tab.id}
              tab={tab}
              isActive={activeTab === tab.id}
              onClick={() => handleTabChange(tab.id)}
              variant={variant}
              size={size}
              isFirst={index === 0}
              isLast={index === tabs.length - 1}
            />
          ))}
        </div>
        
        {/* Tab content */}
        <div className={`${variant === 'vertical' ? 'flex-1' : 'mt-4'} ${contentClassName}`}>
          {children ? (
            <AnimatePresence mode="wait">
              {children}
            </AnimatePresence>
          ) : (
            <AnimatePresence mode="wait">
              {currentTab?.content && (
                <motion.div
                  key={activeTab}
                  initial={animated ? { opacity: 0, y: 10 } : undefined}
                  animate={{ opacity: 1, y: 0 }}
                  exit={animated ? { opacity: 0, y: -10 } : undefined}
                  transition={{ duration: 0.2 }}
                  role="tabpanel"
                >
                  {currentTab.content}
                </motion.div>
              )}
            </AnimatePresence>
          )}
        </div>
      </div>
    </TabsContext.Provider>
  );
}

// Controlled tab trigger component
interface TabTriggerProps {
  tabId: string;
  children: React.ReactNode;
  className?: string;
  activeClassName?: string;
  disabled?: boolean;
}

export function TabTrigger({
  tabId,
  children,
  className = '',
  activeClassName = '',
  disabled = false,
}: TabTriggerProps) {
  const { activeTab, setActiveTab } = useTabsContext();
  const isActive = activeTab === tabId;
  
  return (
    <button
      onClick={() => !disabled && setActiveTab(tabId)}
      disabled={disabled}
      className={`${className} ${isActive ? activeClassName : ''}`}
      role="tab"
      aria-selected={isActive}
      aria-disabled={disabled}
    >
      {children}
    </button>
  );
}

// Scrollable tabs component
interface ScrollableTabsProps extends TabsProps {
  scrollButtons?: boolean;
}

export function ScrollableTabs({
  scrollButtons = true,
  ...props
}: ScrollableTabsProps) {
  const scrollRef = useRef<HTMLDivElement>(null);
  const [canScrollLeft, setCanScrollLeft] = useState(false);
  const [canScrollRight, setCanScrollRight] = useState(false);
  
  const checkScroll = useCallback(() => {
    if (scrollRef.current) {
      const { scrollLeft, scrollWidth, clientWidth } = scrollRef.current;
      setCanScrollLeft(scrollLeft > 0);
      setCanScrollRight(scrollLeft + clientWidth < scrollWidth);
    }
  }, []);
  
  useEffect(() => {
    checkScroll();
    window.addEventListener('resize', checkScroll);
    return () => window.removeEventListener('resize', checkScroll);
  }, [checkScroll]);
  
  const scroll = (direction: 'left' | 'right') => {
    if (scrollRef.current) {
      const scrollAmount = 200;
      scrollRef.current.scrollBy({
        left: direction === 'left' ? -scrollAmount : scrollAmount,
        behavior: 'smooth',
      });
      setTimeout(checkScroll, 300);
    }
  };
  
  return (
    <div className="relative">
      {scrollButtons && canScrollLeft && (
        <button
          onClick={() => scroll('left')}
          className="absolute left-0 top-1/2 -translate-y-1/2 z-10 w-8 h-8 bg-white shadow-md rounded-full flex items-center justify-center text-gray-600 hover:text-gray-900"
        >
          <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
          </svg>
        </button>
      )}
      
      <div
        ref={scrollRef}
        onScroll={checkScroll}
        className="overflow-x-auto scrollbar-hide"
      >
        <Tabs {...props} />
      </div>
      
      {scrollButtons && canScrollRight && (
        <button
          onClick={() => scroll('right')}
          className="absolute right-0 top-1/2 -translate-y-1/2 z-10 w-8 h-8 bg-white shadow-md rounded-full flex items-center justify-center text-gray-600 hover:text-gray-900"
        >
          <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
          </svg>
        </button>
      )}
    </div>
  );
}

// Export types
export type { TabItem, TabsProps };
Accordion · TSX
'use client';

import { useState, useCallback, createContext, useContext, useId } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// Accordion item interface
interface AccordionItemData {
  id: string;
  title: string;
  content: React.ReactNode;
  icon?: React.ReactNode;
  badge?: string | number;
  disabled?: boolean;
}

// Context for accordion state
interface AccordionContextType {
  expandedItems: string[];
  toggleItem: (id: string) => void;
  variant: AccordionProps['variant'];
  size: AccordionProps['size'];
}

const AccordionContext = createContext<AccordionContextType | null>(null);

// Hook to access accordion context
export function useAccordionContext() {
  const context = useContext(AccordionContext);
  if (!context) {
    throw new Error('Accordion components must be used within an Accordion component');
  }
  return context;
}

// Component props
interface AccordionProps {
  items?: AccordionItemData[];
  defaultExpanded?: string[];
  allowMultiple?: boolean;
  variant?: 'default' | 'bordered' | 'separated' | 'ghost';
  size?: 'sm' | 'md' | 'lg';
  iconPosition?: 'left' | 'right';
  animated?: boolean;
  className?: string;
  children?: React.ReactNode;
}

// Accordion item component
interface AccordionItemProps {
  item?: AccordionItemData;
  id?: string;
  title?: React.ReactNode;
  children?: React.ReactNode;
  icon?: React.ReactNode;
  badge?: string | number;
  disabled?: boolean;
  className?: string;
}

export function AccordionItem({
  item,
  id: propId,
  title: propTitle,
  children,
  icon: propIcon,
  badge: propBadge,
  disabled: propDisabled,
  className = '',
}: AccordionItemProps) {
  const generatedId = useId();
  const { expandedItems, toggleItem, variant, size } = useAccordionContext();
  
  // Use item props or individual props
  const id = item?.id || propId || generatedId;
  const title = item?.title || propTitle;
  const content = item?.content || children;
  const icon = item?.icon || propIcon;
  const badge = item?.badge || propBadge;
  const disabled = item?.disabled || propDisabled || false;
  
  const isExpanded = expandedItems.includes(id);
  
  // Size classes
  const sizeClasses = {
    sm: { padding: 'px-3 py-2', text: 'text-sm', gap: 'gap-2' },
    md: { padding: 'px-4 py-3', text: 'text-base', gap: 'gap-3' },
    lg: { padding: 'px-5 py-4', text: 'text-lg', gap: 'gap-4' },
  };
  
  // Variant classes
  const getVariantClasses = () => {
    switch (variant) {
      case 'bordered':
        return 'border border-gray-200 rounded-lg mb-2 last:mb-0 overflow-hidden';
      case 'separated':
        return 'bg-white rounded-lg shadow-sm mb-3 last:mb-0 overflow-hidden';
      case 'ghost':
        return 'border-b border-gray-100 last:border-b-0';
      default:
        return 'border-b border-gray-200 last:border-b-0';
    }
  };
  
  const handleClick = () => {
    if (!disabled) {
      toggleItem(id);
    }
  };
  
  return (
    <div className={`${getVariantClasses()} ${className}`}>
      {/* Header */}
      <button
        onClick={handleClick}
        disabled={disabled}
        className={`
          w-full flex items-center justify-between ${sizeClasses[size || 'md'].padding}
          ${sizeClasses[size || 'md'].text} font-medium text-left
          ${disabled 
            ? 'text-gray-400 cursor-not-allowed' 
            : 'text-gray-900 hover:bg-gray-50'
          }
          transition-colors
        `}
        aria-expanded={isExpanded}
        aria-controls={`accordion-content-${id}`}
      >
        <div className={`flex items-center ${sizeClasses[size || 'md'].gap}`}>
          {/* Icon */}
          {icon && <span className="flex-shrink-0 text-gray-500">{icon}</span>}
          
          {/* Title */}
          <span>{title}</span>
          
          {/* Badge */}
          {badge !== undefined && (
            <span className="px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-600 rounded-full">
              {badge}
            </span>
          )}
        </div>
        
        {/* Expand/Collapse icon */}
        <motion.span
          animate={{ rotate: isExpanded ? 180 : 0 }}
          transition={{ duration: 0.2 }}
          className="flex-shrink-0 text-gray-400"
        >
          <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
          </svg>
        </motion.span>
      </button>
      
      {/* Content */}
      <AnimatePresence initial={false}>
        {isExpanded && (
          <motion.div
            id={`accordion-content-${id}`}
            initial={{ height: 0, opacity: 0 }}
            animate={{ height: 'auto', opacity: 1 }}
            exit={{ height: 0, opacity: 0 }}
            transition={{ duration: 0.2, ease: 'easeInOut' }}
            className="overflow-hidden"
          >
            <div className={`${sizeClasses[size || 'md'].padding} pt-0 text-gray-600`}>
              {content}
            </div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}

// Accordion trigger component (for custom headers)
interface AccordionTriggerProps {
  id: string;
  children: React.ReactNode;
  className?: string;
  disabled?: boolean;
}

export function AccordionTrigger({
  id,
  children,
  className = '',
  disabled = false,
}: AccordionTriggerProps) {
  const { expandedItems, toggleItem } = useAccordionContext();
  const isExpanded = expandedItems.includes(id);
  
  return (
    <button
      onClick={() => !disabled && toggleItem(id)}
      disabled={disabled}
      className={className}
      aria-expanded={isExpanded}
      aria-controls={`accordion-content-${id}`}
    >
      {children}
    </button>
  );
}

// Accordion content component (for custom content)
interface AccordionContentProps {
  id: string;
  children: React.ReactNode;
  className?: string;
}

export function AccordionContent({
  id,
  children,
  className = '',
}: AccordionContentProps) {
  const { expandedItems } = useAccordionContext();
  const isExpanded = expandedItems.includes(id);
  
  return (
    <AnimatePresence initial={false}>
      {isExpanded && (
        <motion.div
          id={`accordion-content-${id}`}
          initial={{ height: 0, opacity: 0 }}
          animate={{ height: 'auto', opacity: 1 }}
          exit={{ height: 0, opacity: 0 }}
          transition={{ duration: 0.2, ease: 'easeInOut' }}
          className={`overflow-hidden ${className}`}
        >
          {children}
        </motion.div>
      )}
    </AnimatePresence>
  );
}

// Main Accordion component
export default function Accordion({
  items,
  defaultExpanded = [],
  allowMultiple = false,
  variant = 'default',
  size = 'md',
  iconPosition = 'right',
  animated = true,
  className = '',
  children,
}: AccordionProps) {
  const [expandedItems, setExpandedItems] = useState<string[]>(defaultExpanded);
  
  // Toggle item expansion
  const toggleItem = useCallback((id: string) => {
    setExpandedItems(prev => {
      if (prev.includes(id)) {
        return prev.filter(item => item !== id);
      }
      
      if (allowMultiple) {
        return [...prev, id];
      }
      
      return [id];
    });
  }, [allowMultiple]);
  
  // Context value
  const contextValue: AccordionContextType = {
    expandedItems,
    toggleItem,
    variant,
    size,
  };
  
  return (
    <AccordionContext.Provider value={contextValue}>
      <div className={className}>
        {/* Render from items prop */}
        {items?.map(item => (
          <AccordionItem key={item.id} item={item} />
        ))}
        
        {/* Render children */}
        {children}
      </div>
    </AccordionContext.Provider>
  );
}

// FAQ Accordion variant - specialized for FAQ pages
interface FAQItem {
  question: string;
  answer: string;
  category?: string;
}

interface FAQAccordionProps {
  items: FAQItem[];
  searchable?: boolean;
  grouped?: boolean;
  className?: string;
}

export function FAQAccordion({
  items,
  searchable = false,
  grouped = false,
  className = '',
}: FAQAccordionProps) {
  const [searchQuery, setSearchQuery] = useState('');
  const [expandedItems, setExpandedItems] = useState<string[]>([]);
  
  // Filter items based on search
  const filteredItems = items.filter(item =>
    item.question.toLowerCase().includes(searchQuery.toLowerCase()) ||
    item.answer.toLowerCase().includes(searchQuery.toLowerCase())
  );
  
  // Group items by category if needed
  const groupedItems = grouped
    ? filteredItems.reduce((acc, item) => {
        const category = item.category || 'General';
        if (!acc[category]) acc[category] = [];
        acc[category].push(item);
        return acc;
      }, {} as Record<string, FAQItem[]>)
    : { '': filteredItems };
  
  const toggleItem = (question: string) => {
    setExpandedItems(prev =>
      prev.includes(question)
        ? prev.filter(q => q !== question)
        : [...prev, question]
    );
  };
  
  return (
    <div className={className}>
      {/* Search */}
      {searchable && (
        <div className="mb-6">
          <div className="relative">
            <svg
              className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2}
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              />
            </svg>
            <input
              type="text"
              placeholder="Search FAQs..."
              value={searchQuery}
              onChange={e => setSearchQuery(e.target.value)}
              className="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none"
            />
          </div>
          
          {searchQuery && (
            <p className="mt-2 text-sm text-gray-500">
              {filteredItems.length} result{filteredItems.length !== 1 ? 's' : ''} found
            </p>
          )}
        </div>
      )}
      
      {/* FAQ items */}
      {Object.entries(groupedItems).map(([category, categoryItems]) => (
        <div key={category} className={category ? 'mb-8' : ''}>
          {category && (
            <h3 className="text-lg font-semibold text-gray-900 mb-4">{category}</h3>
          )}
          
          <div className="space-y-3">
            {categoryItems.map((item, index) => {
              const isExpanded = expandedItems.includes(item.question);
              
              return (
                <div
                  key={index}
                  className="bg-white rounded-lg border border-gray-200 overflow-hidden"
                >
                  <button
                    onClick={() => toggleItem(item.question)}
                    className="w-full flex items-center justify-between px-5 py-4 text-left hover:bg-gray-50 transition-colors"
                  >
                    <span className="font-medium text-gray-900 pr-4">
                      {item.question}
                    </span>
                    <motion.span
                      animate={{ rotate: isExpanded ? 180 : 0 }}
                      transition={{ duration: 0.2 }}
                      className="flex-shrink-0"
                    >
                      <svg
                        className="w-5 h-5 text-gray-400"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                      >
                        <path
                          strokeLinecap="round"
                          strokeLinejoin="round"
                          strokeWidth={2}
                          d="M19 9l-7 7-7-7"
                        />
                      </svg>
                    </motion.span>
                  </button>
                  
                  <AnimatePresence>
                    {isExpanded && (
                      <motion.div
                        initial={{ height: 0, opacity: 0 }}
                        animate={{ height: 'auto', opacity: 1 }}
                        exit={{ height: 0, opacity: 0 }}
                        transition={{ duration: 0.2 }}
                        className="overflow-hidden"
                      >
                        <div className="px-5 pb-4 text-gray-600 border-t border-gray-100 pt-4">
                          {item.answer}
                        </div>
                      </motion.div>
                    )}
                  </AnimatePresence>
                </div>
              );
            })}
          </div>
        </div>
      ))}
      
      {/* Empty state */}
      {filteredItems.length === 0 && (
        <div className="text-center py-12">
          <svg
            className="w-16 h-16 text-gray-300 mx-auto mb-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth={1.5}
              d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <p className="text-gray-500">No FAQs match your search</p>
          <button
            onClick={() => setSearchQuery('')}
            className="mt-2 text-orange-500 hover:underline"
          >
            Clear search
          </button>
        </div>
      )}
    </div>
  );
}

// Export types
export type { AccordionItemData, AccordionProps, FAQItem };

